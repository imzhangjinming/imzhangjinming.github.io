<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://example.com">
  <title>深入理解计算机系统 第三章 程序的机器级表示 | HZ&#39;s blogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="第三章 程序的机器级表示">
<meta property="og:type" content="article">
<meta property="og:title" content="深入理解计算机系统 第三章 程序的机器级表示">
<meta property="og:url" content="http://example.com/2021/11/20/CSAPP-Ch3/index.html">
<meta property="og:site_name" content="HZ&#39;s blogs">
<meta property="og:description" content="第三章 程序的机器级表示">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-09-29_09-18-51.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/208.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-21_20-52-08.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-20_21-15-29.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-21_08-36-39.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-21_08-36-57.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-21_10-24-31.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-21_20-41-50.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-22_20-32-34.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-22_20-39-32.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-22_21-40-10.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-01_21-54-30.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-16_21-01-00.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-16_23-18-38.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-17_02-11-00.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-17_14-30-30.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-18_14-16-41.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/308.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-19_01-43-41.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/323.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-19_14-09-17.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-19_14-16-55.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-19_14-23-35.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/323.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-19_15-10-27.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-20_00-33-32.png">
<meta property="og:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-20_00-34-45.png">
<meta property="article:published_time" content="2021-11-19T16:52:15.000Z">
<meta property="article:modified_time" content="2022-04-10T09:44:45.147Z">
<meta property="article:author" content="Mario">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/11/20/CSAPP-Ch3/Snipaste_2021-09-29_09-18-51.png">
  
    <link rel="alternative" href="/atom.xml" title="HZ&#39;s blogs" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/bitbug.ico">
  
  <link rel="stylesheet" type="text/css" href="/./main.0cf68a.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

<meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/images/IMG_5987.JPG" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/"></a></h1>
		</hgroup>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="/categories/aeronautics/">我的专业</a></li>
	        
				<li><a href="/categories/code/">编程</a></li>
	        
				<li><a href="/categories/notes/">读书笔记&amp;摘抄</a></li>
	        
				<li><a href="/categories/something/">随便写写的</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于我</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/imzhangjinming" title="github"><i class="icon-github"></i></a>
		        
					<a class="bilibili" target="_blank" href="https://space.bilibili.com/34761005" title="bilibili"><i class="icon-bilibili"></i></a>
		        
					<a class="mail" target="_blank" href="/208559590@qq.com" title="mail"><i class="icon-mail"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/images/IMG_5987.JPG" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author"></h1>
			</hgroup>
			
			
			
				
			
				
			
				
			
				
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/imzhangjinming" title="github"><i class="icon-github"></i></a>
			        
						<a class="bilibili" target="_blank" href="https://space.bilibili.com/34761005" title="bilibili"><i class="icon-bilibili"></i></a>
			        
						<a class="mail" target="_blank" href="/208559590@qq.com" title="mail"><i class="icon-mail"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 70%">
				
				
					<li style="width: 20%"><a href="/">主页</a></li>
		        
					<li style="width: 20%"><a href="/categories/aeronautics/">我的专业</a></li>
		        
					<li style="width: 20%"><a href="/categories/code/">编程</a></li>
		        
					<li style="width: 20%"><a href="/categories/notes/">读书笔记&amp;摘抄</a></li>
		        
					<li style="width: 20%"><a href="/categories/something/">随便写写的</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            <article id="post-CSAPP-Ch3" class="article article-type-post " itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      深入理解计算机系统 第三章 程序的机器级表示
    </h1>
  

        
        <a href="/2021/11/20/CSAPP-Ch3/" class="archive-article-date">
  	<time datetime="2021-11-19T16:52:15.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2021-11-20</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>第三章 程序的机器级表示</p>
<span id="more"></span>
<h1 id="第三章-程序的机器级表示"><a href="#第三章-程序的机器级表示" class="headerlink" title="第三章 程序的机器级表示"></a>第三章 程序的机器级表示</h1><h2 id="3-1-从历史角度看"><a href="#3-1-从历史角度看" class="headerlink" title="3.1 从历史角度看"></a>3.1 从历史角度看</h2><p>  Intel 的处理器产品线，通常又被叫做 x86 处理器，已经经历了一个很长时间的发展和进步</p>
<p>原书这里介绍了 Intel 历史上的经典处理器型号，我把它省略了吧，因为很像 Intel 的发家史</p>
<p>AMD 的全称是 Advanced Micro Devices</p>
<p>obsolete adj. 废弃的；老式的</p>
<h2 id="3-2-程序的编码"><a href="#3-2-程序的编码" class="headerlink" title="3.2 程序的编码"></a>3.2 程序的编码</h2><p>假设我们编写了两个C文件 p1.c 和 p2.c</p>
<p>现在用下面的命令行进行编译</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">linux&gt;</span><span class="bash"> gcc -Og -o p p1.c p2.c</span></span><br></pre></td></tr></table></figure>
<p><code>-Og</code> 要求编译器进行能够保留原始C代码结构的优化，不要过度优化</p>
<p>执行这条命令后，gcc 编译器会调用一系列程序将 <strong>源代码</strong> 变成 <strong>可执行文件</strong></p>
<p>首先，<strong>预处理器</strong>（<strong>preprocessor</strong>）会处理所有 预编译代码 和 宏</p>
<p>然后<strong>编译器</strong>（<strong>compiler</strong>）将C语言翻译成对应的 汇编语言 版本</p>
<p>接着，<strong>汇编器</strong>（<strong>assembler</strong>）将 汇编语言 翻译成 全是二进制机器语言 的目标文件</p>
<p>最后，<strong>链接器</strong>（<strong>linker</strong>）出马，将之前的 目标文件 与 库代码等连接到一起，生成最后的可执行文件</p>
<h3 id="3-2-1-机器级代码"><a href="#3-2-1-机器级代码" class="headerlink" title="3.2.1 机器级代码"></a>3.2.1 机器级代码</h3><p>机器级代码的格式和行为全部由 <strong>指令集架构</strong>（instruction set architecture,ISA）决定</p>
<p>elaborate adj. 复杂的</p>
<p>机器级的代码使用的是<strong>虚拟地址</strong>，操作系统负责 虚拟地址 和 真实的物理地址 之间的转换</p>
<h3 id="3-2-2-一个代码例子"><a href="#3-2-2-一个代码例子" class="headerlink" title="3.2.2 一个代码例子"></a>3.2.2 一个代码例子</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">mult2</span><span class="params">(<span class="keyword">long</span>, <span class="keyword">long</span>)</span></span>; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">multstore</span><span class="params">(<span class="keyword">long</span> x, <span class="keyword">long</span> y, <span class="keyword">long</span> *dest)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">long</span> t = mult2(x, y);</span><br><span class="line">    *dest = t; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们把文件命名为 mstore.c 并执行以下命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">linux&gt;</span><span class="bash"> gcc -Og -S mstore.c</span></span><br></pre></td></tr></table></figure>
<p><code>-S</code> 选项要求 gcc 生成 mstore.s 后停止，不再继续后面的工作</p>
<p>如果执行</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">linux&gt;</span><span class="bash"> gcc -Og -c mstore.c</span></span><br></pre></td></tr></table></figure>
<p><code>-c</code> 选项会使 gcc 在生成 mstore.o 后停止</p>
<p>如果想查看目标文件里的内容（.o 文件），可以使用 objdump 反汇编工具（disassemblers）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">linux&gt;</span><span class="bash"> objdump -d mstore.o</span></span><br></pre></td></tr></table></figure>
<p>在虚拟机中执行完上面这行命令后的输出是</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mstore.o：     文件格式 elf64-x86-64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disassembly of section .text:</span><br><span class="line"></span><br><span class="line">0000000000000000 &lt;multstore&gt;:</span><br><span class="line">   0:	53                   	push   %rbx</span><br><span class="line">   1:	48 89 d3             	mov    %rdx,%rbx</span><br><span class="line">   4:	e8 00 00 00 00       	callq  9 &lt;multstore+0x9&gt;</span><br><span class="line">   9:	48 89 03             	mov    %rax,(%rbx)</span><br><span class="line">   c:	5b                   	pop    %rbx</span><br><span class="line">   d:	c3                   	retq </span><br></pre></td></tr></table></figure>
<p>现在再编写一个文件 main.c 来生成真正的可执行文件</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">multstore</span><span class="params">(<span class="keyword">long</span>, <span class="keyword">long</span>, <span class="keyword">long</span> *)</span></span>; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    <span class="keyword">long</span> d; </span><br><span class="line">    multstore(<span class="number">2</span>, <span class="number">3</span>, &amp;d); </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;2 * 3 --&gt; %ld\n&quot;</span>, d); </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">mult2</span><span class="params">(<span class="keyword">long</span> a, <span class="keyword">long</span> b)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">long</span> s = a * b; </span><br><span class="line">    <span class="keyword">return</span> s; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行下面的命令生成可执行文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">linux&gt;</span><span class="bash"> gcc -Og -o prog main.c mstore.c</span></span><br></pre></td></tr></table></figure>
<h2 id="3-3-数据格式"><a href="#3-3-数据格式" class="headerlink" title="3.3 数据格式"></a>3.3 数据格式</h2><p>在 x86 系列发展的过程中，先是把 16-bit 数据称为 word </p>
<p>随着该系列处理器的继续发展，把 32-bit 数据称为 double words ，64-bit 数据称为 quad words</p>
<p>下表列出了与C语言中一些类型对应的 Intel 数据类型</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-09-29_09-18-51.png" class="">
<h2 id="3-4-访问信息"><a href="#3-4-访问信息" class="headerlink" title="3.4 访问信息"></a>3.4 访问信息</h2><p>一个 x86-64 CPU 拥有 16 个 64 位<strong>通用寄存器</strong>（general purpose register）</p>
<img src="/2021/11/20/CSAPP-Ch3/208.png" class="">
<h3 id="3-4-1-操作数指定符-operand-specifiers"><a href="#3-4-1-操作数指定符-operand-specifiers" class="headerlink" title="3.4.1 操作数指定符 operand specifiers"></a>3.4.1 操作数指定符 operand specifiers</h3><p>操作数分为三类：直接数、寄存器 和 内存地址</p>
<p>有很多寻址模式 addressing modes ，它们的通式可以表示为 $Imm(r_b,r_i,s)$ ，它表示的地址是 $Imm+R[r_b]+R[r_i*s]$</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-21_20-52-08.png" class="">
<h3 id="Practice-Problem-3-1"><a href="#Practice-Problem-3-1" class="headerlink" title="Practice Problem 3.1"></a>Practice Problem 3.1</h3><p>Assume the following values are stored at the indicated memory addresses and registers:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">address</th>
<th style="text-align:center">value</th>
<th style="text-align:center">register</th>
<th style="text-align:center">value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0x100</td>
<td style="text-align:center">0xFF</td>
<td style="text-align:center">%rax</td>
<td style="text-align:center">0x100</td>
</tr>
<tr>
<td style="text-align:center">0x104</td>
<td style="text-align:center">0xAB</td>
<td style="text-align:center">%rcx</td>
<td style="text-align:center">0x1</td>
</tr>
<tr>
<td style="text-align:center">0x108</td>
<td style="text-align:center">0x13</td>
<td style="text-align:center">%rdx</td>
<td style="text-align:center">0x3</td>
</tr>
<tr>
<td style="text-align:center">0x10c</td>
<td style="text-align:center">0x11</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
</div>
<p>Fill in the following table showing the values for the indicated operands:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>operand</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<td>%rax</td>
<td>0x100</td>
</tr>
<tr>
<td>0x104</td>
<td>0xAB</td>
</tr>
<tr>
<td>$0x108</td>
<td>0x108</td>
</tr>
<tr>
<td>(%rax)</td>
<td>0xFF</td>
</tr>
<tr>
<td>4(%rax)</td>
<td>0xAB</td>
</tr>
<tr>
<td>9(%rax,%rdx)</td>
<td>0x11</td>
</tr>
<tr>
<td>260(%rcx,%rdx)</td>
<td>0x13</td>
</tr>
<tr>
<td>0xFC(,%rcx,4)</td>
<td>0xFF</td>
</tr>
<tr>
<td>(%rax,%rdx,4)</td>
<td>0x11</td>
</tr>
</tbody>
</table>
</div>
<h3 id="3-4-2-移动数据的指令"><a href="#3-4-2-移动数据的指令" class="headerlink" title="3.4.2 移动数据的指令"></a>3.4.2 移动数据的指令</h3><p><code>MOV</code> 类指令</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-20_21-15-29.png" class="">
<p>通常，<code>MOV</code> 类指令只会改变目标寄存器的<strong>指定位</strong>。唯一的<strong>例外</strong>是：当指令 <code>movl</code> 的目标操作数是一个寄存器时，该指令会把目标寄存器的高32位（高4字节）<strong>置零</strong>，这与 x86-64 架构有关</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">movl $0x4050,%eax 		Immediate--Register, 4 bytes</span><br><span class="line">movw %bp,%sp 			Register--Register, 2 bytes</span><br><span class="line">movb (%rdi,%rcx),%al 	Memory--Register, 1 byte</span><br><span class="line">movb $-17,(%esp) 		Immediate--Memory, 1 byte</span><br><span class="line">movq %rax,-12(%rbp) 	Register--Memory, 8 bytes</span><br></pre></td></tr></table></figure>
<p>有两组专门将小数据拷贝到大寄存器里的指令</p>
<p><code>movz</code> 类：目标寄存器的高位用 0 填充（zero）</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-21_08-36-39.png" class="">
<p><code>movs</code> 类：目标寄存器的高位用 符号位 填充（sign）</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-21_08-36-57.png" class="">
<h3 id="Practice-Problem-3-2"><a href="#Practice-Problem-3-2" class="headerlink" title="Practice Problem 3.2"></a>Practice Problem 3.2</h3><p>For each of the following lines of assembly language, determine the appropriate instruction suffix based on the operands. (For example, <code>mov</code> can be rewritten as <code>movb</code>, <code>movw</code>, <code>movl</code>, or <code>movq</code>.)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">movl %eax, (%rsp)</span><br><span class="line">movw (%rax), %dx</span><br><span class="line">movb $0xFF, %bl</span><br><span class="line">movb (%rsp,%rdx,4), %dl</span><br><span class="line">movq (%rdx), %rax</span><br><span class="line">movw %dx, (%rax)</span><br></pre></td></tr></table></figure>
<h3 id="Practice-Problem-3-3"><a href="#Practice-Problem-3-3" class="headerlink" title="Practice Problem 3.3"></a>Practice Problem 3.3</h3><p>Each of the following lines of code generates an error message when we invoke the assembler. Explain what is wrong with each line.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">movb $0xF, (%ebx)			ebx （32位）不能用作地址寄存器</span><br><span class="line">movl %rax, (%rsp)			应该使用 movq 指令</span><br><span class="line">movw (%rax),4(%rsp)			不能从一个内存地址直接向另一个内存地址拷贝数据</span><br><span class="line">movb %al,%sl				没有 sl 这个寄存器名</span><br><span class="line">movq %rax,$0x123			source 和 destination 搞反了</span><br><span class="line">movl %eax,%rdx				这条没有错误</span><br><span class="line">movb %si, 8(%rbp)			应该使用 movw 指令</span><br></pre></td></tr></table></figure>
<h3 id="3-4-3-移动数据举例"><a href="#3-4-3-移动数据举例" class="headerlink" title="3.4.3 移动数据举例"></a>3.4.3 移动数据举例</h3><p>一个C语言函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">exchange</span><span class="params">(<span class="keyword">long</span> *xp, <span class="keyword">long</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> x = *xp;</span><br><span class="line">    *xp = y;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>它对应的汇编语言版本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">;long exchange(long *xp, long y)</span><br><span class="line">;xp in %rdi, y in %rsi</span><br><span class="line">exchange:</span><br><span class="line">	movq (%rdi), %rax 	;Get x at xp. Set as return value.</span><br><span class="line">	movq %rsi, (%rdi) 	;Store y at xp.</span><br><span class="line">	ret Return.</span><br></pre></td></tr></table></figure>
<h3 id="Practice-Problem-3-4"><a href="#Practice-Problem-3-4" class="headerlink" title="Practice Problem 3.4"></a>Practice Problem 3.4</h3><p>Assume variables <code>sp</code> and <code>dp</code> are declared with types</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">src_t</span> *sp;</span><br><span class="line"><span class="keyword">dest_t</span> *dp;</span><br></pre></td></tr></table></figure>
<p>where <code>src_t</code> and <code>dest_t</code> are data types declared with <code>typedef</code>. We wish to use the appropriate pair of data movement instructions to implement the operation</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*dp = (<span class="keyword">dest_t</span>) *sp;</span><br></pre></td></tr></table></figure>
<p>Assume that the values of <code>sp</code> and <code>dp</code> are stored in registers <code>%rdi</code> and <code>%rsi</code>, respectively. For each entry in the table, show the two instructions that implement the specified data movement. The <strong>first </strong> instruction in the sequence should <strong>read from memory</strong>, do the appropriate conversion, and set the appropriate portion of register <code>%rax</code>. The <strong>second</strong> instruction should then write the appropriate portion of <code>%rax</code> to memory. In both cases, the portions may be <code>%rax</code>, <code>%eax</code>, <code>%ax</code>, or <code>%al</code>, and they may differ from one another.</p>
<p>Recall that when performing a cast that involves both a size change and a change of “signedness” in C, the operation should <strong>change the size first</strong> (Section 2.2.6).</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center"><code>src_t</code></th>
<th style="text-align:center"><code>dest_t</code></th>
<th style="text-align:center">Instruction</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>long</code></td>
<td style="text-align:center"><code>long</code></td>
<td style="text-align:center"><code>movq (%rdi),%rax</code></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><code>movq %rax,(%rsi)</code></td>
</tr>
<tr>
<td style="text-align:center"><code>char</code></td>
<td style="text-align:center"><code>int</code></td>
<td style="text-align:center"><code>movsbl (%rdi),%eax</code></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><code>movl %eax,(%rsi)</code></td>
</tr>
<tr>
<td style="text-align:center"><code>char</code></td>
<td style="text-align:center"><code>unsigned</code></td>
<td style="text-align:center"><code>movsbl (%rdi),%eax</code></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><code>movl %eax,(%rsi)</code></td>
</tr>
<tr>
<td style="text-align:center"><code>unsigned char</code></td>
<td style="text-align:center"><code>long</code></td>
<td style="text-align:center"><code>movzbq (%rdi),%rax</code></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><code>movq %rax,(%rsi)</code></td>
</tr>
<tr>
<td style="text-align:center"><code>int</code></td>
<td style="text-align:center"><code>char</code></td>
<td style="text-align:center"><code>movl (%rdi),%eax</code></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><code>movb %al,(%rsi)</code></td>
</tr>
<tr>
<td style="text-align:center"><code>unsigned</code></td>
<td style="text-align:center"><code>unsigned char</code></td>
<td style="text-align:center"><code>movl (%rdi),%eax</code></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><code>movb %al,(%rsi)</code></td>
</tr>
<tr>
<td style="text-align:center"><code>char</code></td>
<td style="text-align:center"><code>short</code></td>
<td style="text-align:center"><code>movsbw (%rdi),%ax</code></td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"><code>movw %ax,(%rsi)</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Practice-Problem-3-5"><a href="#Practice-Problem-3-5" class="headerlink" title="Practice Problem 3.5"></a>Practice Problem 3.5</h3><p>You are given the following information. A function with prototype</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decode1</span><span class="params">(<span class="keyword">long</span> *xp, <span class="keyword">long</span> *yp, <span class="keyword">long</span> *zp)</span></span>;</span><br></pre></td></tr></table></figure>
<p>is compiled into assembly code, yielding the following:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">;void decode1(long *xp, long *yp, long *zp)</span><br><span class="line">;xp in %rdi, yp in %rsi, zp in %rdx</span><br><span class="line">decode1:</span><br><span class="line">    movq (%rdi), %r8</span><br><span class="line">    movq (%rsi), %rcx</span><br><span class="line">    movq (%rdx), %rax</span><br><span class="line">    movq %r8, (%rsi)</span><br><span class="line">    movq %rcx, (%rdx)</span><br><span class="line">    movq %rax, (%rdi)</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<p>Parameters <code>xp</code>, <code>yp</code>, and <code>zp</code> are stored in registers <code>%rdi</code>, <code>%rsi</code>, and <code>%rdx</code>, respectively.</p>
<p>Write C code for <code>decode1</code> that will have an effect equivalent to the assembly code shown.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">decode1</span><span class="params">(<span class="keyword">long</span> *xp, <span class="keyword">long</span> *yp, <span class="keyword">long</span> *zp)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> x=*xp;</span><br><span class="line">    <span class="keyword">long</span> y=*yp;</span><br><span class="line">    <span class="keyword">long</span> z=*zp;</span><br><span class="line">    </span><br><span class="line">    *yp=x;</span><br><span class="line">    *zp=y;</span><br><span class="line">    *xp=z;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-4-4-数据的进栈和出栈-pushing-and-popping"><a href="#3-4-4-数据的进栈和出栈-pushing-and-popping" class="headerlink" title="3.4.4 数据的进栈和出栈 pushing and popping"></a>3.4.4 数据的进栈和出栈 pushing and popping</h3><p>push and pop instructions:</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-21_10-24-31.png" class="">
<p><code>%rsp</code> 寄存器存放当前<strong>栈顶的地址</strong></p>
<h2 id="3-5-算术和逻辑运算"><a href="#3-5-算术和逻辑运算" class="headerlink" title="3.5 算术和逻辑运算"></a>3.5 算术和逻辑运算</h2><h3 id="3-5-1-加载有效地址"><a href="#3-5-1-加载有效地址" class="headerlink" title="3.5.1 加载有效地址"></a>3.5.1 加载有效地址</h3><img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-21_20-41-50.png" class="">
<h3 id="Practice-Problem-3-6"><a href="#Practice-Problem-3-6" class="headerlink" title="Practice Problem 3.6"></a>Practice Problem 3.6</h3><p>Suppose register <code>%rbx</code> holds value p and <code>%rdx</code> holds value q. Fill in the table below with formulas indicating the value that will be stored in register <code>%rax</code> for each of the given assembly-code instructions:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Instruction</th>
<th style="text-align:center">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>leaq 9(%rdx), %rax</code></td>
<td style="text-align:center"><code>(%rdx)+9</code></td>
</tr>
<tr>
<td style="text-align:center"><code>leaq (%rdx,%rbx), %rax</code></td>
<td style="text-align:center"><code>(%rdx)+(%rbx)</code></td>
</tr>
<tr>
<td style="text-align:center"><code>leaq (%rdx,%rbx,3), %rax</code></td>
<td style="text-align:center"><code>(%rdx)+3*(%rbx)</code></td>
</tr>
<tr>
<td style="text-align:center"><code>leaq 2(%rbx,%rbx,7)</code></td>
<td style="text-align:center"><code>8*(%rbx)+2</code></td>
</tr>
<tr>
<td style="text-align:center"><code>leaq 0xE(,%rdx,3), %rax</code></td>
<td style="text-align:center"><code>3*(%rdx)+14</code></td>
</tr>
<tr>
<td style="text-align:center"><code>leaq 6(%rbx,%rdx,7), %rax</code></td>
<td style="text-align:center"><code>(%rbx)+7*(%rdx)+6</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="Practice-Problem-3-7"><a href="#Practice-Problem-3-7" class="headerlink" title="Practice Problem 3.7"></a>Practice Problem 3.7</h3><p>Consider the following code, in which we have omitted the expression being computed:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">scale3</span><span class="params">(<span class="keyword">short</span> x, <span class="keyword">short</span> y, <span class="keyword">short</span> z)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">short</span> t = ;</span><br><span class="line">	<span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Compiling the actual function with gcc yields the following assembly code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">;short scale3(short x, short y, short z)</span><br><span class="line">;x in %rdi, y in %rsi, z in %rdx</span><br><span class="line">scale3:</span><br><span class="line">    leaq (%rsi,%rsi,9), %rbx		;(%rbx)=10*y</span><br><span class="line">    leaq (%rbx,%rdx), %rbx			;(%rbx)=10*y+z</span><br><span class="line">    leaq (%rbx,%rdi,%rsi), %rbx		;(%rbx)=10*y+z+x*y=x*y+10*y+z</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<p>Fill in the missing expression in the C code.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">scale3</span><span class="params">(<span class="keyword">short</span> x, <span class="keyword">short</span> y, <span class="keyword">short</span> z)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">short</span> t = x*y+<span class="number">10</span>*y+z;</span><br><span class="line">	<span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-5-2-一元和二元操作"><a href="#3-5-2-一元和二元操作" class="headerlink" title="3.5.2 一元和二元操作"></a>3.5.2 一元和二元操作</h3><h3 id="Practice-Problem-3-8"><a href="#Practice-Problem-3-8" class="headerlink" title="Practice Problem 3.8"></a>Practice Problem 3.8</h3><p>Assume the following values are stored at the indicated memory addresses and registers:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">address</th>
<th style="text-align:center">value</th>
<th style="text-align:center">register</th>
<th style="text-align:center">value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0x100</td>
<td style="text-align:center">0xFF</td>
<td style="text-align:center">%rax</td>
<td style="text-align:center">0x100</td>
</tr>
<tr>
<td style="text-align:center">0x108</td>
<td style="text-align:center">0xAB</td>
<td style="text-align:center">%rcx</td>
<td style="text-align:center">0x1</td>
</tr>
<tr>
<td style="text-align:center">0x110</td>
<td style="text-align:center">0x13</td>
<td style="text-align:center">%rdx</td>
<td style="text-align:center">0x3</td>
</tr>
<tr>
<td style="text-align:center">0x118</td>
<td style="text-align:center">0x11</td>
<td style="text-align:center"></td>
</tr>
</tbody>
</table>
</div>
<p>Fill in the following table showing the effects of the following instructions, in terms of both the register or memory location that will be updated and the resulting value:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Instruction</th>
<th style="text-align:center">Destination</th>
<th style="text-align:center">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>addq %rcx,(%rax)</code></td>
<td style="text-align:center">0x100</td>
<td style="text-align:center">0xff+0x1=0x100</td>
</tr>
<tr>
<td style="text-align:center"><code>subq %rdx,8(%rax)</code></td>
<td style="text-align:center">0x108</td>
<td style="text-align:center">0xab-0x3=0xa8</td>
</tr>
<tr>
<td style="text-align:center"><code>imulq $16,(%rax,%rdx,8)</code></td>
<td style="text-align:center">0x118</td>
<td style="text-align:center">0x11*0x10=0x110</td>
</tr>
<tr>
<td style="text-align:center"><code>incq 16(%rax)</code></td>
<td style="text-align:center">0x110</td>
<td style="text-align:center">0x14</td>
</tr>
<tr>
<td style="text-align:center"><code>decq %rcx</code></td>
<td style="text-align:center">%rcx</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td style="text-align:center"><code>subq %rdx,%rax</code></td>
<td style="text-align:center">%rax</td>
<td style="text-align:center">0xFD</td>
</tr>
</tbody>
</table>
</div>
<h3 id="3-5-3-移位操作"><a href="#3-5-3-移位操作" class="headerlink" title="3.5.3 移位操作"></a>3.5.3 移位操作</h3><h3 id="Practice-Problem-3-9"><a href="#Practice-Problem-3-9" class="headerlink" title="Practice Problem 3.9"></a>Practice Problem 3.9</h3><p>Suppose we want to generate assembly code for the following C function:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">shift_left4_rightn</span><span class="params">(<span class="keyword">long</span> x, <span class="keyword">long</span> n)</span></span>&#123;</span><br><span class="line">    x &lt;&lt;= <span class="number">4</span>;</span><br><span class="line">    x &gt;&gt;= n;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The code that follows is a portion of the assembly code that performs the actual shifts and leaves the final value in register <code>%rax</code>. Two key instructions have been omitted. Parameters <strong>x</strong> and <strong>n</strong> are stored in registers <code>%rdi</code> and <code>%rsi</code>, respectively.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">;long shift_left4_rightn(long x, long n)</span><br><span class="line">;x in %rdi, n in %rsi</span><br><span class="line">shift_left4_rightn:</span><br><span class="line">    movq %rdi, %rax ;Get x</span><br><span class="line">    salq  $4,%rax	;x &lt;&lt;= 4</span><br><span class="line">    movl %esi, %ecx ;Get n (4 bytes)</span><br><span class="line">    sarq  %cl,%rax	;x &gt;&gt;= n</span><br></pre></td></tr></table></figure>
<p>Fill in the missing instructions, following the annotations on the right. The right shift should be performed <strong>arithmetically</strong>.</p>
<h3 id="Practice-Problem-3-10"><a href="#Practice-Problem-3-10" class="headerlink" title="Practice Problem 3.10"></a>Practice Problem 3.10</h3><p>Consider the following code, in which we have omitted the expression being computed:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">arith3</span><span class="params">(<span class="keyword">short</span> x, <span class="keyword">short</span> y, <span class="keyword">short</span> z)</span></span>&#123;</span><br><span class="line">    <span class="keyword">short</span> p1 = ;</span><br><span class="line">    <span class="keyword">short</span> p2 = ;</span><br><span class="line">    <span class="keyword">short</span> p3 = ;</span><br><span class="line">    <span class="keyword">short</span> p4 = ;</span><br><span class="line">    <span class="keyword">return</span> p4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The portion of the generated assembly code implementing these expressions is as follows:</p>
<p>书本上给的汇编代码有些错误，我按照自己编译出来的汇编代码进行了修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">;short arith3(short x, short y, short z)</span><br><span class="line">;x in %rdi, y in %rsi, z in %rdx</span><br><span class="line">arith3:</span><br><span class="line">    orq %rsi, %rdx		;z |= y</span><br><span class="line">    sarq $9, %rdx		;z &gt;&gt;= 9</span><br><span class="line">    notq %rdx			;z ~= z;</span><br><span class="line">    movq %rsi, %rbx		;(%rbx)=y</span><br><span class="line">    subq %rdx, %rbx		;y=y-z</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">arith3</span><span class="params">(<span class="keyword">short</span> x, <span class="keyword">short</span> y, <span class="keyword">short</span> z)</span></span>&#123;</span><br><span class="line">    <span class="keyword">short</span> p1 = y|z;</span><br><span class="line">    <span class="keyword">short</span> p2 = p1&gt;&gt;<span class="number">9</span>;</span><br><span class="line">    <span class="keyword">short</span> p3 = ~p2;</span><br><span class="line">    <span class="keyword">short</span> p4 = y-p3;</span><br><span class="line">    <span class="keyword">return</span> p4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Practice-Problem-3-11"><a href="#Practice-Problem-3-11" class="headerlink" title="Practice Problem 3.11"></a>Practice Problem 3.11</h3><p>It is common to find assembly-code lines of the form</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xorq %rcx,%rcx</span><br></pre></td></tr></table></figure>
<p>in code that was generated from C where no exclusive-or operations were present.</p>
<p>A. Explain the effect of this particular exclusive-or instruction and what useful operation it implements.</p>
<p>将寄存器内容清零</p>
<p>B. What would be the more straightforward way to express this operation in assembly code?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">movq $0,%rcx</span><br></pre></td></tr></table></figure>
<p>C. Compare the number of bytes to encode any two of these three different implementations of the same operation.</p>
<p>事实证明，使用异或置零生成的代码<strong>体积更小</strong></p>
<h3 id="3-5-5-特殊算术操作"><a href="#3-5-5-特殊算术操作" class="headerlink" title="3.5.5 特殊算术操作"></a>3.5.5 特殊算术操作</h3><h2 id="3-6-控制"><a href="#3-6-控制" class="headerlink" title="3.6 控制"></a>3.6 控制</h2><h3 id="3-6-1-标志寄存器-Condition-Codes"><a href="#3-6-1-标志寄存器-Condition-Codes" class="headerlink" title="3.6.1 标志寄存器 Condition Codes"></a>3.6.1 标志寄存器 Condition Codes</h3><blockquote>
<p><strong>CF</strong>: Carry flag. The most recent operation generated a carry out of the most significant bit. Used to detect overflow for <strong>unsigned operations</strong>.</p>
<p><strong>ZF</strong>: Zero flag. The most recent operation yielded zero. </p>
<p><strong>SF</strong>: Sign flag. The most recent operation yielded a negative value. </p>
<p><strong>OF</strong>: Overflow flag. The most recent operation caused a <strong>two’s-complement overflow</strong>—either negative or positive.</p>
</blockquote>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-22_20-32-34.png" class="">
<h3 id="3-6-2-获取标志的值-Accessing-the-Condition-Codes"><a href="#3-6-2-获取标志的值-Accessing-the-Condition-Codes" class="headerlink" title="3.6.2 获取标志的值 Accessing the Condition Codes"></a>3.6.2 获取标志的值 Accessing the Condition Codes</h3><img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-22_20-39-32.png" class="">
<h3 id="Practice-Problem-3-13"><a href="#Practice-Problem-3-13" class="headerlink" title="Practice Problem 3.13"></a>Practice Problem 3.13</h3><p>The C code</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">comp</span><span class="params">(<span class="keyword">data_t</span> a, <span class="keyword">data_t</span> b)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a COMP b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>shows a general comparison between arguments a and b, where <code>data_t</code>, the data type of the arguments, is defined (via <code>typedef</code>) to be one of the integer data types listed in Figure 3.1 and either signed or unsigned. The comparison <code>COMP</code> is defined via <code>#define</code>.</p>
<p>Suppose a is in some portion of <code>%rdx</code> while b is in some portion of <code>%rsi</code>. For each of the following instruction sequences, determine which data types <code>data_t</code> and which comparisons <code>COMP</code> could cause the compiler to generate this code. (There can be multiple correct answers; you should <strong>list them all</strong>.)</p>
<p>A. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmpl %esi, %edi</span><br><span class="line">setl %al</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>number</th>
<th>data type</th>
<th>operation</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>int</td>
<td>a&lt;b</td>
</tr>
</tbody>
</table>
</div>
<p>B. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmpw %si, %di</span><br><span class="line">setge %al</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>number</th>
<th>data type</th>
<th>operation</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>short</td>
<td>a &gt;= b</td>
</tr>
</tbody>
</table>
</div>
<p>C. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmpb %sil, %dil</span><br><span class="line">setbe %al</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>number</th>
<th>data type</th>
<th>operation</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>unsigned char</td>
<td>a &lt;= b</td>
</tr>
</tbody>
</table>
</div>
<p>D.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmpq %rsi, %rdi</span><br><span class="line">setne %a</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>number</th>
<th>data type</th>
<th>operation</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>long</td>
<td>a != b</td>
</tr>
<tr>
<td>2</td>
<td>unsigned long</td>
<td>a != b</td>
</tr>
<tr>
<td>3</td>
<td>some form of pointer</td>
<td>a != b</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Practice-Problem-3-14"><a href="#Practice-Problem-3-14" class="headerlink" title="Practice Problem 3.14"></a>Practice Problem 3.14</h3><p>The C code</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">test</span><span class="params">(<span class="keyword">data_t</span> a)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a TEST <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>shows a general comparison between argument a and 0, where we can set the data type of the argument by declaring <code>data_t</code> with a <code>typedef</code>, and the nature of the comparison by declaring TEST with a <code>#define</code> declaration. The following instruction sequences implement the comparison, where <code>a</code>  is held in some portion of register <code>%rdi</code>. For each sequence, determine which data types <code>data_t</code> and which comparisons TEST could cause the compiler to generate this code. (There can be multiple correct answers; <strong>list all correct ones</strong>.)</p>
<p>A. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">testq %rdi, %rdi</span><br><span class="line">setge %al</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>number</th>
<th>data type</th>
<th>operation</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>long</td>
<td>a &gt;= 0</td>
</tr>
</tbody>
</table>
</div>
<p>B. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">testw %di, %di</span><br><span class="line">sete %al</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>number</th>
<th>data type</th>
<th>operation</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>short</td>
<td>a == 0</td>
</tr>
<tr>
<td>2</td>
<td>unsigned short</td>
<td>a == 0</td>
</tr>
</tbody>
</table>
</div>
<p>C. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">testb %dil, %dil</span><br><span class="line">seta %al</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>number</th>
<th>data type</th>
<th>operation</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>unsigned char</td>
<td>a &gt; 0</td>
</tr>
</tbody>
</table>
</div>
<p>D. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">testl %edi, %edi </span><br><span class="line">setle %al</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>number</th>
<th>data type</th>
<th>operation</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>int</td>
<td>a &lt;= 0</td>
</tr>
</tbody>
</table>
</div>
<h3 id="3-6-3-Jump-指令"><a href="#3-6-3-Jump-指令" class="headerlink" title="3.6.3 Jump 指令"></a>3.6.3 Jump 指令</h3><p>contrived adj. 人为的；做作的；不自然的</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-10-22_21-40-10.png" class="">
<h3 id="3-6-4-Jump-指令的编码"><a href="#3-6-4-Jump-指令的编码" class="headerlink" title="3.6.4 Jump 指令的编码"></a>3.6.4 Jump 指令的编码</h3><p>跳转指令的目标地址编码方式有两种：一种是 PC relative ，即给出目标地址相对于<strong>即将要执行的指令</strong>（当前指令的下一条）的相对位移；另一种是直接给出目标地址的绝对地址 absolute address</p>
<h3 id="Practice-Problem-3-15"><a href="#Practice-Problem-3-15" class="headerlink" title="Practice Problem 3.15"></a>Practice Problem 3.15</h3><p>In the following excerpts from a disassembled binary, some of the information has been replaced by X’s. Answer the following questions about these instructions.</p>
<p>A. What is the target of the <code>je</code> instruction below? (You do not need to know anything about the <code>callq</code> instruction here.)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">4003fa: 74 02 		je XXXXXX</span><br><span class="line">4003fc: ff d0 		callq *%rax</span><br></pre></td></tr></table></figure>
<p>0x4003fc+0x02=0x4003fe</p>
<p>B. What is the target of the <code>je</code> instruction below?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">40042f: 74 f4 		je XXXXXX </span><br><span class="line">400431: 5d 			pop %rbp</span><br></pre></td></tr></table></figure>
<p>0x400431-0xc=0x400425</p>
<p>C. What is the address of the <code>ja</code> and <code>pop</code> instructions?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">400543: 77 02 		ja 400547</span><br><span class="line">400545: 5d 			pop %rbp</span><br></pre></td></tr></table></figure>
<p>D. In the code that follows, the jump target is encoded in PC-relative form as a 4- byte two’s-complement number. The bytes are listed from least significant to most, reflecting the little-endian byte ordering of x86-64.What is the address of the jump target?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">4005e8: e9 73 ff ff ff jmpq XXXXXXX</span><br><span class="line">4005ed: 90 nop</span><br></pre></td></tr></table></figure>
<p>0xffff ff73= -141</p>
<p>0x4005ed - 141 = <strong>0x400560</strong></p>
<h3 id="3-6-5-使用条件控制指令实现条件分支"><a href="#3-6-5-使用条件控制指令实现条件分支" class="headerlink" title="3.6.5 使用条件控制指令实现条件分支"></a>3.6.5 使用条件控制指令实现条件分支</h3><p><code>cmp</code>  和 <code>jmp</code>  语句的结合</p>
<h3 id="Practice-Problem-3-16"><a href="#Practice-Problem-3-16" class="headerlink" title="Practice Problem 3.16"></a>Practice Problem 3.16</h3><p>When given the C code</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cond</span><span class="params">(<span class="keyword">short</span> a, <span class="keyword">short</span> *p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (a &amp;&amp; *p &lt; a)</span><br><span class="line">    *p = a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>gcc generates the following assembly code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">;void cond(short a, short *p)</span><br><span class="line">;a in %rdi, p in %rsi</span><br><span class="line">cond:</span><br><span class="line">    testq %rdi, %rdi</span><br><span class="line">    je .L1</span><br><span class="line">    cmpq %rdi, (%rsi)</span><br><span class="line">    jle .L1</span><br><span class="line">    movq %rdi, (%rsi)</span><br><span class="line">.L1:</span><br><span class="line">	rep; ret</span><br></pre></td></tr></table></figure>
<p>A. Write a <code>goto</code> version in C that performs the same computation and mimics the control flow of the assembly code, in the style shown in Figure 3.16(b). You might find it helpful to first annotate the assembly code as we have done in our examples.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cond</span><span class="params">(<span class="keyword">short</span> a,<span class="keyword">short</span> *p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!a)</span><br><span class="line">        <span class="keyword">goto</span> s1;</span><br><span class="line">    <span class="keyword">if</span>(*p &gt;= a)</span><br><span class="line">        <span class="keyword">goto</span> s1;</span><br><span class="line">    *p=a;</span><br><span class="line">  s1:</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Practice-Problem-3-17"><a href="#Practice-Problem-3-17" class="headerlink" title="Practice Problem 3.17"></a>Practice Problem 3.17</h3><p>An alternate rule for translating <code>if</code> statements into goto code is as follows:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    t = test-expr;</span><br><span class="line">    <span class="keyword">if</span> (t)</span><br><span class="line">    	<span class="keyword">goto</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">else</span>-statement</span><br><span class="line">    	<span class="keyword">goto</span> done;</span><br><span class="line"><span class="literal">true</span>:</span><br><span class="line">    then-statement</span><br><span class="line">done:</span><br></pre></td></tr></table></figure>
<h3 id="Practice-Problem-3-18"><a href="#Practice-Problem-3-18" class="headerlink" title="Practice Problem 3.18"></a>Practice Problem 3.18</h3><p>Starting with C code of the form</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">test</span><span class="params">(<span class="keyword">short</span> x, <span class="keyword">short</span> y, <span class="keyword">short</span> z)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">short</span> val = y+z-x;</span><br><span class="line">    <span class="keyword">if</span> (z &gt; <span class="number">5</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &gt; <span class="number">2</span>)</span><br><span class="line">            val = x/z;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        	val = x/y;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (z &lt; <span class="number">3</span>)</span><br><span class="line">    	val = z/y;</span><br><span class="line">    <span class="keyword">return</span> val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>gcc generates the following assembly code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">;short test(short x, short y, short z)</span><br><span class="line">;x in %rdi, y in %rsi, z in %rdx</span><br><span class="line">test:</span><br><span class="line">    leaq (%rdx,%rsi), %rax</span><br><span class="line">    subq %rdi, %rax</span><br><span class="line">    cmpq $5, %rdx</span><br><span class="line">    jle .L2</span><br><span class="line">    cmpq $2, %rsi</span><br><span class="line">    jle .L3</span><br><span class="line">    movq %rdi, %rax</span><br><span class="line">    idivq %rdx, %rax</span><br><span class="line">    ret</span><br><span class="line">.L3:</span><br><span class="line">    movq %rdi, %rax</span><br><span class="line">    idivq %rsi, %rax</span><br><span class="line">    ret</span><br><span class="line">.L2:</span><br><span class="line">    cmpq $3, %rdx</span><br><span class="line">    jge .L4</span><br><span class="line">    movq %rdx, %rax</span><br><span class="line">    idivq %rsi, %rax</span><br><span class="line">.L4:</span><br><span class="line">	rep; ret</span><br></pre></td></tr></table></figure>
<p>Fill in the missing expressions in the C code.</p>
<h3 id="3-6-6-使用条件移动（Conditional-Moves）实现条件分支（Conditional-Branches）"><a href="#3-6-6-使用条件移动（Conditional-Moves）实现条件分支（Conditional-Branches）" class="headerlink" title="3.6.6 使用条件移动（Conditional Moves）实现条件分支（Conditional Branches）"></a>3.6.6 使用条件移动（Conditional Moves）实现条件分支（Conditional Branches）</h3><p>使用现代处理器时，Conditional Moves 方法通常会比使用 Conditional Control 更加高效</p>
<h3 id="Practice-Problem-3-19"><a href="#Practice-Problem-3-19" class="headerlink" title="Practice Problem 3.19"></a>Practice Problem 3.19</h3><p>Running on a new processor model, our code required around <strong>45 cycles</strong> when the branching pattern was <strong>random</strong>, and around <strong>25 cycles</strong> when the pattern was <strong>highly predictable</strong>.</p>
<p>A. What is the approximate miss penalty?</p>
<script type="math/tex; mode=display">
\left\{\begin{matrix}
     T_{ran}=T_{OK}+0.5*T_{MP}\\
     T_{High}=T_{OK}+0.1*T_{MP}
\end{matrix}\right.
\\
T_{OK}=20 \\
T_{MP}=50 \\</script><p>50 个机器周期</p>
<p>B. How many cycles would the function require when the branch is mispredicted?</p>
<p>70 个机器周期</p>
<p>条件移动指令：</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-01_21-54-30.png" class="">
<h3 id="Practice-Problem-3-20"><a href="#Practice-Problem-3-20" class="headerlink" title="Practice Problem 3.20"></a>Practice Problem 3.20</h3><p>In the following C function, we have left the definition of operation <code>OP</code> incomplete:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OP 			<span class="comment">/* Unknown operator */</span></span></span><br><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">arith</span><span class="params">(<span class="keyword">short</span> x)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x OP <span class="number">16</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>When compiled, gcc generates the following assembly code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">;short arith(short x)</span><br><span class="line">;x in %rdi</span><br><span class="line">arith:</span><br><span class="line">    leaq 15(%rdi), %rbx		;temp=x+15</span><br><span class="line">    testq %rdi, %rdi		;	</span><br><span class="line">    cmovns %rdi, %rbx		;if(x&gt;=0) temp=x	</span><br><span class="line">    sarq $4, %rbx			;temp=temp&gt;&gt;4	</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<p>这是除法操作的汇编代码，所以题目中缺失的运算符是 <code>/</code></p>
<p><strong>注意</strong>当 x&lt;0 时，由于使用2的补码表示的整型除以2的整数次幂的时候要加一个 bias （具体看看 2.3.7），所以才有第一句 <code>leaq 15(%rdi), %rbx        ;temp=x+15</code> </p>
<p>因为读第二章和第三章两章时间间隔有点久，这里被这个 +15 的操作难住了，记忆力不好</p>
<h3 id="Practice-Problem-3-21"><a href="#Practice-Problem-3-21" class="headerlink" title="Practice Problem 3.21"></a>Practice Problem 3.21</h3><p>Starting with C code of the form</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">test</span><span class="params">(<span class="keyword">short</span> x, <span class="keyword">short</span> y)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">short</span> val = ;</span><br><span class="line">	<span class="keyword">if</span> ( ) &#123;</span><br><span class="line">		<span class="keyword">if</span> ( )</span><br><span class="line">			val = ;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			val = ;</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> ( )</span><br><span class="line">		val = ;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">return</span> val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>gcc generates the following assembly code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">;short test(short x, short y)</span><br><span class="line">;x in %rdi, y in %rsi</span><br><span class="line">test:</span><br><span class="line">    leaq 12(%rsi), %rbx</span><br><span class="line">    testq %rdi, %rdi</span><br><span class="line">    jge .L2</span><br><span class="line">    movq %rdi, %rbx</span><br><span class="line">    imulq %rsi, %rbx ;val=x*y;</span><br><span class="line">    movq %rdi, %rdx  ;temp=x</span><br><span class="line">    orq %rsi, %rdx   ;temp=temp|y</span><br><span class="line">    cmpq %rsi, %rdi  ;</span><br><span class="line">    cmovge %rdx, %rbx;if(x&gt;=y) val=x|y;</span><br><span class="line">    ret</span><br><span class="line">.L2:</span><br><span class="line">    idivq %rsi, %rdi</span><br><span class="line">    cmpq $10, %rsi</span><br><span class="line">    cmovge %rdi, %rbx</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<p>Fill in the missing expressions in the C code.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">test</span><span class="params">(<span class="keyword">short</span> x, <span class="keyword">short</span> y)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">short</span> val = y+<span class="number">12</span>;</span><br><span class="line">	<span class="keyword">if</span> (x!=<span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (x &gt;= y)</span><br><span class="line">			val = x|y;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			val = x*y;</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (y &gt;= <span class="number">10</span>)</span><br><span class="line">		val = x/y;</span><br><span class="line">    </span><br><span class="line">	<span class="keyword">return</span> val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-6-7-循环"><a href="#3-6-7-循环" class="headerlink" title="3.6.7 循环"></a>3.6.7 循环</h3><ul>
<li><code>do-while</code> 循环</li>
</ul>
<h3 id="Practice-Problem-3-23"><a href="#Practice-Problem-3-23" class="headerlink" title="Practice Problem 3.23"></a>Practice Problem 3.23</h3><p>For the C code</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">dw_loop</span><span class="params">(<span class="keyword">short</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">short</span> y = x/<span class="number">9</span>;</span><br><span class="line">    <span class="keyword">short</span> *p = &amp;x;</span><br><span class="line">    <span class="keyword">short</span> n = <span class="number">4</span>*x;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        x += y;</span><br><span class="line">        (*p) += <span class="number">5</span>;</span><br><span class="line">        n -= <span class="number">2</span>;</span><br><span class="line">    &#125; <span class="keyword">while</span> (n &gt; <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>gcc generates the following assembly code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">;short dw_loop(short x)</span><br><span class="line">;x initially in %rdi</span><br><span class="line">dw_loop:</span><br><span class="line">    movq %rdi, %rbx			;load x into rbx</span><br><span class="line">    movq %rdi, %rcx			;load x into rcx</span><br><span class="line">    idivq $9, %rcx			; y=x/9 y in rcx</span><br><span class="line">    leaq (,%rdi,4), %rdx	; n=4*x n in rdx</span><br><span class="line">.L2:</span><br><span class="line">    leaq 5(%rbx,%rcx), %rcx	;x=x+y+5</span><br><span class="line">    subq $2, %rdx			;n-=2</span><br><span class="line">    testq %rdx, %rdx		;</span><br><span class="line">    jg .L2					;if n&gt;0 ,goto .L2</span><br><span class="line">    rep; ret</span><br></pre></td></tr></table></figure>
<p>A. Which registers are used to hold program values x, y, and n?</p>
<p>rdi and rcx</p>
<p>rcx</p>
<p>rdx</p>
<p>B. How has the compiler eliminated the need for pointer variable <code>p</code> and the pointer dereferencing implied by the expression <code>(*p)+=5</code> ?</p>
<p>C. Add annotations to the assembly code describing the operation of the program.</p>
<ul>
<li><code>while</code> loops</li>
</ul>
<h3 id="Practice-Problem-3-24"><a href="#Practice-Problem-3-24" class="headerlink" title="Practice Problem 3.24"></a>Practice Problem 3.24</h3><p>For C code having the general form</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">loop_while</span><span class="params">(<span class="keyword">short</span> a, <span class="keyword">short</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">short</span> result = ;</span><br><span class="line">    <span class="keyword">while</span> ( ) &#123;</span><br><span class="line">        result = ;</span><br><span class="line">        a = ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>gcc, run with command-line option <code>-Og</code>, produces the following code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">;short loop_while(short a, short b)</span><br><span class="line">;a in %rdi, b in %rsi</span><br><span class="line">loop_while:</span><br><span class="line">    movl $0, %eax</span><br><span class="line">    jmp .L2</span><br><span class="line">.L3:</span><br><span class="line">    leaq (,%rsi,%rdi), %rdx</span><br><span class="line">    addq %rdx, %rax</span><br><span class="line">    subq $1, %rdi</span><br><span class="line">.L2:</span><br><span class="line">    cmpq %rsi, %rdi</span><br><span class="line">    jg .L3</span><br><span class="line">    rep; ret</span><br></pre></td></tr></table></figure>
<p>We can see that the compiler used a jump-to-middle translation, using the <code>jmp</code> instruction on line 3 to jump to the test starting with label <code>.L2</code>. Fill in the missing parts of the C code.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">loop_while</span><span class="params">(<span class="keyword">short</span> a, <span class="keyword">short</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">short</span> result = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (a &gt; b) &#123;</span><br><span class="line">        result = result + a*b;</span><br><span class="line">        a = a - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Practice-Problem-3-25"><a href="#Practice-Problem-3-25" class="headerlink" title="Practice Problem 3.25"></a>Practice Problem 3.25</h3><p>For C code having the general form</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">loop_while2</span><span class="params">(<span class="keyword">long</span> a, <span class="keyword">long</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> result = ;</span><br><span class="line">    <span class="keyword">while</span> ( ) &#123;</span><br><span class="line">        result = ;</span><br><span class="line">        b = ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>gcc, run with command-line option <code>-O1</code>, produces the following code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">;a in %rdi, b in %rsi</span><br><span class="line">loop_while2:</span><br><span class="line">    testq %rsi, %rsi</span><br><span class="line">    jle .L8</span><br><span class="line">    movq %rsi, %rax</span><br><span class="line">.L7:</span><br><span class="line">    imulq %rdi, %rax</span><br><span class="line">    subq %rdi, %rsi</span><br><span class="line">    testq %rsi, %rsi</span><br><span class="line">    jg .L7</span><br><span class="line">    rep; ret</span><br><span class="line">.L8:</span><br><span class="line">	movq %rsi, %rax</span><br><span class="line">	ret</span><br></pre></td></tr></table></figure>
<p>We can see that the compiler used a <strong>guarded-do</strong> translation, using the <code>jle</code> instruction on line 3 to skip over the loop code when the initial test fails. Fill in the missing parts of the C code. Note that the control structure in the assembly code does not exactly match what would be obtained by a direct translation of the C code according to our translation rules. In particular, it has two different <code>ret</code> instructions (lines 10 and 13). However, you can fill out the missing portions of the C code in a way that it will have equivalent behavior to the assembly code.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">loop_while2</span><span class="params">(<span class="keyword">long</span> a, <span class="keyword">long</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> result = b;</span><br><span class="line">    <span class="keyword">while</span> (b &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        result = a*b;</span><br><span class="line">        b = b - a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Practice-Problem-3-26"><a href="#Practice-Problem-3-26" class="headerlink" title="Practice Problem 3.26"></a>Practice Problem 3.26</h3><p>A function <code>test_one</code> has the following overall structure:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">test_one</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">short</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">short</span> val = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (x != <span class="number">0</span>) &#123;</span><br><span class="line">    	val = val ^ x;</span><br><span class="line">        x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> val &amp; <span class="number">0x00</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The gcc C compiler generates the following assembly code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">;short test_one(unsigned short x)</span><br><span class="line">;x in %rdi</span><br><span class="line">test_one:</span><br><span class="line">    movl $1, %eax</span><br><span class="line">    jmp .L5</span><br><span class="line">.L6:</span><br><span class="line">    xorq %rdi, %rax</span><br><span class="line">    shrq %rdi Shift right by 1</span><br><span class="line">.L5:</span><br><span class="line">    testq %rdi, %rdi</span><br><span class="line">    jne .L6</span><br><span class="line">    andl $0, %eax</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<p>Reverse engineer the operation of this code and then do the following:</p>
<p>A. Determine what loop translation method was used.</p>
<p>jump-to-middle</p>
<p>B. Use the assembly-code version to fill in the missing parts of the C code.<br>C. Describe in English what this function computes.</p>
<p>经测试，书中给出的代码有错误。如果运行书中的代码，无论如何，返回值都是0。</p>
<p>把原汇编代码改成</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">;short test_one(unsigned short x)</span><br><span class="line">;x in %rdi</span><br><span class="line">test_one:</span><br><span class="line">    movl $1, %eax</span><br><span class="line">    jmp .L5</span><br><span class="line">.L6:</span><br><span class="line">    xorq %rdi, %rax</span><br><span class="line">    shrq %rdi Shift right by 1</span><br><span class="line">.L5:</span><br><span class="line">    testq %rdi, %rdi</span><br><span class="line">    jne .L6</span><br><span class="line">    andl $1, %eax			;把0改成1</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<p>相应的C代码改成</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">test_one</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">short</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">short</span> val = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (x != <span class="number">0</span>) &#123;</span><br><span class="line">    	val = val ^ x;</span><br><span class="line">        x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> val &amp; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样的代码就实现了答案中所说的计算 x 中1出现次数奇偶性的功能，出现奇数个1返回0，偶数个1返回1。</p>
<p>测试结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x=0x01,val=0</span><br><span class="line">x=0x11,val=1</span><br><span class="line">x=0x111,val=0</span><br></pre></td></tr></table></figure>
<ul>
<li><code>for</code> loops</li>
</ul>
<p><code>for</code> 循环在本质上和 <code>while</code> 循环是相同的。自然地，<code>for</code> 循环也有两种翻译成机器语言的方法 jump-to-middle &amp; guarded-do</p>
<p>下面是一个计算阶乘的C语言函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">fact_for</span><span class="params">(<span class="keyword">long</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> i;</span><br><span class="line">    <span class="keyword">long</span> result = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    	result *= i;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对应的 <code>while</code> 版本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">fact_for_while</span><span class="params">(<span class="keyword">long</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> i = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">long</span> result = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= n)&#123;</span><br><span class="line">        result *= i;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>jump-to-middle 版本机器语言对应的C语言（使用 goto）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">fact_for_jm_goto</span><span class="params">(<span class="keyword">long</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> i = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">long</span> result = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">goto</span> test;</span><br><span class="line">   loop:</span><br><span class="line">    result *= i;</span><br><span class="line">    i++;</span><br><span class="line">   test:</span><br><span class="line">    <span class="keyword">if</span>(i&lt;=n)</span><br><span class="line">        <span class="keyword">goto</span> loop;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>jump-to-middle 版本汇编语言</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">fact_for:</span><br><span class="line">	movl 	$1,%eax</span><br><span class="line">	movl 	$2,%edx</span><br><span class="line">	jmp 	.L8</span><br><span class="line">.L9:</span><br><span class="line">	imulq 	%rdx,%rax</span><br><span class="line">	addq	$1,%rdx</span><br><span class="line">.L8:</span><br><span class="line">	cmpq 	%rdi,%rdx</span><br><span class="line">	jle		.L9</span><br><span class="line">	rep;ret</span><br></pre></td></tr></table></figure>
<h3 id="Practice-Problem-3-27"><a href="#Practice-Problem-3-27" class="headerlink" title="Practice Problem 3.27"></a>Practice Problem 3.27</h3><p>Write <code>goto</code> code for a function called <code>fibonacci</code> to print fibonacci numbers using a <code>while</code> loop. Apply the guarded-do transformation.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fibonacci</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> num1 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> num2 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> counter = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> temp = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(counter == n)</span><br><span class="line">        <span class="keyword">goto</span> done;</span><br><span class="line">   loop:</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,num2);</span><br><span class="line">    temp = num2;</span><br><span class="line">    num2 += num1;</span><br><span class="line">    num1 = temp;</span><br><span class="line">    counter++;</span><br><span class="line">    <span class="keyword">if</span>(counter&lt;n)</span><br><span class="line">        <span class="keyword">goto</span> loop;</span><br><span class="line">   done:</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Practice-Problem-3-28"><a href="#Practice-Problem-3-28" class="headerlink" title="Practice Problem 3.28"></a>Practice Problem 3.28</h3><p>A function <code>test_two</code> has the following overall structure:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">short</span> <span class="title">test_two</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">short</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">short</span> val = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">short</span> i;</span><br><span class="line">    <span class="keyword">for</span> ( ... ; ... ; ... ) &#123;</span><br><span class="line">    ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The gcc C compiler generates the following assembly code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">;test fun_b(unsigned test x)</span><br><span class="line">;x in %rdi</span><br><span class="line">test_two:</span><br><span class="line">    movl $1, %edx</span><br><span class="line">    movl $65, %eax</span><br><span class="line">.L10:</span><br><span class="line">    movq %rdi, %rcx</span><br><span class="line">    andl $1, %ecx</span><br><span class="line">    addq %rax, %rax</span><br><span class="line">    orq %rcx, %rax</span><br><span class="line">    shrq %rdi ;Shift right by 1</span><br><span class="line">    addq $1, %rdx</span><br><span class="line">    jne	.L10</span><br><span class="line">	rep; ret</span><br></pre></td></tr></table></figure>
<p>Reverse engineer the operation of this code and then do the following:</p>
<p>A. Use the assembly-code version to fill in the missing parts of the C code. </p>
<p>结合答案来看这个汇编代码，错误很多啊，为啥第三章代码的错误这么多，真的耽误时间</p>
<p>以下是答案给出的C源代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">fun_b</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">long</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> val = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">long</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">64</span>; i != <span class="number">0</span>; i--) &#123;</span><br><span class="line">        val = (val &lt;&lt; <span class="number">1</span>) | (x &amp; <span class="number">0x1</span>);</span><br><span class="line">        x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用以下命令编译</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -O1 -S .\p328.c</span><br></pre></td></tr></table></figure>
<p>得到的汇编代码（简化后）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">fun_b:</span><br><span class="line">	.seh_endprologue</span><br><span class="line">	movl	$64, %edx		;i=64</span><br><span class="line">	movl	$0, %eax		;val=0</span><br><span class="line">.L2:</span><br><span class="line">	addl	%eax, %eax		;val+=val 或者 val &lt;&lt;= 1</span><br><span class="line">	movl	%ecx, %r8d		;</span><br><span class="line">	andl	$1, %r8d		;(x&amp;1)</span><br><span class="line">	orl	%r8d, %eax			;val |= (x&amp;1)</span><br><span class="line">	shrl	%ecx			;x &gt;&gt;= 1</span><br><span class="line">	subl	$1, %edx		;i--</span><br><span class="line">	jne	.L2</span><br><span class="line">	ret</span><br></pre></td></tr></table></figure>
<p>这样才能对应上，题目给的汇编代码错误很多</p>
<p>B. Explain why there is neither an initial test before the loop nor an initial jump to the test portion of the loop. </p>
<p>C. Describe in English what this function computes. </p>
<p><strong>bit-wise inverse</strong></p>
<h3 id="3-6-8-switch-语句"><a href="#3-6-8-switch-语句" class="headerlink" title="3.6.8 switch 语句"></a>3.6.8 <code>switch</code> 语句</h3><h3 id="Practice-Problem-3-30"><a href="#Practice-Problem-3-30" class="headerlink" title="Practice Problem 3.30"></a>Practice Problem 3.30</h3><p>In the C function that follows, we have omitted the body of the <code>switch</code> statement. In the C code, the case labels did not span a contiguous range, and some cases had multiple labels.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">switch2</span><span class="params">(<span class="keyword">short</span> x, <span class="keyword">short</span> *dest)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">short</span> val = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">switch</span> (x) &#123;</span><br><span class="line">    	...Body of <span class="keyword">switch</span> statement omitted</span><br><span class="line">    &#125;</span><br><span class="line">    *dest = val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In compiling the function, gcc generates the assembly code that follows for the initial part of the procedure, with variable <code>x</code> in <code>%rdi</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">;void switch2(short x, short *dest)</span><br><span class="line">;x in %rdi</span><br><span class="line">switch2:</span><br><span class="line">    addq $2, %rdi		;将x加2以确保最小的label等于0，所以最小的label是-2</span><br><span class="line">    cmpq $8, %rdi		;</span><br><span class="line">    ja .L2				;if x+2&gt;8 goto .L2</span><br><span class="line">    jmp *.L4(,%rdi,8)	;goto </span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.L4:</span><br><span class="line">.quad .L9</span><br><span class="line">.quad .L5</span><br><span class="line">.quad .L6</span><br><span class="line">.quad .L7</span><br><span class="line">.quad .L2</span><br><span class="line">.quad .L7</span><br><span class="line">.quad .L8</span><br><span class="line">.quad .L2</span><br><span class="line">.quad .L5</span><br></pre></td></tr></table></figure>
<p>Based on this information, answer the following questions:</p>
<p>A. What were the values of the case labels in the <code>switch</code> statement?</p>
<p>-2,-1,0,1,3,4,6</p>
<p>B. What cases had multiple labels in the C code?</p>
<p>1和3，-1和6</p>
<h3 id="Practice-Problem-3-31"><a href="#Practice-Problem-3-31" class="headerlink" title="Practice Problem 3.31"></a>Practice Problem 3.31</h3><p>For a C function <code>switcher</code> with the general structure</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">switcher</span><span class="params">(<span class="keyword">long</span> a, <span class="keyword">long</span> b, <span class="keyword">long</span> c, <span class="keyword">long</span> *dest)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> val;</span><br><span class="line">    <span class="keyword">switch</span>(a) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>: <span class="comment">/* Case A */</span></span><br><span class="line">            c = a^<span class="number">15</span>;</span><br><span class="line">            <span class="comment">/* Fall through */</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">/* Case B */</span></span><br><span class="line">            val = c+<span class="number">112</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>: <span class="comment">/* Case C */</span></span><br><span class="line">        <span class="keyword">case</span> <span class="number">7</span>: <span class="comment">/* Case D */</span></span><br><span class="line">            val = (a+c)&lt;&lt;<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>: <span class="comment">/* Case E */</span></span><br><span class="line">            val = b;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">        	val = a;</span><br><span class="line">    &#125;</span><br><span class="line">    *dest = val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">;void switcher(long a, long b, long c, long *dest)</span><br><span class="line">;a in %rsi, b in %rdi, c in %rdx, d in %rcx</span><br><span class="line">switcher:</span><br><span class="line">    cmpq $7, %rdi</span><br><span class="line">    ja .L2</span><br><span class="line">    jmp *.L4(,%rdi,8)</span><br><span class="line">    .section .rodata</span><br><span class="line">  .L7:</span><br><span class="line">    xorq $15, %rsi</span><br><span class="line">    movq %rsi, %rdx</span><br><span class="line">  .L3:</span><br><span class="line">    leaq 112(%rdx), %rdi</span><br><span class="line">    jmp .L6</span><br><span class="line">  .L5:</span><br><span class="line">    leaq (%rdx,%rsi), %rdi</span><br><span class="line">    salq $2, %rdi</span><br><span class="line">    jmp .L6</span><br><span class="line">  .L2:</span><br><span class="line">    movq %rsi, %rdi</span><br><span class="line">  .L6:</span><br><span class="line">    movq %rdi, (%rcx)</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<p>Jump table</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">.L4:</span><br><span class="line">    .quad .L3</span><br><span class="line">    .quad .L2</span><br><span class="line">    .quad .L5</span><br><span class="line">    .quad .L2</span><br><span class="line">    .quad .L6</span><br><span class="line">    .quad .L7</span><br><span class="line">    .quad .L2</span><br><span class="line">    .quad .L5</span><br></pre></td></tr></table></figure>
<h2 id="3-7-过程-procedures"><a href="#3-7-过程-procedures" class="headerlink" title="3.7 过程 procedures"></a>3.7 过程 procedures</h2><p>这里的过程是一种抽象概念，在不同的编程语言中，过程的具体形式有：函数、方法、子例程和处理函数等等</p>
<p>要提供对<strong>过程</strong>的机器级支持，必须处理好以下三件事：控制权的传递、数据（参数）的传递、内存的分配和<strong>释放</strong></p>
<h3 id="3-7-1-运行时栈-run-time-stack"><a href="#3-7-1-运行时栈-run-time-stack" class="headerlink" title="3.7.1 运行时栈 run-time stack"></a>3.7.1 运行时栈 run-time stack</h3><p>x86-64 的栈向<strong>低地址方向</strong>增长，所以<strong>减小栈指针</strong>实际上是<strong>入栈</strong>操作</p>
<p>x86-64 上栈的通用结构</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-16_21-01-00.png" class="">
<h3 id="3-7-2-控制权的转移"><a href="#3-7-2-控制权的转移" class="headerlink" title="3.7.2 控制权的转移"></a>3.7.2 控制权的转移</h3><h3 id="Practice-Problem-3-32"><a href="#Practice-Problem-3-32" class="headerlink" title="Practice Problem 3.32"></a>Practice Problem 3.32</h3><p>The disassembled code for two functions <code>first</code> and <code>last</code> is shown below, along with the code for a call of <code>first</code> by function <code>main</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">;Disassembly of last(long u, long v)</span><br><span class="line">;u in %rdi, v in %rsi</span><br><span class="line">0000000000400540 &lt;last&gt;:</span><br><span class="line">    400540: 48 89 f8 mov %rdi,%rax 			;L1: u</span><br><span class="line">    400543: 48 0f af c6 imul %rsi,%rax 		;L2: u*v</span><br><span class="line">    400547: c3 retq 						;L3: Return</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">;Disassembly of last(long x)</span><br><span class="line">;x in %rdi</span><br><span class="line">0000000000400548 &lt;first&gt;:</span><br><span class="line">    400548: 48 8d 77 01 lea 0x1(%rdi),%rsi 			;F1: x+1</span><br><span class="line">    40054c: 48 83 ef 01 sub $0x1,%rdi 				;F2: x-1</span><br><span class="line">    400550: e8 eb ff ff ff callq 400540 &lt;last&gt; 		;F3: Call last(x-1,x+1)</span><br><span class="line">    400555: f3 c3 repz retq 						;F4: Return</span><br><span class="line">    ...</span><br><span class="line">    400560: e8 e3 ff ff ff callq 400548 &lt;first&gt; 	;M1: Call first(10)</span><br><span class="line">    400565: 48 89 c2 mov %rax,%rdx 					;M2: Resume</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">Label</th>
<th style="text-align:center">PC</th>
<th style="text-align:center">Instruction</th>
<th style="text-align:center">%rdi</th>
<th style="text-align:center">%rsi</th>
<th style="text-align:center">%rax</th>
<th style="text-align:center">%rsp</th>
<th style="text-align:center">*%rsp</th>
<th style="text-align:center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">M1</td>
<td style="text-align:center">0x400560</td>
<td style="text-align:center">callq</td>
<td style="text-align:center">10</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">0x7fffffffe820</td>
<td style="text-align:center">-</td>
<td style="text-align:center">call first(10)</td>
</tr>
<tr>
<td style="text-align:center">F1</td>
<td style="text-align:center">0x400548</td>
<td style="text-align:center">lea</td>
<td style="text-align:center">10</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">0x7fffffffe818</td>
<td style="text-align:center">0x400565</td>
<td style="text-align:center">lea 0x1(%rdi),%rsi</td>
</tr>
<tr>
<td style="text-align:center">F2</td>
<td style="text-align:center">0x40054c</td>
<td style="text-align:center">sub</td>
<td style="text-align:center">10</td>
<td style="text-align:center">11</td>
<td style="text-align:center">-</td>
<td style="text-align:center">0x7fffffffe818</td>
<td style="text-align:center">0x400565</td>
<td style="text-align:center">sub $0x1,%rdi</td>
</tr>
<tr>
<td style="text-align:center">F3</td>
<td style="text-align:center">0x400550</td>
<td style="text-align:center">callq</td>
<td style="text-align:center">9</td>
<td style="text-align:center">11</td>
<td style="text-align:center">-</td>
<td style="text-align:center">0x7fffffffe818</td>
<td style="text-align:center">0x400565</td>
<td style="text-align:center">call last(9,11)</td>
</tr>
<tr>
<td style="text-align:center">L1</td>
<td style="text-align:center">0x400540</td>
<td style="text-align:center">mov</td>
<td style="text-align:center">9</td>
<td style="text-align:center">11</td>
<td style="text-align:center">-</td>
<td style="text-align:center">0x7fffffffe810</td>
<td style="text-align:center">0x400555</td>
<td style="text-align:center">mov %rdi,%rax</td>
</tr>
<tr>
<td style="text-align:center">L2</td>
<td style="text-align:center">0x400543</td>
<td style="text-align:center">imul</td>
<td style="text-align:center">9</td>
<td style="text-align:center">11</td>
<td style="text-align:center">9</td>
<td style="text-align:center">0x7fffffffe810</td>
<td style="text-align:center">0x400555</td>
<td style="text-align:center">imul %rsi,%rax</td>
</tr>
<tr>
<td style="text-align:center">L3</td>
<td style="text-align:center">0x400547</td>
<td style="text-align:center">retq</td>
<td style="text-align:center">9</td>
<td style="text-align:center">11</td>
<td style="text-align:center">99</td>
<td style="text-align:center">0x7fffffffe810</td>
<td style="text-align:center">0x400555</td>
<td style="text-align:center">retq</td>
</tr>
<tr>
<td style="text-align:center">F4</td>
<td style="text-align:center">0x400555</td>
<td style="text-align:center">repz retq</td>
<td style="text-align:center">9</td>
<td style="text-align:center">11</td>
<td style="text-align:center">99</td>
<td style="text-align:center">0x7fffffffe818</td>
<td style="text-align:center">0x400565</td>
<td style="text-align:center">repz retq</td>
</tr>
<tr>
<td style="text-align:center">M2</td>
<td style="text-align:center">0x400565</td>
<td style="text-align:center">mov</td>
<td style="text-align:center">9</td>
<td style="text-align:center">11</td>
<td style="text-align:center">99</td>
<td style="text-align:center">0x7fffffffe820</td>
<td style="text-align:center">-</td>
<td style="text-align:center">mov %rax,%rdx</td>
</tr>
</tbody>
</table>
</div>
<h3 id="3-7-3-数据（参数）传递"><a href="#3-7-3-数据（参数）传递" class="headerlink" title="3.7.3 数据（参数）传递"></a>3.7.3 数据（参数）传递</h3><p>x86-64中，可以通过<strong>寄存器</strong>最多传递6个<strong>整型</strong>参数</p>
<p>寄存器的使用是有特殊顺序的，寄存器使用的名字取决于要传递的数据类型的大小</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-16_23-18-38.png" class="">
<p>如果函数要传递的参数超过6个，则超过的部分就要用<strong>栈</strong>来传递</p>
<h3 id="Practice-Problem-3-33"><a href="#Practice-Problem-3-33" class="headerlink" title="Practice Problem 3.33"></a>Practice Problem 3.33</h3><p>A C function <code>procprob</code> has four arguments u, a, v, and b. Each is either a signed number or a pointer to a signed number, where the numbers have different sizes. The function has the following body:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">*u += a;</span><br><span class="line">*v += b;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">sizeof</span>(a) + <span class="keyword">sizeof</span>(b);</span><br></pre></td></tr></table></figure>
<p>It compiles to the following x86-64 code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">procprob:</span><br><span class="line">    movslq %edi, %rdi</span><br><span class="line">    addq %rdi, (%rdx)</span><br><span class="line">    addb %sil, (%rcx)</span><br><span class="line">    movl $6, %eax</span><br><span class="line">	ret</span><br></pre></td></tr></table></figure>
<p>Determine a valid ordering and types of the four parameters. There are two correct answers.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">procprob(<span class="keyword">int</span> a,<span class="keyword">short</span> b,<span class="keyword">long</span> *u,<span class="keyword">char</span> *v)</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">procprob(<span class="keyword">int</span> b,<span class="keyword">short</span> a,<span class="keyword">long</span> *v,<span class="keyword">char</span> *u)</span><br></pre></td></tr></table></figure>
<h3 id="3-7-4-栈上的局部存储"><a href="#3-7-4-栈上的局部存储" class="headerlink" title="3.7.4 栈上的局部存储"></a>3.7.4 栈上的局部存储</h3><p>一般的函数不会使用栈存储，但是以下几种情况则需要使用栈作为存储区域：</p>
<ul>
<li>函数参数过多，寄存器不足以存放</li>
<li>对一个局部变量使用 ‘&amp;’ 取地址运算符，因为需要获得地址，而寄存器没有地址，所以需要使用栈</li>
<li>某些局部变量是结构或者数组，因此必须能够通过数组或结构被引用到，也需要存放在栈中</li>
</ul>
<p>看一个例子：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">call_proc</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> x1 = <span class="number">1</span>; <span class="keyword">int</span> x2 = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">short</span> x3 = <span class="number">3</span>; <span class="keyword">char</span> x4 = <span class="number">4</span>;</span><br><span class="line">    proc(x1, &amp;x1, x2, &amp;x2, x3, &amp;x3, x4, &amp;x4);</span><br><span class="line">    <span class="keyword">return</span> (x1+x2)*(x3-x4);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对应的汇编代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">long call_proc()</span><br><span class="line">call_proc:</span><br><span class="line">	;Set up arguments to proc</span><br><span class="line">	subq $32, %rsp ;Allocate 32-byte stack frame</span><br><span class="line">	movq $1, 24(%rsp) ;Store 1 in &amp;x1</span><br><span class="line">	movl $2, 20(%rsp) ;Store 2 in &amp;x2</span><br><span class="line">	movw $3, 18(%rsp) ;Store 3 in &amp;x3</span><br><span class="line">	movb $4, 17(%rsp) ;Store 4 in &amp;x4</span><br><span class="line">	leaq 17(%rsp), %rax ;Create &amp;x4</span><br><span class="line">	movq %rax, 8(%rsp) ;Store &amp;x4 as argument 8</span><br><span class="line">	movl $4, (%rsp) ;Store 4 as argument 7</span><br><span class="line">	leaq 18(%rsp), %r9 ;Pass &amp;x3 as argument 6</span><br><span class="line">	movl $3, %r8d ;Pass 3 as argument 5</span><br><span class="line">	leaq 20(%rsp), %rcx ;Pass &amp;x2 as argument 4</span><br><span class="line">	movl $2, %edx ;Pass 2 as argument 3</span><br><span class="line">	leaq 24(%rsp), %rsi ;Pass &amp;x1 as argument 2</span><br><span class="line">	movl $1, %edi ;Pass 1 as argument 1</span><br><span class="line"> 	;Call proc</span><br><span class="line">	call proc</span><br><span class="line">	;Retrieve changes to memory</span><br><span class="line">	movslq 20(%rsp), %rdx ;Get x2 and convert to long</span><br><span class="line">	addq 24(%rsp), %rdx ;Compute x1+x2</span><br><span class="line">	movswl 18(%rsp), %eax ;Get x3 and convert to int</span><br><span class="line">	movsbl 17(%rsp), %ecx ;Get x4 and convert to int</span><br><span class="line">	subl %ecx, %eax ;Compute x3-x4</span><br><span class="line">	cltq ;Convert to long</span><br><span class="line">	imulq %rdx, %rax ;Compute (x1+x2) * (x3-x4)</span><br><span class="line">	addq $32, %rsp ;Deallocate stack frame</span><br><span class="line">	ret ;Return</span><br></pre></td></tr></table></figure>
<p>可以看到汇编代码的大部分都在为调用proc这个函数做准备</p>
<p>它先是将 stack pointer 减去32来开辟一块32字节大小的栈内存，然后依次存储x1，x2，x3，x4</p>
<p>接着将参数1到参数6保存到规定的寄存器，参数7和参数8则放在栈上（相对栈指针的偏移地址分别为0和8）</p>
<p>这个函数的栈帧如下图所示：</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-17_02-11-00.png" class="">
<h3 id="3-7-5-寄存器中的局部存储空间"><a href="#3-7-5-寄存器中的局部存储空间" class="headerlink" title="3.7.5 寄存器中的局部存储空间"></a>3.7.5 寄存器中的局部存储空间</h3><p>x86-64中的寄存器分为两种：被调用者保存寄存器和调用者保存寄存器</p>
<h3 id="3-7-6-递归过程"><a href="#3-7-6-递归过程" class="headerlink" title="3.7.6 递归过程"></a>3.7.6 递归过程</h3><p>递归函数的一个经典例子：阶乘函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">rfact</span><span class="params">(<span class="keyword">long</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> result;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">1</span>)</span><br><span class="line">    result = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    result = n * rfact(n<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对应的汇编代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">;long rfact(long n)</span><br><span class="line">;n in %rdi</span><br><span class="line">rfact:</span><br><span class="line">    pushq %rbx 				;Save %rbx</span><br><span class="line">    movq %rdi, %rbx 		;Store n in callee-saved register</span><br><span class="line">    movl $1, %eax 			;Set return value = 1</span><br><span class="line">    cmpq $1, %rdi 			;Compare n:1</span><br><span class="line">    jle .L35 				;If &lt;=, goto done</span><br><span class="line">    leaq -1(%rdi), %rdi 	;Compute n-1</span><br><span class="line">    call rfact 				;Call rfact(n-1)</span><br><span class="line">    imulq %rbx, %rax 		;Multiply result by n</span><br><span class="line">.L35: 						;done:</span><br><span class="line">    popq %rbx 				;Restore %rbx</span><br><span class="line">    ret 					;Return</span><br></pre></td></tr></table></figure>
<h3 id="Practice-Problem-3-35"><a href="#Practice-Problem-3-35" class="headerlink" title="Practice Problem 3.35"></a>Practice Problem 3.35</h3><p>For a C function having the general structure</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">rfun</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">long</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="number">0</span>)</span><br><span class="line">    	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> nx = x&gt;&gt;<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">long</span> rv = rfun(nx);</span><br><span class="line">    <span class="keyword">return</span> x+rv;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>gcc generates the following assembly code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">;long rfun(unsigned long x)</span><br><span class="line">;x in %rdi</span><br><span class="line">rfun:</span><br><span class="line">    pushq %rbx</span><br><span class="line">    movq %rdi, %rbx</span><br><span class="line">    movl $0, %eax</span><br><span class="line">    testq %rdi, %rdi</span><br><span class="line">    je .L2</span><br><span class="line">    shrq $2, %rdi</span><br><span class="line">    call rfun</span><br><span class="line">    addq %rbx, %rax</span><br><span class="line">.L2:</span><br><span class="line">    popq %rbx</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<p>A. What value does <code>rfun</code> store in the callee-saved register <code>%rbx</code>?</p>
<p><del>rv</del>  x</p>
<p>B. Fill in the missing expressions in the C code shown above.</p>
<h2 id="3-8-数组分配和访问"><a href="#3-8-数组分配和访问" class="headerlink" title="3.8 数组分配和访问"></a>3.8 数组分配和访问</h2><h3 id="3-8-1-基本原则"><a href="#3-8-1-基本原则" class="headerlink" title="3.8.1 基本原则"></a>3.8.1 基本原则</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">T A[N];</span><br></pre></td></tr></table></figure>
<p>起始位置为 $x_A$ ，这个声明会分配长为 $L*N$ 的连续内存，$L$ 是类型 T 的大小</p>
<p>第一个元素被存放在 $x_A$ 地址处，第 $i$ 个元素存放在 $x_A+L*i$ 地址处</p>
<h3 id="Practice-Problem-3-36"><a href="#Practice-Problem-3-36" class="headerlink" title="Practice Problem 3.36"></a>Practice Problem 3.36</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> P[<span class="number">5</span>];</span><br><span class="line"><span class="keyword">short</span> Q[<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> **R[<span class="number">9</span>];</span><br><span class="line"><span class="keyword">double</span> *S[<span class="number">10</span>];</span><br><span class="line"><span class="keyword">short</span> *T[<span class="number">2</span>];</span><br></pre></td></tr></table></figure>
<p>Fill in the following table describing the element size, the total size, and the address of element <code>i</code> for each of these arrays.</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Array</th>
<th>Element size</th>
<th>Total size</th>
<th>Start address</th>
<th>Element i</th>
</tr>
</thead>
<tbody>
<tr>
<td>P</td>
<td>4</td>
<td>4*5=20</td>
<td>$x_P$</td>
<td>$x_P+4*i$</td>
</tr>
<tr>
<td>Q</td>
<td>2</td>
<td>4</td>
<td>$x_Q$</td>
<td>$x_Q+2*i$</td>
</tr>
<tr>
<td>R</td>
<td>8</td>
<td>72</td>
<td>$x_R$</td>
<td>$x_R+8*i$</td>
</tr>
<tr>
<td>S</td>
<td>8</td>
<td>80</td>
<td>$x_S$</td>
<td>$x_S+8*i$</td>
</tr>
<tr>
<td>T</td>
<td>8</td>
<td>16</td>
<td>$x_T$</td>
<td>$x_T+8*i$</td>
</tr>
</tbody>
</table>
</div>
<h3 id="3-8-2-指针运算"><a href="#3-8-2-指针运算" class="headerlink" title="3.8.2 指针运算"></a>3.8.2 指针运算</h3><p>C语言允许对指针进行运算，运算结果会根据指针指向的类型进行伸缩。比如指针 $p$ 指向一个类型长度为 $L$ 的类型，那么 $p+i$ 的运算结果就是 $x_p+L*i$</p>
<p>现在假设我们有一个整型数组 <code>E</code> 和整型索引 <code>i</code> 分别存放在寄存器 %rdx 和 %rcx 中</p>
 <img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-17_14-30-30.png" class="">
<p>注意图中两个高亮部分的区别，获取地址用的是 <code>leaq</code> 指令，获取地址处的内容用 <code>movl</code> 指令</p>
<h3 id="Practice-Problem-3-37"><a href="#Practice-Problem-3-37" class="headerlink" title="Practice Problem 3.37"></a>Practice Problem 3.37</h3><p>Suppose $x_P$ , the address of short integer array $P$, and long integer index $i$ are stored in registers <code>%rdx</code> and <code>%rcx</code>, respectively. For each of the following expressions, give its type, a formula for its value, and an assembly-code implementation. The result should be stored in register <code>%rax</code> if it is a <strong>pointer</strong> and register element <code>%ax</code> if it has data type <strong>short</strong>.</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Expression</th>
<th>Type</th>
<th>Value</th>
<th>Assembly code</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>P[1]</code></td>
<td><code>short</code></td>
<td>M[$x_P+2*1$]</td>
<td>movw 2(%rdx),%ax</td>
</tr>
<tr>
<td><code>P+3+i</code></td>
<td><del><code>long</code></del> <code>short *</code></td>
<td>$x_P+6+2*i$</td>
<td>leaq 6(%rdx,%rcx,2),%rax</td>
</tr>
<tr>
<td><code>P[i*6-5]</code></td>
<td><code>short</code></td>
<td>M[$x_P+12*i-10$]</td>
<td>movw -10(%rdx,%rcx,12),%ax</td>
</tr>
<tr>
<td><code>P[2]</code></td>
<td><code>short</code></td>
<td>M[$x_P+2*2$]</td>
<td>movw 4(%rdx),%ax</td>
</tr>
<tr>
<td><code>&amp;P[i+2]</code></td>
<td><del><code>long</code></del> <code>short *</code></td>
<td>$x_P+2*i+4$</td>
<td>leaq 4(%rdx,%rcx,2),%rax</td>
</tr>
</tbody>
</table>
</div>
<h3 id="3-8-3-嵌套的数组"><a href="#3-8-3-嵌套的数组" class="headerlink" title="3.8.3 嵌套的数组"></a>3.8.3 嵌套的数组</h3><p>就是数组的数组</p>
<p>嵌套数组的引用和一维数组的没什么不同</p>
<h3 id="Practice-Problem-3-38"><a href="#Practice-Problem-3-38" class="headerlink" title="Practice Problem 3.38"></a>Practice Problem 3.38</h3><p>Consider the following source code, where <code>M</code> and <code>N</code> are constants declared with <code>#define</code>:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> P[M][N];</span><br><span class="line"><span class="keyword">long</span> Q[N][M];</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">sum_element</span><span class="params">(<span class="keyword">long</span> i, <span class="keyword">long</span> j)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> P[i][j] + Q[j][i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">;long sum_element(long i, long j)</span><br><span class="line">;i in %rdi, j in %rsi</span><br><span class="line">sum_element:</span><br><span class="line">    leaq 0(,%rdi,8), %rdx</span><br><span class="line">    subq %rdi, %rdx</span><br><span class="line">    addq %rsi, %rdx</span><br><span class="line">    leaq (%rsi,%rsi,4), %rax</span><br><span class="line">    addq %rax, %rdi</span><br><span class="line">    movq Q(,%rdi,8), %rax</span><br><span class="line">    addq P(,%rdx,8), %rax</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<p>Use your reverse engineering skills to determine the values of <code>M</code> and <code>N</code> based on this assembly code.</p>
<p>M=5,N=7</p>
<h3 id="3-8-4-定长数组"><a href="#3-8-4-定长数组" class="headerlink" title="3.8.4 定长数组"></a>3.8.4 定长数组</h3><p>对于定长数组的使用，编译器会自动进行很多优化，例如下面这个函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 16</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> fix_matrix[N][N];</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Compute i,k of fixed matrix product */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fix_prod_ele</span> <span class="params">(fix_matrix A, fix_matrix B, <span class="keyword">long</span> i, <span class="keyword">long</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> j;</span><br><span class="line">    <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; N; j++)</span><br><span class="line">    	result += A[i][j] * B[j][k];</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>优化后的C代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Compute i,k of fixed matrix product */</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fix_prod_ele_opt</span><span class="params">(fix_matrix A, fix_matrix B, <span class="keyword">long</span> i, <span class="keyword">long</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> *Aptr = &amp;A[i][<span class="number">0</span>]; <span class="comment">/* Points to elements in row i of A */</span></span><br><span class="line">    <span class="keyword">int</span> *Bptr = &amp;B[<span class="number">0</span>][k]; <span class="comment">/* Points to elements in column k of B */</span></span><br><span class="line">    <span class="keyword">int</span> *Bend = &amp;B[N][k]; <span class="comment">/* Marks stopping point for Bptr */</span></span><br><span class="line">    <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span> &#123; 							<span class="comment">/* No need for initial test */</span></span><br><span class="line">        result += *Aptr * *Bptr; 	<span class="comment">/* Add next product to sum */</span></span><br><span class="line">        Aptr ++; 					<span class="comment">/* Move Aptr to next column */</span></span><br><span class="line">        Bptr += N; 					<span class="comment">/* Move Bptr to next row */</span></span><br><span class="line">    &#125; <span class="keyword">while</span> (Bptr != Bend); 		<span class="comment">/* Test for stopping point */</span></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对应的汇编代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">;int fix_prod_ele_opt(fix_matrix A, fix_matrix B, long i, long k)</span><br><span class="line">;A in %rdi, B in %rsi, i in %rdx, k in %rcx</span><br><span class="line">fix_prod_ele:</span><br><span class="line">    salq $6, %rdx 						;Compute 64 * i</span><br><span class="line">    addq %rdx, %rdi 					;Compute Aptr = xA + 64i = &amp;A[i][0]</span><br><span class="line">    leaq (%rsi,%rcx,4), %rcx 			;Compute Bptr = xB + 4k = &amp;B[0][k]</span><br><span class="line">    leaq 1024(%rcx), %rsi 				;Compute Bend = xB + 4k + 1024 = &amp;B[N][k]</span><br><span class="line">    movl $0, %eax 						;Set result = 0</span><br><span class="line">.L7: 									;loop:</span><br><span class="line">    movl (%rdi), %edx 					;Read *Aptr</span><br><span class="line">    imull (%rcx), %edx 					;Multiply by *Bptr</span><br><span class="line">    addl %edx, %eax 					;Add to result</span><br><span class="line">    addq $4, %rdi 						;Increment Aptr ++</span><br><span class="line">    addq $64, %rcx 						;Increment Bptr += N</span><br><span class="line">    cmpq %rsi, %rcx 					;Compare Bptr:Bend</span><br><span class="line">    jne .L7 							;If !=, goto loop</span><br><span class="line">    rep; ret 							;Return</span><br></pre></td></tr></table></figure>
<h3 id="Practice-Problem-3-40"><a href="#Practice-Problem-3-40" class="headerlink" title="Practice Problem 3.40"></a>Practice Problem 3.40</h3><p>The following C code sets the diagonal elements of one of our fixed-size arrays to <code>val</code>:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Set all diagonal elements to val */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fix_set_diag</span><span class="params">(fix_matrix A, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">    	A[i][i] = val;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>When compiled with optimization level <code>-O1</code>, gcc generates the following assembly code:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fix_set_diag:</span><br><span class="line">;void fix_set_diag(fix_matrix A, int val)</span><br><span class="line">;A in %rdi, val in %rsi</span><br><span class="line">	movl $0, %eax</span><br><span class="line">.L13:</span><br><span class="line">    movl %esi, (%rdi,%rax)</span><br><span class="line">    addq $68, %rax</span><br><span class="line">    cmpq $1088, %rax</span><br><span class="line">    jne .L13</span><br><span class="line">    rep; ret</span><br></pre></td></tr></table></figure>
<p>Create a C code program <code>fix_set_diag_opt</code> that uses optimizations similar to those in the assembly code, in the same style as the optimized code in 3.8.4. Use expressions involving the parameter <code>N</code> rather than integer constants, so that your code will work correctly if <code>N</code> is redefined.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 16</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> fix_matrix[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fix_set_diag_opt</span><span class="params">(fix_matrix A,<span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> *Aptr = A;</span><br><span class="line">    <span class="keyword">int</span> *Aend = &amp;A[N][N];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">        *Aptr = val;</span><br><span class="line">        Aptr += (N+<span class="number">1</span>);</span><br><span class="line">    &#125;<span class="keyword">while</span>(Aptr != Aend)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-9-异质（Heterogeneous）的数据结构"><a href="#3-9-异质（Heterogeneous）的数据结构" class="headerlink" title="3.9 异质（Heterogeneous）的数据结构"></a>3.9 异质（Heterogeneous）的数据结构</h2><p>将不同类型对象组合到一起创建的数据类型</p>
<p>C语言中有两种这样的数据结构：struct 和 union</p>
<h3 id="3-9-1-结构-strcut"><a href="#3-9-1-结构-strcut" class="headerlink" title="3.9.1 结构 strcut"></a>3.9.1 结构 strcut</h3><p>几个重要的点：</p>
<ul>
<li>结构的所有组成部分都存放在内存中一段<strong>连续</strong>的区域内</li>
<li>指向结构的指针就是结构第一个字节的地址（和数组类似）</li>
<li>编译器维护关于每个结构的信息，记录每个字段的字节偏移，从而可以使用结构指针和偏移引用结构元素</li>
</ul>
<h3 id="Practice-Problem-3-41"><a href="#Practice-Problem-3-41" class="headerlink" title="Practice Problem 3.41"></a>Practice Problem 3.41</h3><p>Consider the following structure declaration:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">test</span> &#123;</span></span><br><span class="line">    <span class="keyword">short</span> *p;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">        <span class="keyword">short</span> x;</span><br><span class="line">        <span class="keyword">short</span> y;</span><br><span class="line">    &#125; s;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">test</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>The following procedure (with some expressions omitted) operates on this structure:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">st_init</span><span class="params">(struct test *st)</span> </span>&#123;</span><br><span class="line">    st-&gt;s.y = st-&gt;s.x;</span><br><span class="line">    st-&gt;p = &amp;(st-&gt;s.y);</span><br><span class="line">    st-&gt;next = st;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>A. What are the offsets (in <strong>bytes</strong>) of the following fields?</p>
<p>p : 0</p>
<p>s.x : 8</p>
<p>s.y : 10</p>
<p>next : 12</p>
<p>B. How many total bytes does the structure require?</p>
<p>8+2*2+8=20</p>
<p>C. The compiler generates the following assembly code for <code>st_init</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">;void st_init(struct test *st)</span><br><span class="line">;st in %rdi</span><br><span class="line">st_init:</span><br><span class="line">    movl 8(%rdi), %eax</span><br><span class="line">    movl %eax, 10(%rdi)</span><br><span class="line">    leaq 10(%rdi), %rax</span><br><span class="line">    movq %rax, (%rdi)</span><br><span class="line">    movq %rdi, 12(%rdi)</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<p>On the basis of this information, fill in the missing expressions in the code for <code>st_init</code>.</p>
<h3 id="3-9-2-unions"><a href="#3-9-2-unions" class="headerlink" title="3.9.2 unions"></a>3.9.2 unions</h3><p>联合提供了一种规避C语言类型系统的方法，允许使用多种类型来引用一个对象</p>
<p>联合还可以用来访问不同数据类型的位模式。例如，假设我们简单地将一个 <code>double</code> 类型的值 <code>d</code> 转换为 <code>unsigned long</code> 类型的 <code>u</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">long</span> u = (<span class="keyword">unsigned</span> <span class="keyword">long</span>) d;</span><br></pre></td></tr></table></figure>
<p><code>u</code> 将会是 <code>d</code> 的整数部分。除了 d=0.0 之外，<code>u</code> 和 <code>d</code> 的位表示会很不一样</p>
<p>再看下面的代码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="title">double2bits</span><span class="params">(<span class="keyword">double</span> d)</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">        <span class="keyword">double</span> d;</span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">long</span> u;</span><br><span class="line">    &#125; temp;</span><br><span class="line">    temp.d = d;</span><br><span class="line">    <span class="keyword">return</span> temp.u;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>以 <code>double</code> 类型存储 <code>d</code> ，以 <code>unsigned long</code> 类型返回它，就实现了<strong>不改变位模式</strong>的类型转换</p>
<h3 id="Practice-Problem-3-43"><a href="#Practice-Problem-3-43" class="headerlink" title="Practice Problem 3.43"></a>Practice Problem 3.43</h3><p>Suppose you are given the job of checking that a C compiler generates the proper code for structure and union access. You write the following structure declaration:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">        <span class="keyword">long</span> u;</span><br><span class="line">        <span class="keyword">short</span> v;</span><br><span class="line">        <span class="keyword">char</span> w;</span><br><span class="line">    &#125; t1;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">        <span class="keyword">int</span> a[<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">char</span> *p;</span><br><span class="line">    &#125; t2;</span><br><span class="line">&#125; u_type;</span><br></pre></td></tr></table></figure>
<p>You write a series of functions of the form</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get</span><span class="params">(u_type *up, type *dest)</span> </span>&#123;</span><br><span class="line">	*dest = expr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>with different access expressions <code>expr</code> and with destination data type <em>type</em> set according to type associated with <code>expr</code>. You then examine the code generated when compiling the functions to see if they match your expectations.</p>
<p>Suppose in these functions that <code>up</code> and <code>dest</code> are loaded into registers <code>%rdi</code> and <code>%rsi</code>, respectively. Fill in the following table with data type <code>type</code> and sequences of one to three instructions to compute the expression and store the result at <code>dest</code>.</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">expr</th>
<th style="text-align:center">type</th>
<th style="text-align:center">Code</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">up-&gt;t1.u</td>
<td style="text-align:center">long</td>
<td style="text-align:center">movq (%rdi),%rax  movq %rax,(%rsi)</td>
</tr>
<tr>
<td style="text-align:center">up-&gt;t1.v</td>
<td style="text-align:center">short</td>
<td style="text-align:center">movw 8(%rdi),%ax movw %ax,(%rsi)</td>
</tr>
<tr>
<td style="text-align:center">&amp;up-&gt;t1.w</td>
<td style="text-align:center">char *</td>
<td style="text-align:center">leaq 10(%rdi),(%rsi)</td>
</tr>
<tr>
<td style="text-align:center">up-&gt;t2.a[up-&gt;t1.u]</td>
<td style="text-align:center">int</td>
<td style="text-align:center">movq (%rdi),%rax movl 11(%rdi,%rax,4),%eax mov %eax,(%rsi)</td>
</tr>
</tbody>
</table>
</div>
<h3 id="3-9-3-数据对齐"><a href="#3-9-3-数据对齐" class="headerlink" title="3.9.3 数据对齐"></a>3.9.3 数据对齐</h3><p>数据对齐是提高内存操作性能的一种方法。</p>
<p>举个例子，一个处理器每次只能从内存地址为8的倍数的地方一次性读取8个字节，如果我们能保证所有double型的数据都保存在以8的倍数地址为起始地址的地方，那么处理器只需一个内存读取操作就能获得这个double型数据，否则需要两次。</p>
<p>数据对齐的规则：</p>
<p>$K$ 字节大小的数据的起始地址必须是 $K$ 的倍数</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-18_14-16-41.png" class="">
<h3 id="Practice-Problem-3-44"><a href="#Practice-Problem-3-44" class="headerlink" title="Practice Problem 3.44"></a>Practice Problem 3.44</h3><p>For each of the following structure declarations, determine the offset of each field, the total size of the structure, and its alignment requirement for x86-64:</p>
<p>A. <code>struct P1 &#123; short i; int c; int *j; short *d; &#125;;</code></p>
<p>最小22字节，偏移分别是0，2，6，14</p>
<p>要求数据对齐：大小24字节，偏移分别是0，4，8，16，结构的起始地址需要是4的倍数</p>
<p>C. <code>struct P3 &#123; long w[2]; int *c[2] &#125;;</code></p>
<p>最小32字节，偏移分别是0，8，16，24</p>
<p>要求数据对齐：大小32字节，起始地址需要是8的倍数</p>
<p>D. <code>struct P4 &#123; char w[16]; char *c[2] &#125;;</code></p>
<p>最小32字节，偏移地址为0，16</p>
<p>对齐要求：起始地址是8的倍数</p>
<p>E.<code>struct P5 &#123; struct P4 a[2]; struct P1 t &#125;;</code></p>
<p>最小86字节</p>
<p>对齐要求：大小88字节，起始地址是8的倍数</p>
<h2 id="3-10-在机器级程序中将控制与数据结合起来"><a href="#3-10-在机器级程序中将控制与数据结合起来" class="headerlink" title="3.10 在机器级程序中将控制与数据结合起来"></a>3.10 在机器级程序中将控制与数据结合起来</h2><h3 id="3-10-1-理解指针"><a href="#3-10-1-理解指针" class="headerlink" title="3.10.1 理解指针"></a>3.10.1 理解指针</h3><p>一些指针和机器码映射的关键原则</p>
<ul>
<li>每个指针都对应一个类型</li>
<li><p>每个指针都有一个值</p>
</li>
<li><p>指针可以指向函数</p>
</li>
</ul>
<h3 id="3-10-2-使用GDB调试器"><a href="#3-10-2-使用GDB调试器" class="headerlink" title="3.10.2 使用GDB调试器"></a>3.10.2 使用GDB调试器</h3><img src="/2021/11/20/CSAPP-Ch3/308.png" class="">
<h3 id="3-10-3-内存越界引用和缓冲区溢出"><a href="#3-10-3-内存越界引用和缓冲区溢出" class="headerlink" title="3.10.3 内存越界引用和缓冲区溢出"></a>3.10.3 内存越界引用和缓冲区溢出</h3><p>大名鼎鼎的蠕虫就是利用缓冲区溢出进行攻击的</p>
<h3 id="Practice-Problem-3-46"><a href="#Practice-Problem-3-46" class="headerlink" title="Practice Problem 3.46"></a>Practice Problem 3.46</h3><p>The code below shows a (low-quality) implementation of a function that reads a line from standard input, copies the string to newly allocated storage, and returns a pointer to the result.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* This is very low-quality code.</span></span><br><span class="line"><span class="comment">It is intended to illustrate bad programming practices.</span></span><br><span class="line"><span class="comment">See Practice Problem 3.46. */</span></span><br><span class="line"><span class="function"><span class="keyword">char</span> *<span class="title">get_line</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> buf[<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">char</span> *result;</span><br><span class="line">    gets(buf);</span><br><span class="line">    result = <span class="built_in">malloc</span>(<span class="built_in">strlen</span>(buf));</span><br><span class="line">    <span class="built_in">strcpy</span>(result, buf);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Disassembly up through call to <code>gets</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">;char *get_line()</span><br><span class="line">0000000000400720 &lt;get_line&gt;:</span><br><span class="line">    400720: 53 				push %rbx</span><br><span class="line">    400721: 48 83 ec 10 	sub $0x10,%rsp</span><br><span class="line">;Diagram stack at this point</span><br><span class="line">    400725: 48 89 e7 		mov %rsp,%rdi</span><br><span class="line">    400728: e8 73 ff ff ff 	callq 4006a0 &lt;gets&gt;</span><br><span class="line">;Modify diagram to show stack contents at this point</span><br></pre></td></tr></table></figure>
<p>Consider the following scenario. Procedure <code>get_line</code> is called with the return address equal to 0x400076 and register <code>%rbx</code> equal to 0x0123456789ABCDEF. You type in the string</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0123456789012345678901234</span><br></pre></td></tr></table></figure>
<p>The program terminates with a segmentation fault. You run gdb and determine that the error occurs during the execution of the <code>ret</code> instruction of <code>get_line</code>.</p>
<p>A. Fill in the diagram that follows, indicating as much as you can about the stack just <strong>after executing</strong> the instruction at line 4 in the disassembly. Label the quantities stored on the stack (e.g., “Return address”) on the right, and their hexadecimal values (if known) within the box. Each box represents 8 bytes. Indicate the position of <code>%rsp</code>. Recall that the ASCII codes for characters 0–9 are 0x30–0x39.</p>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>00 00 00 00 00 40 00 76</td>
<td>Return address</td>
</tr>
<tr>
<td>01 23 45 67 89 AB CD EF</td>
<td>%rbx</td>
</tr>
<tr>
<td>-</td>
<td></td>
</tr>
<tr>
<td>-</td>
<td>%rsp</td>
</tr>
</tbody>
</table>
</div>
<p>B. Modify your diagram to show the effect of the call to gets (line 7).</p>
<div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>00 00 00 00 00 40 00 34</td>
<td>Return address</td>
</tr>
<tr>
<td>33 32 31 30 39 38 37 36</td>
<td>%rbx</td>
</tr>
<tr>
<td>35 34 33 32 31 30 39 38</td>
<td></td>
</tr>
<tr>
<td>37 36 35 34 33 32 31 30</td>
<td>%rsp</td>
</tr>
</tbody>
</table>
</div>
<p>C. To what address does the program attempt to return?</p>
<p>0x40 00 34</p>
<p>D. What register(s) have corrupted value(s) when get_line returns?</p>
<p>%rbx</p>
<p>E. Besides the potential for buffer overflow, what two other things are wrong with the code for <code>get_line</code>?</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = malloc(strlen(buf)+1);</span><br></pre></td></tr></table></figure>
<p>应该检查 <code>malloc</code> 返回 <code>NULL</code> 的情况</p>
<h3 id="3-10-4-对抗缓冲区溢出攻击"><a href="#3-10-4-对抗缓冲区溢出攻击" class="headerlink" title="3.10.4 对抗缓冲区溢出攻击"></a>3.10.4 对抗缓冲区溢出攻击</h3><ul>
<li><p>栈随机化</p>
<p>依然可以使用 nop sled 空操作雪橇攻击</p>
</li>
</ul>
<h3 id="Practice-Problem-3-47"><a href="#Practice-Problem-3-47" class="headerlink" title="Practice Problem 3.47"></a>Practice Problem 3.47</h3><p>Running our stack-checking code 10,000 times on a system running Linux version 2.6.16, we obtained addresses ranging from a minimum of 0xffffb754 to a maximum of 0xffffd754.</p>
<p>A. What is the approximate range of addresses?</p>
<p>$2^{13}$</p>
<p>B. If we attempted a buffer overrun with a 128-byte nop sled, about how many attempts would it take to test all starting addresses?</p>
<p>$2^6=64$</p>
<ul>
<li><p>栈破坏检测</p>
<p>利用缓冲区溢出漏洞进行攻击的方法要改变栈上的内容，那么我们可以先在栈上存放一个值（金丝雀值 canary value），程序返回后再检查这个值是不是改变了，如果改变了，说明程序对栈上缓冲区以外的内存进行了更改，就可以马上终止程序。金丝雀值和栈上其他内容的排列方式如下图</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-19_01-43-41.png" class="">
</li>
</ul>
<h3 id="Practice-Problem-3-48"><a href="#Practice-Problem-3-48" class="headerlink" title="Practice Problem 3.48"></a>Practice Problem 3.48</h3><p>The functions <code>intlen</code>, <code>len</code>, and <code>iptoa</code> provide a very convoluted way to compute the number of decimal digits required to represent an integer. We will use this as a way to study some aspects of the gcc stack protector facility.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">len</span><span class="params">(<span class="keyword">char</span> *s)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">strlen</span>(s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">iptoa</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">long</span> *p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> val = *p;</span><br><span class="line">    <span class="built_in">sprintf</span>(s, <span class="string">&quot;%ld&quot;</span>, val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">intlen</span><span class="params">(<span class="keyword">long</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> v;</span><br><span class="line">    <span class="keyword">char</span> buf[<span class="number">12</span>];</span><br><span class="line">    v = x;</span><br><span class="line">    iptoa(buf, &amp;v);</span><br><span class="line">    <span class="keyword">return</span> len(buf);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The following show portions of the code for <code>intlen</code>, compiled both <strong>with</strong> and <strong>without</strong> stack protector:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">;(a) Without protector</span><br><span class="line">;int intlen(long x)</span><br><span class="line">;x in %rdi</span><br><span class="line">intlen:</span><br><span class="line">    subq $40, %rsp</span><br><span class="line">    movq %rdi, 24(%rsp)</span><br><span class="line">    leaq 24(%rsp), %rsi</span><br><span class="line">    movq %rsp, %rdi</span><br><span class="line">    call iptoa</span><br><span class="line">    </span><br><span class="line">;(b) With protector</span><br><span class="line">;int intlen(long x)</span><br><span class="line">;x in %rdi</span><br><span class="line">intlen:</span><br><span class="line">    subq $56, %rsp</span><br><span class="line">    movq %fs:40, %rax</span><br><span class="line">    movq %rax, 40(%rsp)</span><br><span class="line">    xorl %eax, %eax</span><br><span class="line">    movq %rdi, 8(%rsp)</span><br><span class="line">    leaq 8(%rsp), %rsi</span><br><span class="line">    leaq 16(%rsp), %rdi</span><br><span class="line">    call iptoa</span><br></pre></td></tr></table></figure>
<p>A. For both versions: What are the positions in the stack frame for <code>buf</code>, <code>v</code>, and (when present) the canary value?</p>
<p>(a) buf :(%rsp) ,v:24(%rsp)</p>
<p>(b) buf :16(%rsp) ,v: 8(%rsp) , canary value: 40(%rsp)</p>
<ul>
<li>限制可执行代码区域</li>
</ul>
<h3 id="3-10-5-支持变长栈帧"><a href="#3-10-5-支持变长栈帧" class="headerlink" title="3.10.5 支持变长栈帧"></a>3.10.5 支持变长栈帧</h3><p>有一些函数需要使用变长数组，因此编译器不能提前计算出该函数需要的栈帧的大小</p>
<p>看下面这个函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">vframe</span><span class="params">(<span class="keyword">long</span> n, <span class="keyword">long</span> idx, <span class="keyword">long</span> *q)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> i;</span><br><span class="line">    <span class="keyword">long</span> *p[n];</span><br><span class="line">    p[<span class="number">0</span>] = &amp;i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">    	p[i] = q;</span><br><span class="line">    <span class="keyword">return</span> *p[idx];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在这个函数内部声明了一个长为 <code>n</code> 的 <code>long *</code> 数组，这需要 $8*n$ 个字节长度的栈内存</p>
<p>函数内部对 <code>i</code> 进行了取地址的操作，所以 <code>i</code> 也需要放在栈上</p>
<p>一起看看这个函数对应的汇编代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">;long vframe(long n, long idx, long *q)</span><br><span class="line">;n in %rdi, idx in %rsi, q in %rdx</span><br><span class="line">;Only portions of code shown</span><br><span class="line">vframe:</span><br><span class="line">    pushq %rbp 				;Save old %rbp</span><br><span class="line">    movq %rsp, %rbp 		;Set frame pointer</span><br><span class="line">    subq $16, %rsp 			;Allocate space for i (%rsp = s1)</span><br><span class="line">    leaq 22(,%rdi,8), %rax</span><br><span class="line">    andq $-16, %rax</span><br><span class="line">    subq %rax, %rsp 		;Allocate space for array p (%rsp = s2)</span><br><span class="line">    leaq 7(%rsp), %rax</span><br><span class="line">    shrq $3, %rax</span><br><span class="line">    leaq 0(,%rax,8), %r8 	;Set %r8 to &amp;p[0]</span><br><span class="line">    movq %r8, %rcx 			;Set %rcx to &amp;p[0] (%rcx = p)</span><br><span class="line">	. . .</span><br><span class="line">;Code for initialization loop</span><br><span class="line">;i in %rax and on stack, n in %rdi, p in %rcx, q in %rdx</span><br><span class="line">.L3: loop:</span><br><span class="line">    movq %rdx, (%rcx,%rax,8) Set p[i] to q</span><br><span class="line">    addq $1, %rax Increment i</span><br><span class="line">    movq %rax, -8(%rbp) Store on stack</span><br><span class="line">.L2:</span><br><span class="line">    movq -8(%rbp), %rax Retrieve i from stack</span><br><span class="line">    cmpq %rdi, %rax Compare i:n</span><br><span class="line">    jl .L3 If &lt;, goto loop</span><br><span class="line">	. . .</span><br><span class="line">;Code for function exit</span><br><span class="line">    leave 				;Restore %rbp and %rsp</span><br><span class="line">    ret 				;Return</span><br></pre></td></tr></table></figure>
<h2 id="3-11-浮点代码"><a href="#3-11-浮点代码" class="headerlink" title="3.11 浮点代码"></a>3.11 浮点代码</h2><p>为了处理浮点数，intel 和 AMD 都专门增加了一些指令和寄存器，这些寄存器称为媒体寄存器（media registers）</p>
<img src="/2021/11/20/CSAPP-Ch3/323.png" class="Randal E. Bryant, David R. O’Htive [3rd ed.] (2016, Pearson)">
<h3 id="3-11-1-浮点传送和转换操作"><a href="#3-11-1-浮点传送和转换操作" class="headerlink" title="3.11.1 浮点传送和转换操作"></a>3.11.1 浮点传送和转换操作</h3><p>浮点数移动指令：</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-19_14-09-17.png" class="">
<p>双操作数浮点转换指令：</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-19_14-16-55.png" class="">
<p>三操作数浮点转换指令：</p>
<img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-19_14-23-35.png" class="">
<p>C函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">fcvt</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">float</span> *fp, <span class="keyword">double</span> *dp, <span class="keyword">long</span> *lp)</span></span>&#123;</span><br><span class="line">    <span class="keyword">float</span> f = *fp; <span class="keyword">double</span> d = *dp; <span class="keyword">long</span> l = *lp;</span><br><span class="line">    *lp = (<span class="keyword">long</span>) d;</span><br><span class="line">    *fp = (<span class="keyword">float</span>) i;</span><br><span class="line">    *dp = (<span class="keyword">double</span>) l;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">double</span>) f;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对应的汇编代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">;double fcvt(int i, float *fp, double *dp, long *lp)</span><br><span class="line">;i in %edi, fp in %rsi, dp in %rdx, lp in %rcx</span><br><span class="line">fcvt:</span><br><span class="line">    vmovss (%rsi), %xmm0 					;Get f = *fp</span><br><span class="line">    movq (%rcx), %rax 						;Get l = *lp</span><br><span class="line">    vcvttsd2siq (%rdx), %r8 				;Get d = *dp and convert to long</span><br><span class="line">    movq %r8, (%rcx) 						;Store at lp</span><br><span class="line">    vcvtsi2ss %edi, %xmm1, %xmm1 			;Convert i to float</span><br><span class="line">    vmovss %xmm1, (%rsi) 					;Store at fp</span><br><span class="line">    vcvtsi2sdq %rax, %xmm1, %xmm1 			;Convert l to double</span><br><span class="line">    vmovsd %xmm1, (%rdx) 					;Store at dp</span><br><span class="line">    ;The following two instructions convert f to double</span><br><span class="line">    vunpcklps %xmm0, %xmm0, %xmm0</span><br><span class="line">    vcvtps2pd %xmm0, %xmm0</span><br><span class="line">    ret 									;Return f</span><br></pre></td></tr></table></figure>
<h3 id="Practice-Problem-3-50"><a href="#Practice-Problem-3-50" class="headerlink" title="Practice Problem 3.50"></a>Practice Problem 3.50</h3><p>For the following C code, the expressions <code>val1</code>–<code>val4</code> all map to the program values <code>i</code>, <code>f</code>, <code>d</code>, and <code>l</code>:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">fcvt2</span><span class="params">(<span class="keyword">int</span> *ip, <span class="keyword">float</span> *fp, <span class="keyword">double</span> *dp, <span class="keyword">long</span> l)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = *ip; <span class="keyword">float</span> f = *fp; <span class="keyword">double</span> d = *dp;</span><br><span class="line">    *ip = (<span class="keyword">int</span>) val1;</span><br><span class="line">    *fp = (<span class="keyword">float</span>) val2;</span><br><span class="line">    *dp = (<span class="keyword">double</span>) val3;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">double</span>) val4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Determine the mapping, based on the following x86-64 code for the function:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">;double fcvt2(int *ip, float *fp, double *dp, long l)</span><br><span class="line">;ip in %rdi, fp in %rsi, dp in %rdx, l in %rcx</span><br><span class="line">;Result returned in %xmm0</span><br><span class="line">fcvt2:</span><br><span class="line">    movl (%rdi), %eax				;i=*ip</span><br><span class="line">    vmovss (%rsi), %xmm0			;f=*fp</span><br><span class="line">    vcvttsd2si (%rdx), %r8d			;d=*dp</span><br><span class="line">    movl %r8d, (%rdi)				;*ip=(int)d</span><br><span class="line">    vcvtsi2ss %eax, %xmm1, %xmm1	;</span><br><span class="line">    vmovss %xmm1, (%rsi)			;*fp=(float)i</span><br><span class="line">    vcvtsi2sdq %rcx, %xmm1, %xmm1	;</span><br><span class="line">    vmovsd %xmm1, (%rdx)			;*dp=(double)l</span><br><span class="line">    vunpcklps %xmm0, %xmm0, %xmm0	;</span><br><span class="line">    vcvtps2pd %xmm0, %xmm0			;f=(double)f</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<p>val1-&gt;d</p>
<p>val2-&gt;i</p>
<p>val3-&gt;l</p>
<p>val4-&gt;f</p>
<h3 id="Practice-Problem-3-51"><a href="#Practice-Problem-3-51" class="headerlink" title="Practice Problem 3.51"></a>Practice Problem 3.51</h3><p>The following C function converts an argument of type <code>src_t</code> to a return value of type <code>dst_t</code>, where these two types are defined using <code>typedef</code>:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">dest_t</span> <span class="title">cvt</span><span class="params">(<span class="keyword">src_t</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">dest_t</span> y = (<span class="keyword">dest_t</span>) x;</span><br><span class="line">    <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>For execution on x86-64, assume that argument <code>x</code> is either in <code>%xmm0</code> or in the appropriately named portion of register <code>%rdi</code> (i.e., %rdi or %edi). One or two instructions are to be used to perform the type conversion and to copy the value to the appropriately named portion of register <code>%rax</code> (integer result) or <code>%xmm0</code> (floating-point result). Show the instruction(s), including the source and destination registers.</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">$T_x$</th>
<th style="text-align:center">$T_y$</th>
<th style="text-align:center">Instruction(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">long</td>
<td style="text-align:center">double</td>
<td style="text-align:center">vcvtsi2sdq %rdi, %xmm0,%xmm0</td>
</tr>
<tr>
<td style="text-align:center">double</td>
<td style="text-align:center">int</td>
<td style="text-align:center">vcvttsd2si %xmm0,%eax</td>
</tr>
<tr>
<td style="text-align:center">double</td>
<td style="text-align:center">float</td>
<td style="text-align:center">vmovddup %xmm0,%xmm0<br />vcvtpd2psx %xmm0,%xmm0</td>
</tr>
<tr>
<td style="text-align:center">long</td>
<td style="text-align:center">float</td>
<td style="text-align:center">vcvtsi2ssq %rdi,%xmm0,%xmm0</td>
</tr>
<tr>
<td style="text-align:center">float</td>
<td style="text-align:center">long</td>
<td style="text-align:center">vcvttss2siq %xmm0,%rax</td>
</tr>
</tbody>
</table>
</div>
<h3 id="3-11-2-过程（函数）中的浮点代码"><a href="#3-11-2-过程（函数）中的浮点代码" class="headerlink" title="3.11.2 过程（函数）中的浮点代码"></a>3.11.2 过程（函数）中的浮点代码</h3><p>x86-64中使用XMM寄存器向函数传递浮点参数，以及从函数返回浮点值</p>
<img src="/2021/11/20/CSAPP-Ch3/323.png" class="">
<p> 从上图中看到，</p>
<ul>
<li>可以使用 xmm0 ~ xmm7 传递8个浮点参数（超过8个的浮点参数使用栈传递）</li>
<li>xmm0 返回浮点值</li>
<li>所有 XMM 寄存器都是<strong>调用者</strong>保存</li>
</ul>
<h3 id="3-11-3-浮点运算操作"><a href="#3-11-3-浮点运算操作" class="headerlink" title="3.11.3 浮点运算操作"></a>3.11.3 浮点运算操作</h3><img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-19_15-10-27.png" class="">
<p>这些指令需要一个或两个操作数，第一个操作数可以是一个 XMM 寄存器或者内存位置，第二个操作数和目的操作数都<strong>必须是</strong> XMM 寄存器。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">funct</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">float</span> x, <span class="keyword">double</span> b, <span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a*x - b/i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对应的汇编代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">;double funct(double a, float x, double b, int i)</span><br><span class="line">;a in %xmm0, x in %xmm1, b in %xmm2, i in %edi</span><br><span class="line">funct:</span><br><span class="line">    ;The following two instructions convert x to double</span><br><span class="line">    vunpcklps %xmm1, %xmm1, %xmm1</span><br><span class="line">    vcvtps2pd %xmm1, %xmm1</span><br><span class="line">    vmulsd %xmm0, %xmm1, %xmm0 		;Multiply a by x</span><br><span class="line">    vcvtsi2sd %edi, %xmm1, %xmm1 	;Convert i to double</span><br><span class="line">    vdivsd %xmm1, %xmm2, %xmm2 		;Compute b/i</span><br><span class="line">    vsubsd %xmm2, %xmm0, %xmm0 		;Subtract from a*x</span><br><span class="line">    ret 							;Return</span><br></pre></td></tr></table></figure>
<h3 id="Practice-Problem-3-54"><a href="#Practice-Problem-3-54" class="headerlink" title="Practice Problem 3.54"></a>Practice Problem 3.54</h3><p>Function <code>funct2</code> has the following prototype:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">funct2</span><span class="params">(<span class="keyword">double</span> w, <span class="keyword">int</span> x, <span class="keyword">float</span> y, <span class="keyword">long</span> z)</span></span>;</span><br></pre></td></tr></table></figure>
<p>Gcc generates the following code for the function:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">;double funct2(double w, int x, float y, long z)</span><br><span class="line">;w in %xmm0, x in %edi, y in %xmm1, z in %rsi</span><br><span class="line">funct2:</span><br><span class="line">    vcvtsi2ss %edi, %xmm2, %xmm2		;</span><br><span class="line">    vmulss %xmm1, %xmm2, %xmm1			;y *= x</span><br><span class="line">    vunpcklps %xmm1, %xmm1, %xmm1		;</span><br><span class="line">    vcvtps2pd %xmm1, %xmm2				;%xmm2 = (double)y</span><br><span class="line">    vcvtsi2sdq %rsi, %xmm1, %xmm1		;y = (double)z</span><br><span class="line">    vdivsd %xmm1, %xmm0, %xmm0			;w=w/z;</span><br><span class="line">    vsubsd %xmm0, %xmm2, %xmm0			;w=y-w/z</span><br><span class="line">    ret</span><br></pre></td></tr></table></figure>
<p>Write a C version of <code>funct2</code>.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">funct2</span><span class="params">(<span class="keyword">double</span> w, <span class="keyword">int</span> x, <span class="keyword">float</span> y, <span class="keyword">long</span> z)</span></span>&#123;</span><br><span class="line">    y *= x;</span><br><span class="line">    <span class="keyword">return</span> y-w/z;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-11-4-定义和使用浮点常数"><a href="#3-11-4-定义和使用浮点常数" class="headerlink" title="3.11.4 定义和使用浮点常数"></a>3.11.4 定义和使用浮点常数</h3><p>和整数操作不同的是，AVX浮点操作<strong>不能</strong>以<strong>立即数</strong>作为操作数，所以编译器必须为所有的浮点常数分配并初始化内存。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cel2fahr</span><span class="params">(<span class="keyword">double</span> temp)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1.8</span> * temp + <span class="number">32.0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">;double cel2fahr(double temp)</span><br><span class="line">;temp in %xmm0</span><br><span class="line">cel2fahr:</span><br><span class="line">    vmulsd .LC2(%rip), %xmm0, %xmm0 	;Multiply by 1.8</span><br><span class="line">    vaddsd .LC3(%rip), %xmm0, %xmm0 	;Add 32.0</span><br><span class="line">	ret</span><br><span class="line">.LC2:</span><br><span class="line">    .long 3435973837 					;Low-order 4 bytes of 1.8</span><br><span class="line">    .long 1073532108 					;High-order 4 bytes of 1.8</span><br><span class="line">.LC3:</span><br><span class="line">    .long 0 							;Low-order 4 bytes of 32.0</span><br><span class="line">    .long 1077936128 					;High-order 4 bytes of 32.0</span><br></pre></td></tr></table></figure>
<p>1.8 的表示：</p>
<p>高4字节 1073532108 (0x3ffccccc)</p>
<p>指数部分 </p>
<p>$e=0x3ff = 1023$  </p>
<p>$bias=2^{k-1}-1=2^{10}-1=1023$</p>
<p>$E=e-bias=0$</p>
<p>低4字节 3435973837 (0xcccccccd)</p>
<p> 将高4字节剩下的部分和低4字节组合起来 0xccccccccccccd，二进制小数为$f=0.8$</p>
<p>所以最后的浮点值为 $(1+0.8)*2^{0}=1.8$</p>
<h3 id="Practice-Problem-3-55"><a href="#Practice-Problem-3-55" class="headerlink" title="Practice Problem 3.55"></a>Practice Problem 3.55</h3><p>Show how the numbers declared at label <code>.LC3</code> encode the number 32.0.</p>
<p>低4字节 0</p>
<p>高4字节 1077936128 (0x4040 0000) </p>
<p>$e=0x404=1028$</p>
<p>$E=e-1023=5$</p>
<p>小数部分为0</p>
<p>所以最后的浮点值为 $(1+0.0)*2^5=32.0$</p>
<h3 id="3-11-5-在浮点代码中使用位级操作"><a href="#3-11-5-在浮点代码中使用位级操作" class="headerlink" title="3.11.5 在浮点代码中使用位级操作"></a>3.11.5 在浮点代码中使用位级操作</h3><img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-20_00-33-32.png" class="">
<h3 id="3-11-6-浮点比较操作"><a href="#3-11-6-浮点比较操作" class="headerlink" title="3.11.6 浮点比较操作"></a>3.11.6 浮点比较操作</h3><img src="/2021/11/20/CSAPP-Ch3/Snipaste_2021-11-20_00-34-45.png" class="">

      

      
    </div>
    <div class="article-info article-info-index">
      
      
      <!--显示阅读次数-->
      
        <a class="cloud-tie-join-count" href="/2021/11/20/CSAPP-Ch3/" style="color:gray;font-size:14px;">
          <span class="icon-smile"></span>
          <span id="busuanzi_container_page_pv">
            阅读量(<span id="busuanzi_value_page_pv"></span>)
          </span>
        </a>
        
      
      
	<div class="article-category tagcloud">
		<i class="icon-book icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="/categories/notes//" class="article-tag-list-link color1">notes</a>
        		</li>
      		
		</ul>
	</div>


      

      
        
<div class="share-btn share-icons tooltip-left">
  <div class="tooltip tooltip-east">
    <span class="tooltip-item">
      <a href="javascript:;" class="share-sns share-outer">
        <i class="icon icon-share"></i>
      </a>
    </span>
    <span class="tooltip-content">
      <div class="share-wrap">
        <div class="share-icons">
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="icon icon-weibo"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="icon icon-weixin"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="icon icon-qq"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="icon icon-douban"></i>
          </a>
          <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a>
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="icon icon-facebook"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="icon icon-twitter"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="icon icon-google"></i>
          </a>
        </div>
      </div>
    </span>
  </div>
</div>

<div class="page-modal wx-share js-wx-box">
    <a class="close js-modal-close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//pan.baidu.com/share/qrcode?url=http://example.com/2021/11/20/CSAPP-Ch3/" alt="微信分享二维码">
    </div>
</div>

<div class="mask js-mask"></div>
      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
    <a href="/2021/11/24/CSAPP-Ch4/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          深入理解计算机系统 第四章 处理器架构
        
      </div>
    </a>
  
  
    <a href="/2021/09/25/asm-ch15-ch16/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">汇编语言 第十五、十六章 完结撒花</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>


<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
        <div class="toc-container tooltip-left">
            <i class="icon-font icon-category"></i>
            <div class="tooltip tooltip-east">
                <span class="tooltip-item">
                </span>
                <span class="tooltip-content">
                    <div class="toc-article">
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E7%AB%A0-%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9C%BA%E5%99%A8%E7%BA%A7%E8%A1%A8%E7%A4%BA"><span class="toc-number">1.</span> <span class="toc-text">第三章 程序的机器级表示</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E4%BB%8E%E5%8E%86%E5%8F%B2%E8%A7%92%E5%BA%A6%E7%9C%8B"><span class="toc-number">1.1.</span> <span class="toc-text">3.1 从历史角度看</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E7%A8%8B%E5%BA%8F%E7%9A%84%E7%BC%96%E7%A0%81"><span class="toc-number">1.2.</span> <span class="toc-text">3.2 程序的编码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-1-%E6%9C%BA%E5%99%A8%E7%BA%A7%E4%BB%A3%E7%A0%81"><span class="toc-number">1.2.1.</span> <span class="toc-text">3.2.1 机器级代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-2-%E4%B8%80%E4%B8%AA%E4%BB%A3%E7%A0%81%E4%BE%8B%E5%AD%90"><span class="toc-number">1.2.2.</span> <span class="toc-text">3.2.2 一个代码例子</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.3.</span> <span class="toc-text">3.3 数据格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-4-%E8%AE%BF%E9%97%AE%E4%BF%A1%E6%81%AF"><span class="toc-number">1.4.</span> <span class="toc-text">3.4 访问信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-1-%E6%93%8D%E4%BD%9C%E6%95%B0%E6%8C%87%E5%AE%9A%E7%AC%A6-operand-specifiers"><span class="toc-number">1.4.1.</span> <span class="toc-text">3.4.1 操作数指定符 operand specifiers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-1"><span class="toc-number">1.4.2.</span> <span class="toc-text">Practice Problem 3.1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-2-%E7%A7%BB%E5%8A%A8%E6%95%B0%E6%8D%AE%E7%9A%84%E6%8C%87%E4%BB%A4"><span class="toc-number">1.4.3.</span> <span class="toc-text">3.4.2 移动数据的指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-2"><span class="toc-number">1.4.4.</span> <span class="toc-text">Practice Problem 3.2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-3"><span class="toc-number">1.4.5.</span> <span class="toc-text">Practice Problem 3.3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-3-%E7%A7%BB%E5%8A%A8%E6%95%B0%E6%8D%AE%E4%B8%BE%E4%BE%8B"><span class="toc-number">1.4.6.</span> <span class="toc-text">3.4.3 移动数据举例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-4"><span class="toc-number">1.4.7.</span> <span class="toc-text">Practice Problem 3.4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-5"><span class="toc-number">1.4.8.</span> <span class="toc-text">Practice Problem 3.5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-4-%E6%95%B0%E6%8D%AE%E7%9A%84%E8%BF%9B%E6%A0%88%E5%92%8C%E5%87%BA%E6%A0%88-pushing-and-popping"><span class="toc-number">1.4.9.</span> <span class="toc-text">3.4.4 数据的进栈和出栈 pushing and popping</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-5-%E7%AE%97%E6%9C%AF%E5%92%8C%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97"><span class="toc-number">1.5.</span> <span class="toc-text">3.5 算术和逻辑运算</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-1-%E5%8A%A0%E8%BD%BD%E6%9C%89%E6%95%88%E5%9C%B0%E5%9D%80"><span class="toc-number">1.5.1.</span> <span class="toc-text">3.5.1 加载有效地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-6"><span class="toc-number">1.5.2.</span> <span class="toc-text">Practice Problem 3.6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-7"><span class="toc-number">1.5.3.</span> <span class="toc-text">Practice Problem 3.7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-2-%E4%B8%80%E5%85%83%E5%92%8C%E4%BA%8C%E5%85%83%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.4.</span> <span class="toc-text">3.5.2 一元和二元操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-8"><span class="toc-number">1.5.5.</span> <span class="toc-text">Practice Problem 3.8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-3-%E7%A7%BB%E4%BD%8D%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.6.</span> <span class="toc-text">3.5.3 移位操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-9"><span class="toc-number">1.5.7.</span> <span class="toc-text">Practice Problem 3.9</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-10"><span class="toc-number">1.5.8.</span> <span class="toc-text">Practice Problem 3.10</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-11"><span class="toc-number">1.5.9.</span> <span class="toc-text">Practice Problem 3.11</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-5-%E7%89%B9%E6%AE%8A%E7%AE%97%E6%9C%AF%E6%93%8D%E4%BD%9C"><span class="toc-number">1.5.10.</span> <span class="toc-text">3.5.5 特殊算术操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-6-%E6%8E%A7%E5%88%B6"><span class="toc-number">1.6.</span> <span class="toc-text">3.6 控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-1-%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8-Condition-Codes"><span class="toc-number">1.6.1.</span> <span class="toc-text">3.6.1 标志寄存器 Condition Codes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-2-%E8%8E%B7%E5%8F%96%E6%A0%87%E5%BF%97%E7%9A%84%E5%80%BC-Accessing-the-Condition-Codes"><span class="toc-number">1.6.2.</span> <span class="toc-text">3.6.2 获取标志的值 Accessing the Condition Codes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-13"><span class="toc-number">1.6.3.</span> <span class="toc-text">Practice Problem 3.13</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-14"><span class="toc-number">1.6.4.</span> <span class="toc-text">Practice Problem 3.14</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-3-Jump-%E6%8C%87%E4%BB%A4"><span class="toc-number">1.6.5.</span> <span class="toc-text">3.6.3 Jump 指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-4-Jump-%E6%8C%87%E4%BB%A4%E7%9A%84%E7%BC%96%E7%A0%81"><span class="toc-number">1.6.6.</span> <span class="toc-text">3.6.4 Jump 指令的编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-15"><span class="toc-number">1.6.7.</span> <span class="toc-text">Practice Problem 3.15</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-5-%E4%BD%BF%E7%94%A8%E6%9D%A1%E4%BB%B6%E6%8E%A7%E5%88%B6%E6%8C%87%E4%BB%A4%E5%AE%9E%E7%8E%B0%E6%9D%A1%E4%BB%B6%E5%88%86%E6%94%AF"><span class="toc-number">1.6.8.</span> <span class="toc-text">3.6.5 使用条件控制指令实现条件分支</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-16"><span class="toc-number">1.6.9.</span> <span class="toc-text">Practice Problem 3.16</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-17"><span class="toc-number">1.6.10.</span> <span class="toc-text">Practice Problem 3.17</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-18"><span class="toc-number">1.6.11.</span> <span class="toc-text">Practice Problem 3.18</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-6-%E4%BD%BF%E7%94%A8%E6%9D%A1%E4%BB%B6%E7%A7%BB%E5%8A%A8%EF%BC%88Conditional-Moves%EF%BC%89%E5%AE%9E%E7%8E%B0%E6%9D%A1%E4%BB%B6%E5%88%86%E6%94%AF%EF%BC%88Conditional-Branches%EF%BC%89"><span class="toc-number">1.6.12.</span> <span class="toc-text">3.6.6 使用条件移动（Conditional Moves）实现条件分支（Conditional Branches）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-19"><span class="toc-number">1.6.13.</span> <span class="toc-text">Practice Problem 3.19</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-20"><span class="toc-number">1.6.14.</span> <span class="toc-text">Practice Problem 3.20</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-21"><span class="toc-number">1.6.15.</span> <span class="toc-text">Practice Problem 3.21</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-7-%E5%BE%AA%E7%8E%AF"><span class="toc-number">1.6.16.</span> <span class="toc-text">3.6.7 循环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-23"><span class="toc-number">1.6.17.</span> <span class="toc-text">Practice Problem 3.23</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-24"><span class="toc-number">1.6.18.</span> <span class="toc-text">Practice Problem 3.24</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-25"><span class="toc-number">1.6.19.</span> <span class="toc-text">Practice Problem 3.25</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-26"><span class="toc-number">1.6.20.</span> <span class="toc-text">Practice Problem 3.26</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-27"><span class="toc-number">1.6.21.</span> <span class="toc-text">Practice Problem 3.27</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-28"><span class="toc-number">1.6.22.</span> <span class="toc-text">Practice Problem 3.28</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-8-switch-%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.6.23.</span> <span class="toc-text">3.6.8 switch 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-30"><span class="toc-number">1.6.24.</span> <span class="toc-text">Practice Problem 3.30</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-31"><span class="toc-number">1.6.25.</span> <span class="toc-text">Practice Problem 3.31</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-7-%E8%BF%87%E7%A8%8B-procedures"><span class="toc-number">1.7.</span> <span class="toc-text">3.7 过程 procedures</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7-1-%E8%BF%90%E8%A1%8C%E6%97%B6%E6%A0%88-run-time-stack"><span class="toc-number">1.7.1.</span> <span class="toc-text">3.7.1 运行时栈 run-time stack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7-2-%E6%8E%A7%E5%88%B6%E6%9D%83%E7%9A%84%E8%BD%AC%E7%A7%BB"><span class="toc-number">1.7.2.</span> <span class="toc-text">3.7.2 控制权的转移</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-32"><span class="toc-number">1.7.3.</span> <span class="toc-text">Practice Problem 3.32</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7-3-%E6%95%B0%E6%8D%AE%EF%BC%88%E5%8F%82%E6%95%B0%EF%BC%89%E4%BC%A0%E9%80%92"><span class="toc-number">1.7.4.</span> <span class="toc-text">3.7.3 数据（参数）传递</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-33"><span class="toc-number">1.7.5.</span> <span class="toc-text">Practice Problem 3.33</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7-4-%E6%A0%88%E4%B8%8A%E7%9A%84%E5%B1%80%E9%83%A8%E5%AD%98%E5%82%A8"><span class="toc-number">1.7.6.</span> <span class="toc-text">3.7.4 栈上的局部存储</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7-5-%E5%AF%84%E5%AD%98%E5%99%A8%E4%B8%AD%E7%9A%84%E5%B1%80%E9%83%A8%E5%AD%98%E5%82%A8%E7%A9%BA%E9%97%B4"><span class="toc-number">1.7.7.</span> <span class="toc-text">3.7.5 寄存器中的局部存储空间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7-6-%E9%80%92%E5%BD%92%E8%BF%87%E7%A8%8B"><span class="toc-number">1.7.8.</span> <span class="toc-text">3.7.6 递归过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-35"><span class="toc-number">1.7.9.</span> <span class="toc-text">Practice Problem 3.35</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-8-%E6%95%B0%E7%BB%84%E5%88%86%E9%85%8D%E5%92%8C%E8%AE%BF%E9%97%AE"><span class="toc-number">1.8.</span> <span class="toc-text">3.8 数组分配和访问</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-8-1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99"><span class="toc-number">1.8.1.</span> <span class="toc-text">3.8.1 基本原则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-36"><span class="toc-number">1.8.2.</span> <span class="toc-text">Practice Problem 3.36</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-8-2-%E6%8C%87%E9%92%88%E8%BF%90%E7%AE%97"><span class="toc-number">1.8.3.</span> <span class="toc-text">3.8.2 指针运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-37"><span class="toc-number">1.8.4.</span> <span class="toc-text">Practice Problem 3.37</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-8-3-%E5%B5%8C%E5%A5%97%E7%9A%84%E6%95%B0%E7%BB%84"><span class="toc-number">1.8.5.</span> <span class="toc-text">3.8.3 嵌套的数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-38"><span class="toc-number">1.8.6.</span> <span class="toc-text">Practice Problem 3.38</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-8-4-%E5%AE%9A%E9%95%BF%E6%95%B0%E7%BB%84"><span class="toc-number">1.8.7.</span> <span class="toc-text">3.8.4 定长数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-40"><span class="toc-number">1.8.8.</span> <span class="toc-text">Practice Problem 3.40</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-9-%E5%BC%82%E8%B4%A8%EF%BC%88Heterogeneous%EF%BC%89%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">1.9.</span> <span class="toc-text">3.9 异质（Heterogeneous）的数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-9-1-%E7%BB%93%E6%9E%84-strcut"><span class="toc-number">1.9.1.</span> <span class="toc-text">3.9.1 结构 strcut</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-41"><span class="toc-number">1.9.2.</span> <span class="toc-text">Practice Problem 3.41</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-9-2-unions"><span class="toc-number">1.9.3.</span> <span class="toc-text">3.9.2 unions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-43"><span class="toc-number">1.9.4.</span> <span class="toc-text">Practice Problem 3.43</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-9-3-%E6%95%B0%E6%8D%AE%E5%AF%B9%E9%BD%90"><span class="toc-number">1.9.5.</span> <span class="toc-text">3.9.3 数据对齐</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-44"><span class="toc-number">1.9.6.</span> <span class="toc-text">Practice Problem 3.44</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-10-%E5%9C%A8%E6%9C%BA%E5%99%A8%E7%BA%A7%E7%A8%8B%E5%BA%8F%E4%B8%AD%E5%B0%86%E6%8E%A7%E5%88%B6%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E5%90%88%E8%B5%B7%E6%9D%A5"><span class="toc-number">1.10.</span> <span class="toc-text">3.10 在机器级程序中将控制与数据结合起来</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-10-1-%E7%90%86%E8%A7%A3%E6%8C%87%E9%92%88"><span class="toc-number">1.10.1.</span> <span class="toc-text">3.10.1 理解指针</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-10-2-%E4%BD%BF%E7%94%A8GDB%E8%B0%83%E8%AF%95%E5%99%A8"><span class="toc-number">1.10.2.</span> <span class="toc-text">3.10.2 使用GDB调试器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-10-3-%E5%86%85%E5%AD%98%E8%B6%8A%E7%95%8C%E5%BC%95%E7%94%A8%E5%92%8C%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA"><span class="toc-number">1.10.3.</span> <span class="toc-text">3.10.3 内存越界引用和缓冲区溢出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-46"><span class="toc-number">1.10.4.</span> <span class="toc-text">Practice Problem 3.46</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-10-4-%E5%AF%B9%E6%8A%97%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%94%BB%E5%87%BB"><span class="toc-number">1.10.5.</span> <span class="toc-text">3.10.4 对抗缓冲区溢出攻击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-47"><span class="toc-number">1.10.6.</span> <span class="toc-text">Practice Problem 3.47</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-48"><span class="toc-number">1.10.7.</span> <span class="toc-text">Practice Problem 3.48</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-10-5-%E6%94%AF%E6%8C%81%E5%8F%98%E9%95%BF%E6%A0%88%E5%B8%A7"><span class="toc-number">1.10.8.</span> <span class="toc-text">3.10.5 支持变长栈帧</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-11-%E6%B5%AE%E7%82%B9%E4%BB%A3%E7%A0%81"><span class="toc-number">1.11.</span> <span class="toc-text">3.11 浮点代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-11-1-%E6%B5%AE%E7%82%B9%E4%BC%A0%E9%80%81%E5%92%8C%E8%BD%AC%E6%8D%A2%E6%93%8D%E4%BD%9C"><span class="toc-number">1.11.1.</span> <span class="toc-text">3.11.1 浮点传送和转换操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-50"><span class="toc-number">1.11.2.</span> <span class="toc-text">Practice Problem 3.50</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-51"><span class="toc-number">1.11.3.</span> <span class="toc-text">Practice Problem 3.51</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-11-2-%E8%BF%87%E7%A8%8B%EF%BC%88%E5%87%BD%E6%95%B0%EF%BC%89%E4%B8%AD%E7%9A%84%E6%B5%AE%E7%82%B9%E4%BB%A3%E7%A0%81"><span class="toc-number">1.11.4.</span> <span class="toc-text">3.11.2 过程（函数）中的浮点代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-11-3-%E6%B5%AE%E7%82%B9%E8%BF%90%E7%AE%97%E6%93%8D%E4%BD%9C"><span class="toc-number">1.11.5.</span> <span class="toc-text">3.11.3 浮点运算操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-54"><span class="toc-number">1.11.6.</span> <span class="toc-text">Practice Problem 3.54</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-11-4-%E5%AE%9A%E4%B9%89%E5%92%8C%E4%BD%BF%E7%94%A8%E6%B5%AE%E7%82%B9%E5%B8%B8%E6%95%B0"><span class="toc-number">1.11.7.</span> <span class="toc-text">3.11.4 定义和使用浮点常数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Practice-Problem-3-55"><span class="toc-number">1.11.8.</span> <span class="toc-text">Practice Problem 3.55</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-11-5-%E5%9C%A8%E6%B5%AE%E7%82%B9%E4%BB%A3%E7%A0%81%E4%B8%AD%E4%BD%BF%E7%94%A8%E4%BD%8D%E7%BA%A7%E6%93%8D%E4%BD%9C"><span class="toc-number">1.11.9.</span> <span class="toc-text">3.11.5 在浮点代码中使用位级操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-11-6-%E6%B5%AE%E7%82%B9%E6%AF%94%E8%BE%83%E6%93%8D%E4%BD%9C"><span class="toc-number">1.11.10.</span> <span class="toc-text">3.11.6 浮点比较操作</span></a></li></ol></li></ol></li></ol>
                    </div>
                </span>
            </div>
        </div>
        
    </div>
</aside>



  
  
  

  

  

  


          </div>
        </div>
      </div>
      <footer id="footer">
	<div class="outer">
	  <div id="footer-info">
		<div class="footer-left">
		  &copy; 2022 Mario
		</div>
		<div class="footer-right">
		  <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
		</div>
	  </div>
	  <div calss="count-span">
		<span id="busuanzi_container_site_pv">
		  总访问量: <span id="busuanzi_value_site_pv"></span>
		</span>
  
		<span id="busuanzi_container_site_uv">
		  总访客: <span id="busuanzi_value_site_uv"></span>
		</span>
	  </div>
	</div>
  </footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: [object Object],
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		toc_hide_index: true,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(e){if(r[e])return r[e].exports;var i=r[e]={exports:{},id:e,loaded:!1};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var r={};n.m=t,n.c=r,n.p="./",n(0)}([function(t,n,r){r(195),t.exports=r(191)},function(t,n,r){var e=r(3),i=r(52),o=r(27),u=r(28),c=r(53),f="prototype",a=function(t,n,r){var s,l,h,v,p=t&a.F,d=t&a.G,y=t&a.S,g=t&a.P,b=t&a.B,m=d?e:y?e[n]||(e[n]={}):(e[n]||{})[f],x=d?i:i[n]||(i[n]={}),w=x[f]||(x[f]={});d&&(r=n);for(s in r)l=!p&&m&&void 0!==m[s],h=(l?m:r)[s],v=b&&l?c(h,e):g&&"function"==typeof h?c(Function.call,h):h,m&&u(m,s,h,t&a.U),x[s]!=h&&o(x,s,v),g&&w[s]!=h&&(w[s]=h)};e.core=i,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},function(t,n,r){var e=r(6);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,r){var e=r(126)("wks"),i=r(76),o=r(3).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n,r){var e=r(94),i=r(33);t.exports=function(t){return e(i(t))}},function(t,n,r){t.exports=!r(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(2),i=r(167),o=r(50),u=Object.defineProperty;n.f=r(10)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){t.exports=!r(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(14),i=r(22);t.exports=r(12)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(20),i=r(58),o=r(42),u=Object.defineProperty;n.f=r(12)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(40)("wks"),i=r(23),o=r(5).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n,r){var e=r(67),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){var e=r(46);t.exports=function(t){return Object(e(t))}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(63),i=r(34);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(21);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n,r){var e=r(11),i=r(66);t.exports=r(10)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(3),i=r(27),o=r(24),u=r(76)("src"),c="toString",f=Function[c],a=(""+f).split(c);r(52).inspectSource=function(t){return f.call(t)},(t.exports=function(t,n,r,c){var f="function"==typeof r;f&&(o(r,"name")||i(r,"name",n)),t[n]!==r&&(f&&(o(r,u)||i(r,u,t[n]?""+t[n]:a.join(String(n)))),t===e?t[n]=r:c?t[n]?t[n]=r:i(t,n,r):(delete t[n],i(t,n,r)))})(Function.prototype,c,function(){return"function"==typeof this&&this[u]||f.call(this)})},function(t,n,r){var e=r(1),i=r(4),o=r(46),u=function(t,n,r,e){var i=String(o(t)),u="<"+n;return""!==r&&(u+=" "+r+'="'+String(e).replace(/"/g,"&quot;")+'"'),u+">"+i+"</"+n+">"};t.exports=function(t,n){var r={};r[t]=n(u),e(e.P+e.F*i(function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}),"String",r)}},function(t,n,r){var e=r(115),i=r(46);t.exports=function(t){return e(i(t))}},function(t,n,r){var e=r(116),i=r(66),o=r(30),u=r(50),c=r(24),f=r(167),a=Object.getOwnPropertyDescriptor;n.f=r(10)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(24),i=r(17),o=r(145)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(14).f,i=r(8),o=r(15)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(40)("keys"),i=r(23);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(5),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n,r){var e=r(21);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(36),u=r(44),c=r(14).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){n.f=r(15)},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n,r){var e=r(4);t.exports=function(t,n){return!!t&&e(function(){n?t.call(null,function(){},1):t.call(null)})}},function(t,n,r){var e=r(53),i=r(115),o=r(17),u=r(16),c=r(203);t.exports=function(t,n){var r=1==t,f=2==t,a=3==t,s=4==t,l=6==t,h=5==t||l,v=n||c;return function(n,c,p){for(var d,y,g=o(n),b=i(g),m=e(c,p,3),x=u(b.length),w=0,S=r?v(n,x):f?v(n,0):void 0;x>w;w++)if((h||w in b)&&(d=b[w],y=m(d,w,g),t))if(r)S[w]=y;else if(y)switch(t){case 3:return!0;case 5:return d;case 6:return w;case 2:S.push(d)}else if(s)return!1;return l?-1:a||s?s:S}}},function(t,n,r){var e=r(1),i=r(52),o=r(4);t.exports=function(t,n){var r=(i.Object||{})[t]||Object[t],u={};u[t]=n(r),e(e.S+e.F*o(function(){r(1)}),"Object",u)}},function(t,n,r){var e=r(6);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(91),u=r(13),c="prototype",f=function(t,n,r){var a,s,l,h=t&f.F,v=t&f.G,p=t&f.S,d=t&f.P,y=t&f.B,g=t&f.W,b=v?i:i[n]||(i[n]={}),m=b[c],x=v?e:p?e[n]:(e[n]||{})[c];v&&(r=n);for(a in r)(s=!h&&x&&void 0!==x[a])&&a in b||(l=s?x[a]:r[a],b[a]=v&&"function"!=typeof x[a]?r[a]:y&&s?o(l,e):g&&x[a]==l?function(t){var n=function(n,r,e){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,r)}return new t(n,r,e)}return t.apply(this,arguments)};return n[c]=t[c],n}(l):d&&"function"==typeof l?o(Function.call,l):l,d&&((b.virtual||(b.virtual={}))[a]=l,t&f.R&&m&&!m[a]&&u(m,a,l)))};f.F=1,f.G=2,f.S=4,f.P=8,f.B=16,f.W=32,f.U=64,f.R=128,t.exports=f},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n,r){var e=r(26);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(183),i=r(1),o=r(126)("metadata"),u=o.store||(o.store=new(r(186))),c=function(t,n,r){var i=u.get(t);if(!i){if(!r)return;u.set(t,i=new e)}var o=i.get(n);if(!o){if(!r)return;i.set(n,o=new e)}return o},f=function(t,n,r){var e=c(n,r,!1);return void 0!==e&&e.has(t)},a=function(t,n,r){var e=c(n,r,!1);return void 0===e?void 0:e.get(t)},s=function(t,n,r,e){c(r,e,!0).set(t,n)},l=function(t,n){var r=c(t,n,!1),e=[];return r&&r.forEach(function(t,n){e.push(n)}),e},h=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},v=function(t){i(i.S,"Reflect",t)};t.exports={store:u,map:c,has:f,get:a,set:s,keys:l,key:h,exp:v}},function(t,n,r){"use strict";if(r(10)){var e=r(69),i=r(3),o=r(4),u=r(1),c=r(127),f=r(152),a=r(53),s=r(68),l=r(66),h=r(27),v=r(73),p=r(67),d=r(16),y=r(75),g=r(50),b=r(24),m=r(180),x=r(114),w=r(6),S=r(17),_=r(137),O=r(70),E=r(32),P=r(71).f,j=r(154),F=r(76),M=r(7),A=r(48),N=r(117),T=r(146),I=r(155),k=r(80),L=r(123),R=r(74),C=r(130),D=r(160),U=r(11),W=r(31),G=U.f,B=W.f,V=i.RangeError,z=i.TypeError,q=i.Uint8Array,K="ArrayBuffer",J="Shared"+K,Y="BYTES_PER_ELEMENT",H="prototype",$=Array[H],X=f.ArrayBuffer,Q=f.DataView,Z=A(0),tt=A(2),nt=A(3),rt=A(4),et=A(5),it=A(6),ot=N(!0),ut=N(!1),ct=I.values,ft=I.keys,at=I.entries,st=$.lastIndexOf,lt=$.reduce,ht=$.reduceRight,vt=$.join,pt=$.sort,dt=$.slice,yt=$.toString,gt=$.toLocaleString,bt=M("iterator"),mt=M("toStringTag"),xt=F("typed_constructor"),wt=F("def_constructor"),St=c.CONSTR,_t=c.TYPED,Ot=c.VIEW,Et="Wrong length!",Pt=A(1,function(t,n){return Tt(T(t,t[wt]),n)}),jt=o(function(){return 1===new q(new Uint16Array([1]).buffer)[0]}),Ft=!!q&&!!q[H].set&&o(function(){new q(1).set({})}),Mt=function(t,n){if(void 0===t)throw z(Et);var r=+t,e=d(t);if(n&&!m(r,e))throw V(Et);return e},At=function(t,n){var r=p(t);if(r<0||r%n)throw V("Wrong offset!");return r},Nt=function(t){if(w(t)&&_t in t)return t;throw z(t+" is not a typed array!")},Tt=function(t,n){if(!(w(t)&&xt in t))throw z("It is not a typed array constructor!");return new t(n)},It=function(t,n){return kt(T(t,t[wt]),n)},kt=function(t,n){for(var r=0,e=n.length,i=Tt(t,e);e>r;)i[r]=n[r++];return i},Lt=function(t,n,r){G(t,n,{get:function(){return this._d[r]}})},Rt=function(t){var n,r,e,i,o,u,c=S(t),f=arguments.length,s=f>1?arguments[1]:void 0,l=void 0!==s,h=j(c);if(void 0!=h&&!_(h)){for(u=h.call(c),e=[],n=0;!(o=u.next()).done;n++)e.push(o.value);c=e}for(l&&f>2&&(s=a(s,arguments[2],2)),n=0,r=d(c.length),i=Tt(this,r);r>n;n++)i[n]=l?s(c[n],n):c[n];return i},Ct=function(){for(var t=0,n=arguments.length,r=Tt(this,n);n>t;)r[t]=arguments[t++];return r},Dt=!!q&&o(function(){gt.call(new q(1))}),Ut=function(){return gt.apply(Dt?dt.call(Nt(this)):Nt(this),arguments)},Wt={copyWithin:function(t,n){return D.call(Nt(this),t,n,arguments.length>2?arguments[2]:void 0)},every:function(t){return rt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return C.apply(Nt(this),arguments)},filter:function(t){return It(this,tt(Nt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return et(Nt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(Nt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Z(Nt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return ut(Nt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(Nt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return vt.apply(Nt(this),arguments)},lastIndexOf:function(t){return st.apply(Nt(this),arguments)},map:function(t){return Pt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return lt.apply(Nt(this),arguments)},reduceRight:function(t){return ht.apply(Nt(this),arguments)},reverse:function(){for(var t,n=this,r=Nt(n).length,e=Math.floor(r/2),i=0;i<e;)t=n[i],n[i++]=n[--r],n[r]=t;return n},some:function(t){return nt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return pt.call(Nt(this),t)},subarray:function(t,n){var r=Nt(this),e=r.length,i=y(t,e);return new(T(r,r[wt]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,d((void 0===n?e:y(n,e))-i))}},Gt=function(t,n){return It(this,dt.call(Nt(this),t,n))},Bt=function(t){Nt(this);var n=At(arguments[1],1),r=this.length,e=S(t),i=d(e.length),o=0;if(i+n>r)throw V(Et);for(;o<i;)this[n+o]=e[o++]},Vt={entries:function(){return at.call(Nt(this))},keys:function(){return ft.call(Nt(this))},values:function(){return ct.call(Nt(this))}},zt=function(t,n){return w(t)&&t[_t]&&"symbol"!=typeof n&&n in t&&String(+n)==String(n)},qt=function(t,n){return zt(t,n=g(n,!0))?l(2,t[n]):B(t,n)},Kt=function(t,n,r){return!(zt(t,n=g(n,!0))&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?G(t,n,r):(t[n]=r.value,t)};St||(W.f=qt,U.f=Kt),u(u.S+u.F*!St,"Object",{getOwnPropertyDescriptor:qt,defineProperty:Kt}),o(function(){yt.call({})})&&(yt=gt=function(){return vt.call(this)});var Jt=v({},Wt);v(Jt,Vt),h(Jt,bt,Vt.values),v(Jt,{slice:Gt,set:Bt,constructor:function(){},toString:yt,toLocaleString:Ut}),Lt(Jt,"buffer","b"),Lt(Jt,"byteOffset","o"),Lt(Jt,"byteLength","l"),Lt(Jt,"length","e"),G(Jt,mt,{get:function(){return this[_t]}}),t.exports=function(t,n,r,f){f=!!f;var a=t+(f?"Clamped":"")+"Array",l="Uint8Array"!=a,v="get"+t,p="set"+t,y=i[a],g=y||{},b=y&&E(y),m=!y||!c.ABV,S={},_=y&&y[H],j=function(t,r){var e=t._d;return e.v[v](r*n+e.o,jt)},F=function(t,r,e){var i=t._d;f&&(e=(e=Math.round(e))<0?0:e>255?255:255&e),i.v[p](r*n+i.o,e,jt)},M=function(t,n){G(t,n,{get:function(){return j(this,n)},set:function(t){return F(this,n,t)},enumerable:!0})};m?(y=r(function(t,r,e,i){s(t,y,a,"_d");var o,u,c,f,l=0,v=0;if(w(r)){if(!(r instanceof X||(f=x(r))==K||f==J))return _t in r?kt(y,r):Rt.call(y,r);o=r,v=At(e,n);var p=r.byteLength;if(void 0===i){if(p%n)throw V(Et);if((u=p-v)<0)throw V(Et)}else if((u=d(i)*n)+v>p)throw V(Et);c=u/n}else c=Mt(r,!0),u=c*n,o=new X(u);for(h(t,"_d",{b:o,o:v,l:u,e:c,v:new Q(o)});l<c;)M(t,l++)}),_=y[H]=O(Jt),h(_,"constructor",y)):L(function(t){new y(null),new y(t)},!0)||(y=r(function(t,r,e,i){s(t,y,a);var o;return w(r)?r instanceof X||(o=x(r))==K||o==J?void 0!==i?new g(r,At(e,n),i):void 0!==e?new g(r,At(e,n)):new g(r):_t in r?kt(y,r):Rt.call(y,r):new g(Mt(r,l))}),Z(b!==Function.prototype?P(g).concat(P(b)):P(g),function(t){t in y||h(y,t,g[t])}),y[H]=_,e||(_.constructor=y));var A=_[bt],N=!!A&&("values"==A.name||void 0==A.name),T=Vt.values;h(y,xt,!0),h(_,_t,a),h(_,Ot,!0),h(_,wt,y),(f?new y(1)[mt]==a:mt in _)||G(_,mt,{get:function(){return a}}),S[a]=y,u(u.G+u.W+u.F*(y!=g),S),u(u.S,a,{BYTES_PER_ELEMENT:n,from:Rt,of:Ct}),Y in _||h(_,Y,n),u(u.P,a,Wt),R(a),u(u.P+u.F*Ft,a,{set:Bt}),u(u.P+u.F*!N,a,Vt),u(u.P+u.F*(_.toString!=yt),a,{toString:yt}),u(u.P+u.F*o(function(){new y(1).slice()}),a,{slice:Gt}),u(u.P+u.F*(o(function(){return[1,2].toLocaleString()!=new y([1,2]).toLocaleString()})||!o(function(){_.toLocaleString.call([1,2])})),a,{toLocaleString:Ut}),k[a]=N?A:T,e||N||h(_,bt,T)}}else t.exports=function(){}},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n,r){var e=r(21),i=r(5).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n,r){t.exports=!r(12)&&!r(18)(function(){return 7!=Object.defineProperty(r(57)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){"use strict";var e=r(36),i=r(51),o=r(64),u=r(13),c=r(8),f=r(35),a=r(96),s=r(38),l=r(103),h=r(15)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n,r){var e=r(20),i=r(100),o=r(34),u=r(39)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(57)("iframe"),e=o.length;for(n.style.display="none",r(93).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(63),i=r(34).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(8),i=r(9),o=r(90)(!1),u=r(39)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){t.exports=r(13)},function(t,n,r){var e=r(76)("meta"),i=r(6),o=r(24),u=r(11).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(4)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n){t.exports=function(t,n,r,e){if(!(t instanceof n)||void 0!==e&&e in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,n){t.exports=!1},function(t,n,r){var e=r(2),i=r(173),o=r(133),u=r(145)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(132)("iframe"),e=o.length;for(n.style.display="none",r(135).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(175),i=r(133).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n,r){var e=r(175),i=r(133);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(28);t.exports=function(t,n,r){for(var i in n)e(t,i,n[i],r);return t}},function(t,n,r){"use strict";var e=r(3),i=r(11),o=r(10),u=r(7)("species");t.exports=function(t){var n=e[t];o&&n&&!n[u]&&i.f(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(67),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n,r){var e=r(33);t.exports=function(t){return Object(e(t))}},function(t,n,r){var e=r(7)("unscopables"),i=Array.prototype;void 0==i[e]&&r(27)(i,e,{}),t.exports=function(t){i[e][t]=!0}},function(t,n,r){var e=r(53),i=r(169),o=r(137),u=r(2),c=r(16),f=r(154),a={},s={},n=t.exports=function(t,n,r,l,h){var v,p,d,y,g=h?function(){return t}:f(t),b=e(r,l,n?2:1),m=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(v=c(t.length);v>m;m++)if((y=n?b(u(p=t[m])[0],p[1]):b(t[m]))===a||y===s)return y}else for(d=g.call(t);!(p=d.next()).done;)if((y=i(d,b,p.value,n))===a||y===s)return y};n.BREAK=a,n.RETURN=s},function(t,n){t.exports={}},function(t,n,r){var e=r(11).f,i=r(24),o=r(7)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(1),i=r(46),o=r(4),u=r(150),c="["+u+"]",f="​",a=RegExp("^"+c+c+"*"),s=RegExp(c+c+"*$"),l=function(t,n,r){var i={},c=o(function(){return!!u[t]()||f[t]()!=f}),a=i[t]=c?n(h):u[t];r&&(i[r]=a),e(e.P+e.F*c,"String",i)},h=l.trim=function(t,n){return t=String(i(t)),1&n&&(t=t.replace(a,"")),2&n&&(t=t.replace(s,"")),t};t.exports=l},function(t,n,r){t.exports={default:r(86),__esModule:!0}},function(t,n,r){t.exports={default:r(87),__esModule:!0}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=r(84),o=e(i),u=r(83),c=e(u),f="function"==typeof c.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":typeof t};n.default="function"==typeof c.default&&"symbol"===f(o.default)?function(t){return void 0===t?"undefined":f(t)}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":void 0===t?"undefined":f(t)}},function(t,n,r){r(110),r(108),r(111),r(112),t.exports=r(25).Symbol},function(t,n,r){r(109),r(113),t.exports=r(44).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(9),i=r(106),o=r(105);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){var e=r(88);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(19),i=r(62),o=r(37);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){t.exports=r(5).document&&document.documentElement},function(t,n,r){var e=r(56);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n,r){var e=r(56);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(60),i=r(22),o=r(38),u={};r(13)(u,r(15)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,r){var e=r(19),i=r(9);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){var e=r(23)("meta"),i=r(21),o=r(8),u=r(14).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(18)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n,r){var e=r(14),i=r(20),o=r(19);t.exports=r(12)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(37),i=r(22),o=r(9),u=r(42),c=r(8),f=r(58),a=Object.getOwnPropertyDescriptor;n.f=r(12)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(9),i=r(61).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(8),i=r(77),o=r(39)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,r){var e=r(41),i=r(33);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(41),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n,r){var e=r(41),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){"use strict";var e=r(89),i=r(97),o=r(35),u=r(9);t.exports=r(59)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){},function(t,n,r){"use strict";var e=r(104)(!0);r(59)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";var e=r(5),i=r(8),o=r(12),u=r(51),c=r(64),f=r(99).KEY,a=r(18),s=r(40),l=r(38),h=r(23),v=r(15),p=r(44),d=r(43),y=r(98),g=r(92),b=r(95),m=r(20),x=r(9),w=r(42),S=r(22),_=r(60),O=r(102),E=r(101),P=r(14),j=r(19),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(61).f=O.f=Z,r(37).f=X,r(62).f=tt,o&&!r(36)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(13)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){r(43)("asyncIterator")},function(t,n,r){r(43)("observable")},function(t,n,r){r(107);for(var e=r(5),i=r(13),o=r(35),u=r(15)("toStringTag"),c=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],f=0;f<5;f++){var a=c[f],s=e[a],l=s&&s.prototype;l&&!l[u]&&i(l,u,a),o[a]=o.Array}},function(t,n,r){var e=r(45),i=r(7)("toStringTag"),o="Arguments"==e(function(){return arguments}()),u=function(t,n){try{return t[n]}catch(t){}};t.exports=function(t){var n,r,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(n=Object(t),i))?r:o?e(n):"Object"==(c=e(n))&&"function"==typeof n.callee?"Arguments":c}},function(t,n,r){var e=r(45);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(30),i=r(16),o=r(75);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){"use strict";var e=r(3),i=r(1),o=r(28),u=r(73),c=r(65),f=r(79),a=r(68),s=r(6),l=r(4),h=r(123),v=r(81),p=r(136);t.exports=function(t,n,r,d,y,g){var b=e[t],m=b,x=y?"set":"add",w=m&&m.prototype,S={},_=function(t){var n=w[t];o(w,t,"delete"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!s(t)?void 0:n.call(this,0===t?0:t)}:"add"==t?function(t){return n.call(this,0===t?0:t),this}:function(t,r){return n.call(this,0===t?0:t,r),this})};if("function"==typeof m&&(g||w.forEach&&!l(function(){(new m).entries().next()}))){var O=new m,E=O[x](g?{}:-0,1)!=O,P=l(function(){O.has(1)}),j=h(function(t){new m(t)}),F=!g&&l(function(){for(var t=new m,n=5;n--;)t[x](n,n);return!t.has(-0)});j||(m=n(function(n,r){a(n,m,t);var e=p(new b,n,m);return void 0!=r&&f(r,y,e[x],e),e}),m.prototype=w,w.constructor=m),(P||F)&&(_("delete"),_("has"),y&&_("get")),(F||E)&&_(x),g&&w.clear&&delete w.clear}else m=d.getConstructor(n,t,y,x),u(m.prototype,r),c.NEED=!0;return v(m,t),S[t]=m,i(i.G+i.W+i.F*(m!=b),S),g||d.setStrong(m,t,y),m}},function(t,n,r){"use strict";var e=r(27),i=r(28),o=r(4),u=r(46),c=r(7);t.exports=function(t,n,r){var f=c(t),a=r(u,f,""[t]),s=a[0],l=a[1];o(function(){var n={};return n[f]=function(){return 7},7!=""[t](n)})&&(i(String.prototype,t,s),e(RegExp.prototype,f,2==n?function(t,n){return l.call(t,this,n)}:function(t){return l.call(t,this)}))}
},function(t,n,r){"use strict";var e=r(2);t.exports=function(){var t=e(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},function(t,n){t.exports=function(t,n,r){var e=void 0===r;switch(n.length){case 0:return e?t():t.call(r);case 1:return e?t(n[0]):t.call(r,n[0]);case 2:return e?t(n[0],n[1]):t.call(r,n[0],n[1]);case 3:return e?t(n[0],n[1],n[2]):t.call(r,n[0],n[1],n[2]);case 4:return e?t(n[0],n[1],n[2],n[3]):t.call(r,n[0],n[1],n[2],n[3])}return t.apply(r,n)}},function(t,n,r){var e=r(6),i=r(45),o=r(7)("match");t.exports=function(t){var n;return e(t)&&(void 0!==(n=t[o])?!!n:"RegExp"==i(t))}},function(t,n,r){var e=r(7)("iterator"),i=!1;try{var o=[7][e]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,n){if(!n&&!i)return!1;var r=!1;try{var o=[7],u=o[e]();u.next=function(){return{done:r=!0}},o[e]=function(){return u},t(o)}catch(t){}return r}},function(t,n,r){t.exports=r(69)||!r(4)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete r(3)[t]})},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(3),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n,r){for(var e,i=r(3),o=r(27),u=r(76),c=u("typed_array"),f=u("view"),a=!(!i.ArrayBuffer||!i.DataView),s=a,l=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(e=i[h[l++]])?(o(e.prototype,c,!0),o(e.prototype,f,!0)):s=!1;t.exports={ABV:a,CONSTR:s,TYPED:c,VIEW:f}},function(t,n){"use strict";var r={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:-1==t.indexOf("Safari"),weixin:-1==t.indexOf("MicroMessenger")}}()};t.exports=r},function(t,n,r){"use strict";var e=r(85),i=function(t){return t&&t.__esModule?t:{default:t}}(e),o=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):r[t]||t}function n(t){return e[t]}var r={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},e={};for(var u in r)e[r[u]]=u;return r["&apos;"]="'",e["'"]="&#39;",{encode:function(t){return t?(""+t).replace(/['<> "&]/g,n).replace(/\r?\n/g,"<br/>").replace(/\s/g,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(/<br\s*\/?>/gi,"\n").replace(/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,t).replace(/\u00a0/g," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r+=2)n.push(String.fromCharCode("0x"+t.slice(r,r+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,r=t.length;r>n;n++)t[n]=o.encodeObject(t[n]);else if("object"==(void 0===t?"undefined":(0,i.default)(t)))for(var e in t)t[e]=o.encodeObject(t[e]);else if("string"==typeof t)return o.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=o},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=function(t){for(var n=e(this),r=o(n.length),u=arguments.length,c=i(u>1?arguments[1]:void 0,r),f=u>2?arguments[2]:void 0,a=void 0===f?r:i(f,r);a>c;)n[c++]=t;return n}},function(t,n,r){"use strict";var e=r(11),i=r(66);t.exports=function(t,n,r){n in t?e.f(t,n,i(0,r)):t[n]=r}},function(t,n,r){var e=r(6),i=r(3).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n,r){var e=r(7)("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(r){try{return n[e]=!1,!"/./"[t](n)}catch(t){}}return!0}},function(t,n,r){t.exports=r(3).document&&document.documentElement},function(t,n,r){var e=r(6),i=r(144).set;t.exports=function(t,n,r){var o,u=n.constructor;return u!==r&&"function"==typeof u&&(o=u.prototype)!==r.prototype&&e(o)&&i&&i(t,o),t}},function(t,n,r){var e=r(80),i=r(7)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(e.Array===t||o[i]===t)}},function(t,n,r){var e=r(45);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(70),i=r(66),o=r(81),u={};r(27)(u,r(7)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n,r){"use strict";var e=r(69),i=r(1),o=r(28),u=r(27),c=r(24),f=r(80),a=r(139),s=r(81),l=r(32),h=r(7)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n){var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,n){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,n,r){var e=r(3),i=r(151).set,o=e.MutationObserver||e.WebKitMutationObserver,u=e.process,c=e.Promise,f="process"==r(45)(u);t.exports=function(){var t,n,r,a=function(){var e,i;for(f&&(e=u.domain)&&e.exit();t;){i=t.fn,t=t.next;try{i()}catch(e){throw t?r():n=void 0,e}}n=void 0,e&&e.enter()};if(f)r=function(){u.nextTick(a)};else if(o){var s=!0,l=document.createTextNode("");new o(a).observe(l,{characterData:!0}),r=function(){l.data=s=!s}}else if(c&&c.resolve){var h=c.resolve();r=function(){h.then(a)}}else r=function(){i.call(e,a)};return function(e){var i={fn:e,next:void 0};n&&(n.next=i),t||(t=i,r()),n=i}}},function(t,n,r){var e=r(6),i=r(2),o=function(t,n){if(i(t),!e(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,e){try{e=r(53)(Function.call,r(31).f(Object.prototype,"__proto__").set,2),e(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,r){return o(t,r),n?t.__proto__=r:e(t,r),t}}({},!1):void 0),check:o}},function(t,n,r){var e=r(126)("keys"),i=r(76);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(2),i=r(26),o=r(7)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||void 0==(r=e(u)[o])?n:i(r)}},function(t,n,r){var e=r(67),i=r(46);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(122),i=r(46);t.exports=function(t,n,r){if(e(n))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},function(t,n,r){"use strict";var e=r(67),i=r(46);t.exports=function(t){var n=String(i(this)),r="",o=e(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(n+=n))1&o&&(r+=n);return r}},function(t,n){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,n,r){var e,i,o,u=r(53),c=r(121),f=r(135),a=r(132),s=r(3),l=s.process,h=s.setImmediate,v=s.clearImmediate,p=s.MessageChannel,d=0,y={},g="onreadystatechange",b=function(){var t=+this;if(y.hasOwnProperty(t)){var n=y[t];delete y[t],n()}},m=function(t){b.call(t.data)};h&&v||(h=function(t){for(var n=[],r=1;arguments.length>r;)n.push(arguments[r++]);return y[++d]=function(){c("function"==typeof t?t:Function(t),n)},e(d),d},v=function(t){delete y[t]},"process"==r(45)(l)?e=function(t){l.nextTick(u(b,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=m,e=u(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(e=function(t){s.postMessage(t+"","*")},s.addEventListener("message",m,!1)):e=g in a("script")?function(t){f.appendChild(a("script"))[g]=function(){f.removeChild(this),b.call(t)}}:function(t){setTimeout(u(b,t,1),0)}),t.exports={set:h,clear:v}},function(t,n,r){"use strict";var e=r(3),i=r(10),o=r(69),u=r(127),c=r(27),f=r(73),a=r(4),s=r(68),l=r(67),h=r(16),v=r(71).f,p=r(11).f,d=r(130),y=r(81),g="ArrayBuffer",b="DataView",m="prototype",x="Wrong length!",w="Wrong index!",S=e[g],_=e[b],O=e.Math,E=e.RangeError,P=e.Infinity,j=S,F=O.abs,M=O.pow,A=O.floor,N=O.log,T=O.LN2,I="buffer",k="byteLength",L="byteOffset",R=i?"_b":I,C=i?"_l":k,D=i?"_o":L,U=function(t,n,r){var e,i,o,u=Array(r),c=8*r-n-1,f=(1<<c)-1,a=f>>1,s=23===n?M(2,-24)-M(2,-77):0,l=0,h=t<0||0===t&&1/t<0?1:0;for(t=F(t),t!=t||t===P?(i=t!=t?1:0,e=f):(e=A(N(t)/T),t*(o=M(2,-e))<1&&(e--,o*=2),t+=e+a>=1?s/o:s*M(2,1-a),t*o>=2&&(e++,o/=2),e+a>=f?(i=0,e=f):e+a>=1?(i=(t*o-1)*M(2,n),e+=a):(i=t*M(2,a-1)*M(2,n),e=0));n>=8;u[l++]=255&i,i/=256,n-=8);for(e=e<<n|i,c+=n;c>0;u[l++]=255&e,e/=256,c-=8);return u[--l]|=128*h,u},W=function(t,n,r){var e,i=8*r-n-1,o=(1<<i)-1,u=o>>1,c=i-7,f=r-1,a=t[f--],s=127&a;for(a>>=7;c>0;s=256*s+t[f],f--,c-=8);for(e=s&(1<<-c)-1,s>>=-c,c+=n;c>0;e=256*e+t[f],f--,c-=8);if(0===s)s=1-u;else{if(s===o)return e?NaN:a?-P:P;e+=M(2,n),s-=u}return(a?-1:1)*e*M(2,s-n)},G=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},B=function(t){return[255&t]},V=function(t){return[255&t,t>>8&255]},z=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},q=function(t){return U(t,52,8)},K=function(t){return U(t,23,4)},J=function(t,n,r){p(t[m],n,{get:function(){return this[r]}})},Y=function(t,n,r,e){var i=+r,o=l(i);if(i!=o||o<0||o+n>t[C])throw E(w);var u=t[R]._b,c=o+t[D],f=u.slice(c,c+n);return e?f:f.reverse()},H=function(t,n,r,e,i,o){var u=+r,c=l(u);if(u!=c||c<0||c+n>t[C])throw E(w);for(var f=t[R]._b,a=c+t[D],s=e(+i),h=0;h<n;h++)f[a+h]=s[o?h:n-h-1]},$=function(t,n){s(t,S,g);var r=+n,e=h(r);if(r!=e)throw E(x);return e};if(u.ABV){if(!a(function(){new S})||!a(function(){new S(.5)})){S=function(t){return new j($(this,t))};for(var X,Q=S[m]=j[m],Z=v(j),tt=0;Z.length>tt;)(X=Z[tt++])in S||c(S,X,j[X]);o||(Q.constructor=S)}var nt=new _(new S(2)),rt=_[m].setInt8;nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||f(_[m],{setInt8:function(t,n){rt.call(this,t,n<<24>>24)},setUint8:function(t,n){rt.call(this,t,n<<24>>24)}},!0)}else S=function(t){var n=$(this,t);this._b=d.call(Array(n),0),this[C]=n},_=function(t,n,r){s(this,_,b),s(t,S,b);var e=t[C],i=l(n);if(i<0||i>e)throw E("Wrong offset!");if(r=void 0===r?e-i:h(r),i+r>e)throw E(x);this[R]=t,this[D]=i,this[C]=r},i&&(J(S,k,"_l"),J(_,I,"_b"),J(_,k,"_l"),J(_,L,"_o")),f(_[m],{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){var n=Y(this,2,t,arguments[1]);return(n[1]<<8|n[0])<<16>>16},getUint16:function(t){var n=Y(this,2,t,arguments[1]);return n[1]<<8|n[0]},getInt32:function(t){return G(Y(this,4,t,arguments[1]))},getUint32:function(t){return G(Y(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return W(Y(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return W(Y(this,8,t,arguments[1]),52,8)},setInt8:function(t,n){H(this,1,t,B,n)},setUint8:function(t,n){H(this,1,t,B,n)},setInt16:function(t,n){H(this,2,t,V,n,arguments[2])},setUint16:function(t,n){H(this,2,t,V,n,arguments[2])},setInt32:function(t,n){H(this,4,t,z,n,arguments[2])},setUint32:function(t,n){H(this,4,t,z,n,arguments[2])},setFloat32:function(t,n){H(this,4,t,K,n,arguments[2])},setFloat64:function(t,n){H(this,8,t,q,n,arguments[2])}});y(S,g),y(_,b),c(_[m],u.VIEW,!0),n[g]=S,n[b]=_},function(t,n,r){var e=r(3),i=r(52),o=r(69),u=r(182),c=r(11).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){var e=r(114),i=r(7)("iterator"),o=r(80);t.exports=r(52).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[e(t)]}},function(t,n,r){"use strict";var e=r(78),i=r(170),o=r(80),u=r(30);t.exports=r(140)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){function r(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=r},function(t,n){function r(t,n){if(t.classList)t.classList.remove(n);else{var r=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(r," ")}}t.exports=r},function(t,n){function r(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function i(t){if(s===setTimeout)return setTimeout(t,0);if((s===r||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(n){try{return s.call(null,t,0)}catch(n){return s.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===e||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}function u(){d&&v&&(d=!1,v.length?p=v.concat(p):y=-1,p.length&&c())}function c(){if(!d){var t=i(u);d=!0;for(var n=p.length;n;){for(v=p,p=[];++y<n;)v&&v[y].run();y=-1,n=p.length}v=null,d=!1,o(t)}}function f(t,n){this.fun=t,this.array=n}function a(){}var s,l,h=t.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:r}catch(t){s=r}try{l="function"==typeof clearTimeout?clearTimeout:e}catch(t){l=e}}();var v,p=[],d=!1,y=-1;h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];p.push(new f(t,n)),1!==p.length||d||i(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,n,r){var e=r(45);t.exports=function(t,n){if("number"!=typeof t&&"Number"!=e(t))throw TypeError(n);return+t}},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=[].copyWithin||function(t,n){var r=e(this),u=o(r.length),c=i(t,u),f=i(n,u),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?u:i(a,u))-f,u-c),l=1;for(f<c&&c<f+s&&(l=-1,f+=s-1,c+=s-1);s-- >0;)f in r?r[c]=r[f]:delete r[c],c+=l,f+=l;return r}},function(t,n,r){var e=r(79);t.exports=function(t,n){var r=[];return e(t,!1,r.push,r,n),r}},function(t,n,r){var e=r(26),i=r(17),o=r(115),u=r(16);t.exports=function(t,n,r,c,f){e(n);var a=i(t),s=o(a),l=u(a.length),h=f?l-1:0,v=f?-1:1;if(r<2)for(;;){if(h in s){c=s[h],h+=v;break}if(h+=v,f?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;f?h>=0:l>h;h+=v)h in s&&(c=n(c,s[h],h,a));return c}},function(t,n,r){"use strict";var e=r(26),i=r(6),o=r(121),u=[].slice,c={},f=function(t,n,r){if(!(n in c)){for(var e=[],i=0;i<n;i++)e[i]="a["+i+"]";c[n]=Function("F,a","return new F("+e.join(",")+")")}return c[n](t,r)};t.exports=Function.bind||function(t){var n=e(this),r=u.call(arguments,1),c=function(){var e=r.concat(u.call(arguments));return this instanceof c?f(n,e.length,e):o(n,e,t)};return i(n.prototype)&&(c.prototype=n.prototype),c}},function(t,n,r){"use strict";var e=r(11).f,i=r(70),o=r(73),u=r(53),c=r(68),f=r(46),a=r(79),s=r(140),l=r(170),h=r(74),v=r(10),p=r(65).fastKey,d=v?"_s":"size",y=function(t,n){var r,e=p(n);if("F"!==e)return t._i[e];for(r=t._f;r;r=r.n)if(r.k==n)return r};t.exports={getConstructor:function(t,n,r,s){var l=t(function(t,e){c(t,l,n,"_i"),t._i=i(null),t._f=void 0,t._l=void 0,t[d]=0,void 0!=e&&a(e,r,t[s],t)});return o(l.prototype,{clear:function(){for(var t=this,n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[d]=0},delete:function(t){var n=this,r=y(n,t);if(r){var e=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=e),e&&(e.p=i),n._f==r&&(n._f=e),n._l==r&&(n._l=i),n[d]--}return!!r},forEach:function(t){c(this,l,"forEach");for(var n,r=u(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!y(this,t)}}),v&&e(l.prototype,"size",{get:function(){return f(this[d])}}),l},def:function(t,n,r){var e,i,o=y(t,n);return o?o.v=r:(t._l=o={i:i=p(n,!0),k:n,v:r,p:e=t._l,n:void 0,r:!1},t._f||(t._f=o),e&&(e.n=o),t[d]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,n,r){s(t,n,function(t,n){this._t=t,this._k=n,this._l=void 0},function(){for(var t=this,n=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?"keys"==n?l(0,r.k):"values"==n?l(0,r.v):l(0,[r.k,r.v]):(t._t=void 0,l(1))},r?"entries":"values",!r,!0),h(n)}}},function(t,n,r){var e=r(114),i=r(161);t.exports=function(t){return function(){if(e(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,n,r){"use strict";var e=r(73),i=r(65).getWeak,o=r(2),u=r(6),c=r(68),f=r(79),a=r(48),s=r(24),l=a(5),h=a(6),v=0,p=function(t){return t._l||(t._l=new d)},d=function(){this.a=[]},y=function(t,n){return l(t.a,function(t){return t[0]===n})};d.prototype={get:function(t){var n=y(this,t);if(n)return n[1]},has:function(t){return!!y(this,t)},set:function(t,n){var r=y(this,t);r?r[1]=n:this.a.push([t,n])},delete:function(t){var n=h(this.a,function(n){return n[0]===t});return~n&&this.a.splice(n,1),!!~n}},t.exports={getConstructor:function(t,n,r,o){var a=t(function(t,e){c(t,a,n,"_i"),t._i=v++,t._l=void 0,void 0!=e&&f(e,r,t[o],t)});return e(a.prototype,{delete:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).delete(t):n&&s(n,this._i)&&delete n[this._i]},has:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).has(t):n&&s(n,this._i)}}),a},def:function(t,n,r){var e=i(o(n),!0);return!0===e?p(t).set(n,r):e[t._i]=r,t},ufstore:p}},function(t,n,r){t.exports=!r(10)&&!r(4)(function(){return 7!=Object.defineProperty(r(132)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(6),i=Math.floor;t.exports=function(t){return!e(t)&&isFinite(t)&&i(t)===t}},function(t,n,r){var e=r(2);t.exports=function(t,n,r,i){try{return i?n(e(r)[0],r[1]):n(r)}catch(n){var o=t.return;throw void 0!==o&&e(o.call(t)),n}}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,n,r){"use strict";var e=r(72),i=r(125),o=r(116),u=r(17),c=r(115),f=Object.assign;t.exports=!f||r(4)(function(){var t={},n={},r=Symbol(),e="abcdefghijklmnopqrst";return t[r]=7,e.split("").forEach(function(t){n[t]=t}),7!=f({},t)[r]||Object.keys(f({},n)).join("")!=e})?function(t,n){for(var r=u(t),f=arguments.length,a=1,s=i.f,l=o.f;f>a;)for(var h,v=c(arguments[a++]),p=s?e(v).concat(s(v)):e(v),d=p.length,y=0;d>y;)l.call(v,h=p[y++])&&(r[h]=v[h]);return r}:f},function(t,n,r){var e=r(11),i=r(2),o=r(72);t.exports=r(10)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(30),i=r(71).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(24),i=r(30),o=r(117)(!1),u=r(145)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){var e=r(72),i=r(30),o=r(116).f;t.exports=function(t){return function(n){for(var r,u=i(n),c=e(u),f=c.length,a=0,s=[];f>a;)o.call(u,r=c[a++])&&s.push(t?[r,u[r]]:u[r]);return s}}},function(t,n,r){var e=r(71),i=r(125),o=r(2),u=r(3).Reflect;t.exports=u&&u.ownKeys||function(t){var n=e.f(o(t)),r=i.f;return r?n.concat(r(t)):n}},function(t,n,r){var e=r(3).parseFloat,i=r(82).trim;t.exports=1/e(r(150)+"-0")!=-1/0?function(t){var n=i(String(t),3),r=e(n);return 0===r&&"-"==n.charAt(0)?-0:r}:e},function(t,n,r){var e=r(3).parseInt,i=r(82).trim,o=r(150),u=/^[\-+]?0[xX]/;t.exports=8!==e(o+"08")||22!==e(o+"0x16")?function(t,n){var r=i(String(t),3);return e(r,n>>>0||(u.test(r)?16:10))}:e},function(t,n){t.exports=Object.is||function(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n}},function(t,n,r){var e=r(16),i=r(149),o=r(46);t.exports=function(t,n,r,u){var c=String(o(t)),f=c.length,a=void 0===r?" ":String(r),s=e(n);if(s<=f||""==a)return c;var l=s-f,h=i.call(a,Math.ceil(l/a.length));return h.length>l&&(h=h.slice(0,l)),u?h+c:c+h}},function(t,n,r){n.f=r(7)},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var n=e.getEntry(this,t);return n&&n.v},set:function(t,n){return e.def(this,0===t?0:t,n)}},e,!0)},function(t,n,r){r(10)&&"g"!=/./g.flags&&r(11).f(RegExp.prototype,"flags",{configurable:!0,get:r(120)})},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t=0===t?0:t,t)}},e)},function(t,n,r){"use strict";var e,i=r(48)(0),o=r(28),u=r(65),c=r(172),f=r(166),a=r(6),s=u.getWeak,l=Object.isExtensible,h=f.ufstore,v={},p=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},d={get:function(t){if(a(t)){var n=s(t);return!0===n?h(this).get(t):n?n[this._i]:void 0}},set:function(t,n){return f.def(this,t,n)}},y=t.exports=r(118)("WeakMap",p,d,f,!0,!0);7!=(new y).set((Object.freeze||Object)(v),7).get(v)&&(e=f.getConstructor(p),c(e.prototype,d),u.NEED=!0,i(["delete","has","get","set"],function(t){var n=y.prototype,r=n[t];o(n,t,function(n,i){if(a(n)&&!l(n)){this._f||(this._f=new e);var o=this._f[t](n,i);return"set"==t?this:o}return r.call(this,n,i)})}))},,,,function(t,n){"use strict";function r(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){document.querySelectorAll(".article-entry a:not(.article-more-a)").forEach(function(t){var n=t.getAttribute("target");n&&""!==n||t.setAttribute("target","_blank")})}if(yiliaConfig&&yiliaConfig.toc_hide_index){document.querySelectorAll(".toc-number").forEach(function(t){t.style.display="none"})}var n=document.querySelector("#js-aboutme");n&&0!==n.length&&(n.innerHTML=n.innerText)}t.exports={init:r}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function i(t,n){var r=/\/|index.html/g;return t.replace(r,"")===n.replace(r,"")}function o(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,r=0,e=t.length;r<e;r++){var o=t[r];i(n,o.getAttribute("href"))&&(0,h.default)(o,"active")}}function u(t){for(var n=t.offsetLeft,r=t.offsetParent;null!==r;)n+=r.offsetLeft,r=r.offsetParent;return n}function c(t){for(var n=t.offsetTop,r=t.offsetParent;null!==r;)n+=r.offsetTop,r=r.offsetParent;return n}function f(t,n,r,e,i){var o=u(t),f=c(t)-n;if(f-r<=i){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,d.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(r||f)+"px",a.style.left=o+"px",a.style.zIndex=e||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");f(t,document.body.scrollTop,-63,2,0),f(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}var l=r(156),h=e(l),v=r(157),p=(e(v),r(382)),d=e(p),y=r(128),g=e(y),b=r(190),m=e(b),x=r(129);(function(){g.default.versions.mobile&&window.screen.width<800&&(o(),s())})(),(0,x.addLoadEvent)(function(){m.default.init()}),t.exports={}},,,,function(t,n,r){(function(t){"use strict";function n(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}if(r(381),r(391),r(198),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&n(Array,t,Function.call.bind([][t]))})}).call(n,function(){return this}())},,,function(t,n,r){r(210),t.exports=r(52).RegExp.escape},,,,function(t,n,r){var e=r(6),i=r(138),o=r(7)("species");t.exports=function(t){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)||(n=void 0),e(n)&&null===(n=n[o])&&(n=void 0)),void 0===n?Array:n}},function(t,n,r){var e=r(202);t.exports=function(t,n){return new(e(t))(n)}},function(t,n,r){"use strict";var e=r(2),i=r(50),o="number";t.exports=function(t){if("string"!==t&&t!==o&&"default"!==t)throw TypeError("Incorrect hint");return i(e(this),t!=o)}},function(t,n,r){var e=r(72),i=r(125),o=r(116);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){var e=r(72),i=r(30);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){"use strict";var e=r(208),i=r(121),o=r(26);t.exports=function(){for(var t=o(this),n=arguments.length,r=Array(n),u=0,c=e._,f=!1;n>u;)(r[u]=arguments[u++])===c&&(f=!0);return function(){var e,o=this,u=arguments.length,a=0,s=0;if(!f&&!u)return i(t,r,o);if(e=r.slice(),f)for(;n>a;a++)e[a]===c&&(e[a]=arguments[s++]);for(;u>s;)e.push(arguments[s++]);return i(t,e,o)}}},function(t,n,r){t.exports=r(3)},function(t,n){t.exports=function(t,n){var r=n===Object(n)?function(t){return n[t]}:n;return function(n){return String(n).replace(t,r)}}},function(t,n,r){var e=r(1),i=r(209)(/[\\^$*+?.()|[\]{}]/g,"\\$&");e(e.S,"RegExp",{escape:function(t){return i(t)}})},function(t,n,r){var e=r(1);e(e.P,"Array",{copyWithin:r(160)}),r(78)("copyWithin")},function(t,n,r){"use strict";var e=r(1),i=r(48)(4);e(e.P+e.F*!r(47)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.P,"Array",{fill:r(130)}),r(78)("fill")},function(t,n,r){"use strict";var e=r(1),i=r(48)(2);e(e.P+e.F*!r(47)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(6),o="findIndex",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(5),o="find",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(0),o=r(47)([].forEach,!0);e(e.P+e.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(53),i=r(1),o=r(17),u=r(169),c=r(137),f=r(16),a=r(131),s=r(154);i(i.S+i.F*!r(123)(function(t){Array.from(t)}),"Array",{from:function(t){var n,r,i,l,h=o(t),v="function"==typeof this?this:Array,p=arguments.length,d=p>1?arguments[1]:void 0,y=void 0!==d,g=0,b=s(h);if(y&&(d=e(d,p>2?arguments[2]:void 0,2)),void 0==b||v==Array&&c(b))for(n=f(h.length),r=new v(n);n>g;g++)a(r,g,y?d(h[g],g):h[g]);else for(l=b.call(h),r=new v;!(i=l.next()).done;g++)a(r,g,y?u(l,d,[i.value,g],!0):i.value);return r.length=g,r}})},function(t,n,r){"use strict";var e=r(1),i=r(117)(!1),o=[].indexOf,u=!!o&&1/[1].indexOf(1,-0)<0;e(e.P+e.F*(u||!r(47)(o)),"Array",{indexOf:function(t){return u?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.S,"Array",{isArray:r(138)})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=[].join;e(e.P+e.F*(r(115)!=Object||!r(47)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=r(67),u=r(16),c=[].lastIndexOf,f=!!c&&1/[1].lastIndexOf(1,-0)<0;e(e.P+e.F*(f||!r(47)(c)),"Array",{lastIndexOf:function(t){if(f)return c.apply(this,arguments)||0;var n=i(this),r=u(n.length),e=r-1;for(arguments.length>1&&(e=Math.min(e,o(arguments[1]))),e<0&&(e=r+e);e>=0;e--)if(e in n&&n[e]===t)return e||0;return-1}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(1);e(e.P+e.F*!r(47)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(131);e(e.S+e.F*r(4)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,n=arguments.length,r=new("function"==typeof this?this:Array)(n);n>t;)i(r,t,arguments[t++]);return r.length=n,r}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(135),o=r(45),u=r(75),c=r(16),f=[].slice;e(e.P+e.F*r(4)(function(){i&&f.call(i)}),"Array",{slice:function(t,n){var r=c(this.length),e=o(this);if(n=void 0===n?r:n,"Array"==e)return f.call(this,t,n);for(var i=u(t,r),a=u(n,r),s=c(a-i),l=Array(s),h=0;h<s;h++)l[h]="String"==e?this.charAt(i+h):this[i+h];return l}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(3);e(e.P+e.F*!r(47)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(26),o=r(17),u=r(4),c=[].sort,f=[1,2,3];e(e.P+e.F*(u(function(){f.sort(void 0)})||!u(function(){f.sort(null)})||!r(47)(c)),"Array",{sort:function(t){return void 0===t?c.call(o(this)):c.call(o(this),i(t))}})},function(t,n,r){r(74)("Array")},function(t,n,r){var e=r(1);e(e.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=Date.prototype.getTime,u=function(t){return t>9?t:"0"+t};e(e.P+e.F*(i(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-5e13-1).toISOString()})||!i(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){
if(!isFinite(o.call(this)))throw RangeError("Invalid time value");var t=this,n=t.getUTCFullYear(),r=t.getUTCMilliseconds(),e=n<0?"-":n>9999?"+":"";return e+("00000"+Math.abs(n)).slice(e?-6:-4)+"-"+u(t.getUTCMonth()+1)+"-"+u(t.getUTCDate())+"T"+u(t.getUTCHours())+":"+u(t.getUTCMinutes())+":"+u(t.getUTCSeconds())+"."+(r>99?r:"0"+u(r))+"Z"}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50);e(e.P+e.F*r(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var n=i(this),r=o(n);return"number"!=typeof r||isFinite(r)?n.toISOString():null}})},function(t,n,r){var e=r(7)("toPrimitive"),i=Date.prototype;e in i||r(27)(i,e,r(204))},function(t,n,r){var e=Date.prototype,i="Invalid Date",o="toString",u=e[o],c=e.getTime;new Date(NaN)+""!=i&&r(28)(e,o,function(){var t=c.call(this);return t===t?u.call(this):i})},function(t,n,r){var e=r(1);e(e.P,"Function",{bind:r(163)})},function(t,n,r){"use strict";var e=r(6),i=r(32),o=r(7)("hasInstance"),u=Function.prototype;o in u||r(11).f(u,o,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,n,r){var e=r(11).f,i=r(66),o=r(24),u=Function.prototype,c="name",f=Object.isExtensible||function(){return!0};c in u||r(10)&&e(u,c,{configurable:!0,get:function(){try{var t=this,n=(""+t).match(/^\s*function ([^ (]*)/)[1];return o(t,c)||!f(t)||e(t,c,i(5,n)),n}catch(t){return""}}})},function(t,n,r){var e=r(1),i=r(171),o=Math.sqrt,u=Math.acosh;e(e.S+e.F*!(u&&710==Math.floor(u(Number.MAX_VALUE))&&u(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,n,r){function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}var i=r(1),o=Math.asinh;i(i.S+i.F*!(o&&1/o(0)>0),"Math",{asinh:e})},function(t,n,r){var e=r(1),i=Math.atanh;e(e.S+e.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,n,r){var e=r(1),i=r(142);e(e.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,n,r){var e=r(1),i=Math.exp;e(e.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,n,r){var e=r(1),i=r(141);e(e.S+e.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,n,r){var e=r(1),i=r(142),o=Math.pow,u=o(2,-52),c=o(2,-23),f=o(2,127)*(2-c),a=o(2,-126),s=function(t){return t+1/u-1/u};e(e.S,"Math",{fround:function(t){var n,r,e=Math.abs(t),o=i(t);return e<a?o*s(e/a/c)*a*c:(n=(1+c/u)*e,r=n-(n-e),r>f||r!=r?o*(1/0):o*r)}})},function(t,n,r){var e=r(1),i=Math.abs;e(e.S,"Math",{hypot:function(t,n){for(var r,e,o=0,u=0,c=arguments.length,f=0;u<c;)r=i(arguments[u++]),f<r?(e=f/r,o=o*e*e+1,f=r):r>0?(e=r/f,o+=e*e):o+=r;return f===1/0?1/0:f*Math.sqrt(o)}})},function(t,n,r){var e=r(1),i=Math.imul;e(e.S+e.F*r(4)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,n){var r=65535,e=+t,i=+n,o=r&e,u=r&i;return 0|o*u+((r&e>>>16)*u+o*(r&i>>>16)<<16>>>0)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log10:function(t){return Math.log(t)/Math.LN10}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log1p:r(171)})},function(t,n,r){var e=r(1);e(e.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,n,r){var e=r(1);e(e.S,"Math",{sign:r(142)})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S+e.F*r(4)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S,"Math",{tanh:function(t){var n=i(t=+t),r=i(-t);return n==1/0?1:r==1/0?-1:(n-r)/(o(t)+o(-t))}})},function(t,n,r){var e=r(1);e(e.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(45),u=r(136),c=r(50),f=r(4),a=r(71).f,s=r(31).f,l=r(11).f,h=r(82).trim,v="Number",p=e[v],d=p,y=p.prototype,g=o(r(70)(y))==v,b="trim"in String.prototype,m=function(t){var n=c(t,!1);if("string"==typeof n&&n.length>2){n=b?n.trim():h(n,3);var r,e,i,o=n.charCodeAt(0);if(43===o||45===o){if(88===(r=n.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(n.charCodeAt(1)){case 66:case 98:e=2,i=49;break;case 79:case 111:e=8,i=55;break;default:return+n}for(var u,f=n.slice(2),a=0,s=f.length;a<s;a++)if((u=f.charCodeAt(a))<48||u>i)return NaN;return parseInt(f,e)}}return+n};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var n=arguments.length<1?0:t,r=this;return r instanceof p&&(g?f(function(){y.valueOf.call(r)}):o(r)!=v)?u(new d(m(n)),r,p):m(n)};for(var x,w=r(10)?a(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)i(d,x=w[S])&&!i(p,x)&&l(p,x,s(d,x));p.prototype=y,y.constructor=p,r(28)(e,v,p)}},function(t,n,r){var e=r(1);e(e.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,n,r){var e=r(1),i=r(3).isFinite;e(e.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,n,r){var e=r(1);e(e.S,"Number",{isInteger:r(168)})},function(t,n,r){var e=r(1);e(e.S,"Number",{isNaN:function(t){return t!=t}})},function(t,n,r){var e=r(1),i=r(168),o=Math.abs;e(e.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,n,r){var e=r(1);e(e.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,n,r){var e=r(1);e(e.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,n,r){var e=r(1),i=r(178);e(e.S+e.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.S+e.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,n,r){"use strict";var e=r(1),i=r(67),o=r(159),u=r(149),c=1..toFixed,f=Math.floor,a=[0,0,0,0,0,0],s="Number.toFixed: incorrect invocation!",l="0",h=function(t,n){for(var r=-1,e=n;++r<6;)e+=t*a[r],a[r]=e%1e7,e=f(e/1e7)},v=function(t){for(var n=6,r=0;--n>=0;)r+=a[n],a[n]=f(r/t),r=r%t*1e7},p=function(){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==a[t]){var r=String(a[t]);n=""===n?r:n+u.call(l,7-r.length)+r}return n},d=function(t,n,r){return 0===n?r:n%2==1?d(t,n-1,r*t):d(t*t,n/2,r)},y=function(t){for(var n=0,r=t;r>=4096;)n+=12,r/=4096;for(;r>=2;)n+=1,r/=2;return n};e(e.P+e.F*(!!c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(4)(function(){c.call({})})),"Number",{toFixed:function(t){var n,r,e,c,f=o(this,s),a=i(t),g="",b=l;if(a<0||a>20)throw RangeError(s);if(f!=f)return"NaN";if(f<=-1e21||f>=1e21)return String(f);if(f<0&&(g="-",f=-f),f>1e-21)if(n=y(f*d(2,69,1))-69,r=n<0?f*d(2,-n,1):f/d(2,n,1),r*=4503599627370496,(n=52-n)>0){for(h(0,r),e=a;e>=7;)h(1e7,0),e-=7;for(h(d(10,e,1),0),e=n-1;e>=23;)v(1<<23),e-=23;v(1<<e),h(1,1),v(2),b=p()}else h(0,r),h(1<<-n,0),b=p()+u.call(l,a);return a>0?(c=b.length,b=g+(c<=a?"0."+u.call(l,a-c)+b:b.slice(0,c-a)+"."+b.slice(c-a))):b=g+b,b}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=r(159),u=1..toPrecision;e(e.P+e.F*(i(function(){return"1"!==u.call(1,void 0)})||!i(function(){u.call({})})),"Number",{toPrecision:function(t){var n=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?u.call(n):u.call(n,t)}})},function(t,n,r){var e=r(1);e(e.S+e.F,"Object",{assign:r(172)})},function(t,n,r){var e=r(1);e(e.S,"Object",{create:r(70)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperties:r(173)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperty:r(11).f})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("freeze",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(30),i=r(31).f;r(49)("getOwnPropertyDescriptor",function(){return function(t,n){return i(e(t),n)}})},function(t,n,r){r(49)("getOwnPropertyNames",function(){return r(174).f})},function(t,n,r){var e=r(17),i=r(32);r(49)("getPrototypeOf",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6);r(49)("isExtensible",function(t){return function(n){return!!e(n)&&(!t||t(n))}})},function(t,n,r){var e=r(6);r(49)("isFrozen",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(6);r(49)("isSealed",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(1);e(e.S,"Object",{is:r(180)})},function(t,n,r){var e=r(17),i=r(72);r(49)("keys",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("preventExtensions",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("seal",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(1);e(e.S,"Object",{setPrototypeOf:r(144).set})},function(t,n,r){"use strict";var e=r(114),i={};i[r(7)("toStringTag")]="z",i+""!="[object z]"&&r(28)(Object.prototype,"toString",function(){return"[object "+e(this)+"]"},!0)},function(t,n,r){var e=r(1),i=r(178);e(e.G+e.F*(parseFloat!=i),{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.G+e.F*(parseInt!=i),{parseInt:i})},function(t,n,r){"use strict";var e,i,o,u=r(69),c=r(3),f=r(53),a=r(114),s=r(1),l=r(6),h=r(26),v=r(68),p=r(79),d=r(146),y=r(151).set,g=r(143)(),b="Promise",m=c.TypeError,x=c.process,w=c[b],x=c.process,S="process"==a(x),_=function(){},O=!!function(){try{var t=w.resolve(1),n=(t.constructor={})[r(7)("species")]=function(t){t(_,_)};return(S||"function"==typeof PromiseRejectionEvent)&&t.then(_)instanceof n}catch(t){}}(),E=function(t,n){return t===n||t===w&&n===o},P=function(t){var n;return!(!l(t)||"function"!=typeof(n=t.then))&&n},j=function(t){return E(w,t)?new F(t):new i(t)},F=i=function(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw m("Bad Promise constructor");n=t,r=e}),this.resolve=h(n),this.reject=h(r)},M=function(t){try{t()}catch(t){return{error:t}}},A=function(t,n){if(!t._n){t._n=!0;var r=t._c;g(function(){for(var e=t._v,i=1==t._s,o=0;r.length>o;)!function(n){var r,o,u=i?n.ok:n.fail,c=n.resolve,f=n.reject,a=n.domain;try{u?(i||(2==t._h&&I(t),t._h=1),!0===u?r=e:(a&&a.enter(),r=u(e),a&&a.exit()),r===n.promise?f(m("Promise-chain cycle")):(o=P(r))?o.call(r,c,f):c(r)):f(e)}catch(t){f(t)}}(r[o++]);t._c=[],t._n=!1,n&&!t._h&&N(t)})}},N=function(t){y.call(c,function(){var n,r,e,i=t._v;if(T(t)&&(n=M(function(){S?x.emit("unhandledRejection",i,t):(r=c.onunhandledrejection)?r({promise:t,reason:i}):(e=c.console)&&e.error&&e.error("Unhandled promise rejection",i)}),t._h=S||T(t)?2:1),t._a=void 0,n)throw n.error})},T=function(t){if(1==t._h)return!1;for(var n,r=t._a||t._c,e=0;r.length>e;)if(n=r[e++],n.fail||!T(n.promise))return!1;return!0},I=function(t){y.call(c,function(){var n;S?x.emit("rejectionHandled",t):(n=c.onrejectionhandled)&&n({promise:t,reason:t._v})})},k=function(t){var n=this;n._d||(n._d=!0,n=n._w||n,n._v=t,n._s=2,n._a||(n._a=n._c.slice()),A(n,!0))},L=function(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw m("Promise can't be resolved itself");(n=P(t))?g(function(){var e={_w:r,_d:!1};try{n.call(t,f(L,e,1),f(k,e,1))}catch(t){k.call(e,t)}}):(r._v=t,r._s=1,A(r,!1))}catch(t){k.call({_w:r,_d:!1},t)}}};O||(w=function(t){v(this,w,b,"_h"),h(t),e.call(this);try{t(f(L,this,1),f(k,this,1))}catch(t){k.call(this,t)}},e=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},e.prototype=r(73)(w.prototype,{then:function(t,n){var r=j(d(this,w));return r.ok="function"!=typeof t||t,r.fail="function"==typeof n&&n,r.domain=S?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),F=function(){var t=new e;this.promise=t,this.resolve=f(L,t,1),this.reject=f(k,t,1)}),s(s.G+s.W+s.F*!O,{Promise:w}),r(81)(w,b),r(74)(b),o=r(52)[b],s(s.S+s.F*!O,b,{reject:function(t){var n=j(this);return(0,n.reject)(t),n.promise}}),s(s.S+s.F*(u||!O),b,{resolve:function(t){if(t instanceof w&&E(t.constructor,this))return t;var n=j(this);return(0,n.resolve)(t),n.promise}}),s(s.S+s.F*!(O&&r(123)(function(t){w.all(t).catch(_)})),b,{all:function(t){var n=this,r=j(n),e=r.resolve,i=r.reject,o=M(function(){var r=[],o=0,u=1;p(t,!1,function(t){var c=o++,f=!1;r.push(void 0),u++,n.resolve(t).then(function(t){f||(f=!0,r[c]=t,--u||e(r))},i)}),--u||e(r)});return o&&i(o.error),r.promise},race:function(t){var n=this,r=j(n),e=r.reject,i=M(function(){p(t,!1,function(t){n.resolve(t).then(r.resolve,e)})});return i&&e(i.error),r.promise}})},function(t,n,r){var e=r(1),i=r(26),o=r(2),u=(r(3).Reflect||{}).apply,c=Function.apply;e(e.S+e.F*!r(4)(function(){u(function(){})}),"Reflect",{apply:function(t,n,r){var e=i(t),f=o(r);return u?u(e,n,f):c.call(e,n,f)}})},function(t,n,r){var e=r(1),i=r(70),o=r(26),u=r(2),c=r(6),f=r(4),a=r(163),s=(r(3).Reflect||{}).construct,l=f(function(){function t(){}return!(s(function(){},[],t)instanceof t)}),h=!f(function(){s(function(){})});e(e.S+e.F*(l||h),"Reflect",{construct:function(t,n){o(t),u(n);var r=arguments.length<3?t:o(arguments[2]);if(h&&!l)return s(t,n,r);if(t==r){switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3])}var e=[null];return e.push.apply(e,n),new(a.apply(t,e))}var f=r.prototype,v=i(c(f)?f:Object.prototype),p=Function.apply.call(t,v,n);return c(p)?p:v}})},function(t,n,r){var e=r(11),i=r(1),o=r(2),u=r(50);i(i.S+i.F*r(4)(function(){Reflect.defineProperty(e.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,n,r){o(t),n=u(n,!0),o(r);try{return e.f(t,n,r),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(31).f,o=r(2);e(e.S,"Reflect",{deleteProperty:function(t,n){var r=i(o(t),n);return!(r&&!r.configurable)&&delete t[n]}})},function(t,n,r){"use strict";var e=r(1),i=r(2),o=function(t){this._t=i(t),this._i=0;var n,r=this._k=[];for(n in t)r.push(n)};r(139)(o,"Object",function(){var t,n=this,r=n._k;do{if(n._i>=r.length)return{value:void 0,done:!0}}while(!((t=r[n._i++])in n._t));return{value:t,done:!1}}),e(e.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,n,r){var e=r(31),i=r(1),o=r(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,n){return e.f(o(t),n)}})},function(t,n,r){var e=r(1),i=r(32),o=r(2);e(e.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,n,r){function e(t,n){var r,c,s=arguments.length<3?t:arguments[2];return a(t)===s?t[n]:(r=i.f(t,n))?u(r,"value")?r.value:void 0!==r.get?r.get.call(s):void 0:f(c=o(t))?e(c,n,s):void 0}var i=r(31),o=r(32),u=r(24),c=r(1),f=r(6),a=r(2);c(c.S,"Reflect",{get:e})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{has:function(t,n){return n in t}})},function(t,n,r){var e=r(1),i=r(2),o=Object.isExtensible;e(e.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{ownKeys:r(177)})},function(t,n,r){var e=r(1),i=r(2),o=Object.preventExtensions;e(e.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(144);i&&e(e.S,"Reflect",{setPrototypeOf:function(t,n){i.check(t,n);try{return i.set(t,n),!0}catch(t){return!1}}})},function(t,n,r){function e(t,n,r){var f,h,v=arguments.length<4?t:arguments[3],p=o.f(s(t),n);if(!p){if(l(h=u(t)))return e(h,n,r,v);p=a(0)}return c(p,"value")?!(!1===p.writable||!l(v)||(f=o.f(v,n)||a(0),f.value=r,i.f(v,n,f),0)):void 0!==p.set&&(p.set.call(v,r),!0)}var i=r(11),o=r(31),u=r(32),c=r(24),f=r(1),a=r(66),s=r(2),l=r(6);f(f.S,"Reflect",{set:e})},function(t,n,r){var e=r(3),i=r(136),o=r(11).f,u=r(71).f,c=r(122),f=r(120),a=e.RegExp,s=a,l=a.prototype,h=/a/g,v=/a/g,p=new a(h)!==h;if(r(10)&&(!p||r(4)(function(){return v[r(7)("match")]=!1,a(h)!=h||a(v)==v||"/a/i"!=a(h,"i")}))){a=function(t,n){var r=this instanceof a,e=c(t),o=void 0===n;return!r&&e&&t.constructor===a&&o?t:i(p?new s(e&&!o?t.source:t,n):s((e=t instanceof a)?t.source:t,e&&o?f.call(t):n),r?this:l,a)};for(var d=u(s),y=0;d.length>y;)!function(t){t in a||o(a,t,{configurable:!0,get:function(){return s[t]},set:function(n){s[t]=n}})}(d[y++]);l.constructor=a,a.prototype=l,r(28)(e,"RegExp",a)}r(74)("RegExp")},function(t,n,r){r(119)("match",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("replace",2,function(t,n,r){return[function(e,i){"use strict";var o=t(this),u=void 0==e?void 0:e[n];return void 0!==u?u.call(e,o,i):r.call(String(o),e,i)},r]})},function(t,n,r){r(119)("search",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("split",2,function(t,n,e){"use strict";var i=r(122),o=e,u=[].push,c="split",f="length",a="lastIndex";if("c"=="abbc"[c](/(b)*/)[1]||4!="test"[c](/(?:)/,-1)[f]||2!="ab"[c](/(?:ab)*/)[f]||4!="."[c](/(.?)(.?)/)[f]||"."[c](/()()/)[f]>1||""[c](/.?/)[f]){var s=void 0===/()??/.exec("")[1];e=function(t,n){var r=String(this);if(void 0===t&&0===n)return[];if(!i(t))return o.call(r,t,n);var e,c,l,h,v,p=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),y=0,g=void 0===n?4294967295:n>>>0,b=new RegExp(t.source,d+"g");for(s||(e=new RegExp("^"+b.source+"$(?!\\s)",d));(c=b.exec(r))&&!((l=c.index+c[0][f])>y&&(p.push(r.slice(y,c.index)),!s&&c[f]>1&&c[0].replace(e,function(){for(v=1;v<arguments[f]-2;v++)void 0===arguments[v]&&(c[v]=void 0)}),c[f]>1&&c.index<r[f]&&u.apply(p,c.slice(1)),h=c[0][f],y=l,p[f]>=g));)b[a]===c.index&&b[a]++;return y===r[f]?!h&&b.test("")||p.push(""):p.push(r.slice(y)),p[f]>g?p.slice(0,g):p}}else"0"[c](void 0,0)[f]&&(e=function(t,n){return void 0===t&&0===n?[]:o.call(this,t,n)});return[function(r,i){var o=t(this),u=void 0==r?void 0:r[n];return void 0!==u?u.call(r,o,i):e.call(String(o),r,i)},e]})},function(t,n,r){"use strict";r(184);var e=r(2),i=r(120),o=r(10),u="toString",c=/./[u],f=function(t){r(28)(RegExp.prototype,u,t,!0)};r(4)(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?f(function(){var t=e(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):c.name!=u&&f(function(){return c.call(this)})},function(t,n,r){"use strict";r(29)("anchor",function(t){return function(n){return t(this,"a","name",n)}})},function(t,n,r){"use strict";r(29)("big",function(t){return function(){return t(this,"big","","")}})},function(t,n,r){"use strict";r(29)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,n,r){"use strict";r(29)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!1);e(e.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="endsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{endsWith:function(t){var n=o(this,t,u),r=arguments.length>1?arguments[1]:void 0,e=i(n.length),f=void 0===r?e:Math.min(i(r),e),a=String(t);return c?c.call(n,a,f):n.slice(f-a.length,f)===a}})},function(t,n,r){"use strict";r(29)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,n,r){"use strict";r(29)("fontcolor",function(t){return function(n){return t(this,"font","color",n)}})},function(t,n,r){"use strict";r(29)("fontsize",function(t){return function(n){return t(this,"font","size",n)}})},function(t,n,r){var e=r(1),i=r(75),o=String.fromCharCode,u=String.fromCodePoint;e(e.S+e.F*(!!u&&1!=u.length),"String",{fromCodePoint:function(t){for(var n,r=[],e=arguments.length,u=0;e>u;){if(n=+arguments[u++],i(n,1114111)!==n)throw RangeError(n+" is not a valid code point");r.push(n<65536?o(n):o(55296+((n-=65536)>>10),n%1024+56320))}return r.join("")}})},function(t,n,r){"use strict";var e=r(1),i=r(148),o="includes";e(e.P+e.F*r(134)(o),"String",{includes:function(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){"use strict";r(29)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,n,r){"use strict";var e=r(147)(!0);r(140)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";r(29)("link",function(t){return function(n){return t(this,"a","href",n)}})},function(t,n,r){var e=r(1),i=r(30),o=r(16);e(e.S,"String",{raw:function(t){for(var n=i(t.raw),r=o(n.length),e=arguments.length,u=[],c=0;r>c;)u.push(String(n[c++])),c<e&&u.push(String(arguments[c]));return u.join("")}})},function(t,n,r){var e=r(1);e(e.P,"String",{repeat:r(149)})},function(t,n,r){"use strict";r(29)("small",function(t){return function(){return t(this,"small","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="startsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{startsWith:function(t){var n=o(this,t,u),r=i(Math.min(arguments.length>1?arguments[1]:void 0,n.length)),e=String(t);return c?c.call(n,e,r):n.slice(r,r+e.length)===e}})},function(t,n,r){"use strict";r(29)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,n,r){"use strict";r(29)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,n,r){"use strict";r(29)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,n,r){"use strict";r(82)("trim",function(t){return function(){return t(this,3)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(10),u=r(1),c=r(28),f=r(65).KEY,a=r(4),s=r(126),l=r(81),h=r(76),v=r(7),p=r(182),d=r(153),y=r(206),g=r(205),b=r(138),m=r(2),x=r(30),w=r(50),S=r(66),_=r(70),O=r(174),E=r(31),P=r(11),j=r(72),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(71).f=O.f=Z,r(116).f=X,r(125).f=tt,o&&!r(69)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(27)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){"use strict";var e=r(1),i=r(127),o=r(152),u=r(2),c=r(75),f=r(16),a=r(6),s=r(3).ArrayBuffer,l=r(146),h=o.ArrayBuffer,v=o.DataView,p=i.ABV&&s.isView,d=h.prototype.slice,y=i.VIEW,g="ArrayBuffer";e(e.G+e.W+e.F*(s!==h),{ArrayBuffer:h}),e(e.S+e.F*!i.CONSTR,g,{isView:function(t){return p&&p(t)||a(t)&&y in t}}),e(e.P+e.U+e.F*r(4)(function(){return!new h(2).slice(1,void 0).byteLength}),g,{slice:function(t,n){if(void 0!==d&&void 0===n)return d.call(u(this),t);for(var r=u(this).byteLength,e=c(t,r),i=c(void 0===n?r:n,r),o=new(l(this,h))(f(i-e)),a=new v(this),s=new v(o),p=0;e<i;)s.setUint8(p++,a.getUint8(e++));return o}}),r(74)(g)},function(t,n,r){var e=r(1);e(e.G+e.W+e.F*!r(127).ABV,{DataView:r(152).DataView})},function(t,n,r){r(55)("Float32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Float64",8,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}},!0)},function(t,n,r){"use strict";var e=r(166);r(118)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t,!0)}},e,!1,!0)},function(t,n,r){"use strict";var e=r(1),i=r(117)(!0);e(e.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)("includes")},function(t,n,r){var e=r(1),i=r(143)(),o=r(3).process,u="process"==r(45)(o);e(e.G,{asap:function(t){var n=u&&o.domain;i(n?n.bind(t):t)}})},function(t,n,r){var e=r(1),i=r(45);e(e.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Map",{toJSON:r(165)("Map")})},function(t,n,r){var e=r(1);e(e.S,"Math",{iaddh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o+(e>>>0)+((i&u|(i|u)&~(i+u>>>0))>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{imulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>16,f=i>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>16)+((o*f>>>0)+(a&r)>>16)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{isubh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o-(e>>>0)-((~i&u|~(i^u)&i-u>>>0)>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{umulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>>16,f=i>>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>>16)+((o*f>>>0)+(a&r)>>>16)}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineGetter__:function(t,n){u.f(i(this),t,{get:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineSetter__:function(t,n){u.f(i(this),t,{set:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){var e=r(1),i=r(176)(!0);e(e.S,"Object",{entries:function(t){return i(t)}})},function(t,n,r){var e=r(1),i=r(177),o=r(30),u=r(31),c=r(131);e(e.S,"Object",{getOwnPropertyDescriptors:function(t){for(var n,r=o(t),e=u.f,f=i(r),a={},s=0;f.length>s;)c(a,n=f[s++],e(r,n));return a}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupGetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.get}while(r=u(r))}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupSetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.set}while(r=u(r))}})},function(t,n,r){var e=r(1),i=r(176)(!1);e(e.S,"Object",{values:function(t){return i(t)}})},function(t,n,r){"use strict";var e=r(1),i=r(3),o=r(52),u=r(143)(),c=r(7)("observable"),f=r(26),a=r(2),s=r(68),l=r(73),h=r(27),v=r(79),p=v.RETURN,d=function(t){return null==t?void 0:f(t)},y=function(t){var n=t._c;n&&(t._c=void 0,n())},g=function(t){return void 0===t._o},b=function(t){g(t)||(t._o=void 0,y(t))},m=function(t,n){a(t),this._c=void 0,this._o=t,t=new x(this);try{var r=n(t),e=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){e.unsubscribe()}:f(r),this._c=r)}catch(n){return void t.error(n)}g(this)&&y(this)};m.prototype=l({},{unsubscribe:function(){b(this)}});var x=function(t){this._s=t};x.prototype=l({},{next:function(t){var n=this._s;if(!g(n)){var r=n._o;try{var e=d(r.next);if(e)return e.call(r,t)}catch(t){try{b(n)}finally{throw t}}}},error:function(t){var n=this._s;if(g(n))throw t;var r=n._o;n._o=void 0;try{var e=d(r.error);if(!e)throw t;t=e.call(r,t)}catch(t){try{y(n)}finally{throw t}}return y(n),t},complete:function(t){var n=this._s;if(!g(n)){var r=n._o;n._o=void 0;try{var e=d(r.complete);t=e?e.call(r,t):void 0}catch(t){try{y(n)}finally{throw t}}return y(n),t}}});var w=function(t){s(this,w,"Observable","_f")._f=f(t)};l(w.prototype,{subscribe:function(t){return new m(t,this._f)},forEach:function(t){var n=this;return new(o.Promise||i.Promise)(function(r,e){f(t);var i=n.subscribe({next:function(n){try{return t(n)}catch(t){e(t),i.unsubscribe()}},error:e,complete:r})})}}),l(w,{from:function(t){var n="function"==typeof this?this:w,r=d(a(t)[c]);if(r){var e=a(r.call(t));return e.constructor===n?e:new n(function(t){return e.subscribe(t)})}return new n(function(n){var r=!1;return u(function(){if(!r){try{if(v(t,!1,function(t){if(n.next(t),r)return p})===p)return}catch(t){if(r)throw t;return void n.error(t)}n.complete()}}),function(){r=!0}})},of:function(){for(var t=0,n=arguments.length,r=Array(n);t<n;)r[t]=arguments[t++];return new("function"==typeof this?this:w)(function(t){var n=!1;return u(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),h(w.prototype,c,function(){return this}),e(e.G,{Observable:w}),r(74)("Observable")},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.set;e.exp({defineMetadata:function(t,n,r,e){u(t,n,i(r),o(e))}})},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.map,c=e.store;e.exp({deleteMetadata:function(t,n){var r=arguments.length<3?void 0:o(arguments[2]),e=u(i(n),r,!1);if(void 0===e||!e.delete(t))return!1;if(e.size)return!0;var f=c.get(n);return f.delete(r),!!f.size||c.delete(n)}})},function(t,n,r){var e=r(185),i=r(161),o=r(54),u=r(2),c=r(32),f=o.keys,a=o.key,s=function(t,n){var r=f(t,n),o=c(t);if(null===o)return r;var u=s(o,n);return u.length?r.length?i(new e(r.concat(u))):u:r};o.exp({getMetadataKeys:function(t){return s(u(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.get,f=e.key,a=function(t,n,r){if(u(t,n,r))return c(t,n,r);var e=o(n);return null!==e?a(t,e,r):void 0};e.exp({getMetadata:function(t,n){return a(t,i(n),arguments.length<3?void 0:f(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.keys,u=e.key;e.exp({getOwnMetadataKeys:function(t){
return o(i(t),arguments.length<2?void 0:u(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.get,u=e.key;e.exp({getOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.key,f=function(t,n,r){if(u(t,n,r))return!0;var e=o(n);return null!==e&&f(t,e,r)};e.exp({hasMetadata:function(t,n){return f(t,i(n),arguments.length<3?void 0:c(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.has,u=e.key;e.exp({hasOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(26),u=e.key,c=e.set;e.exp({metadata:function(t,n){return function(r,e){c(t,n,(void 0!==e?i:o)(r),u(e))}}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Set",{toJSON:r(165)("Set")})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!0);e(e.P,"String",{at:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(46),o=r(16),u=r(122),c=r(120),f=RegExp.prototype,a=function(t,n){this._r=t,this._s=n};r(139)(a,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),e(e.P,"String",{matchAll:function(t){if(i(this),!u(t))throw TypeError(t+" is not a regexp!");var n=String(this),r="flags"in f?String(t.flags):c.call(t),e=new RegExp(t.source,~r.indexOf("g")?r:"g"+r);return e.lastIndex=o(t.lastIndex),new a(e,n)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,n,r){"use strict";r(82)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,n,r){"use strict";r(82)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,n,r){r(153)("asyncIterator")},function(t,n,r){r(153)("observable")},function(t,n,r){var e=r(1);e(e.S,"System",{global:r(3)})},function(t,n,r){for(var e=r(155),i=r(28),o=r(3),u=r(27),c=r(80),f=r(7),a=f("iterator"),s=f("toStringTag"),l=c.Array,h=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],v=0;v<5;v++){var p,d=h[v],y=o[d],g=y&&y.prototype;if(g){g[a]||u(g,a,l),g[s]||u(g,s,d),c[d]=l;for(p in e)g[p]||i(g,p,e[p],!0)}}},function(t,n,r){var e=r(1),i=r(151);e(e.G+e.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,n,r){var e=r(3),i=r(1),o=r(121),u=r(207),c=e.navigator,f=!!c&&/MSIE .\./.test(c.userAgent),a=function(t){return f?function(n,r){return t(o(u,[].slice.call(arguments,2),"function"==typeof n?n:Function(n)),r)}:t};i(i.G+i.B+i.F*f,{setTimeout:a(e.setTimeout),setInterval:a(e.setInterval)})},function(t,n,r){r(330),r(269),r(271),r(270),r(273),r(275),r(280),r(274),r(272),r(282),r(281),r(277),r(278),r(276),r(268),r(279),r(283),r(284),r(236),r(238),r(237),r(286),r(285),r(256),r(266),r(267),r(257),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(265),r(239),r(240),r(241),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(317),r(322),r(329),r(320),r(312),r(313),r(318),r(323),r(325),r(308),r(309),r(310),r(311),r(314),r(315),r(316),r(319),r(321),r(324),r(326),r(327),r(328),r(231),r(233),r(232),r(235),r(234),r(220),r(218),r(224),r(221),r(227),r(229),r(217),r(223),r(214),r(228),r(212),r(226),r(225),r(219),r(222),r(211),r(213),r(216),r(215),r(230),r(155),r(302),r(307),r(184),r(303),r(304),r(305),r(306),r(287),r(183),r(185),r(186),r(342),r(331),r(332),r(337),r(340),r(341),r(335),r(338),r(336),r(339),r(333),r(334),r(288),r(289),r(290),r(291),r(292),r(295),r(293),r(294),r(296),r(297),r(298),r(299),r(301),r(300),r(343),r(369),r(372),r(371),r(373),r(374),r(370),r(375),r(376),r(354),r(357),r(353),r(351),r(352),r(355),r(356),r(346),r(368),r(377),r(345),r(347),r(349),r(348),r(350),r(359),r(360),r(362),r(361),r(364),r(363),r(365),r(366),r(367),r(344),r(358),r(380),r(379),r(378),t.exports=r(52)},function(t,n){function r(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var r=t.nextSibling;return r?t.parentNode.insertBefore(n,r):t.parentNode.appendChild(n)}t.exports=r},,,,,,,,,function(t,n,r){(function(n,r){!function(n){"use strict";function e(t,n,r,e){var i=n&&n.prototype instanceof o?n:o,u=Object.create(i.prototype),c=new p(e||[]);return u._invoke=s(t,r,c),u}function i(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(t){return{type:"throw",arg:t}}}function o(){}function u(){}function c(){}function f(t){["next","throw","return"].forEach(function(n){t[n]=function(t){return this._invoke(n,t)}})}function a(t){function n(r,e,o,u){var c=i(t[r],t,e);if("throw"!==c.type){var f=c.arg,a=f.value;return a&&"object"==typeof a&&m.call(a,"__await")?Promise.resolve(a.__await).then(function(t){n("next",t,o,u)},function(t){n("throw",t,o,u)}):Promise.resolve(a).then(function(t){f.value=t,o(f)},u)}u(c.arg)}function e(t,r){function e(){return new Promise(function(e,i){n(t,r,e,i)})}return o=o?o.then(e,e):e()}"object"==typeof r&&r.domain&&(n=r.domain.bind(n));var o;this._invoke=e}function s(t,n,r){var e=P;return function(o,u){if(e===F)throw new Error("Generator is already running");if(e===M){if("throw"===o)throw u;return y()}for(r.method=o,r.arg=u;;){var c=r.delegate;if(c){var f=l(c,r);if(f){if(f===A)continue;return f}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===P)throw e=M,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=F;var a=i(t,n,r);if("normal"===a.type){if(e=r.done?M:j,a.arg===A)continue;return{value:a.arg,done:r.done}}"throw"===a.type&&(e=M,r.method="throw",r.arg=a.arg)}}}function l(t,n){var r=t.iterator[n.method];if(r===g){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=g,l(t,n),"throw"===n.method))return A;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var e=i(r,t.iterator,n.arg);if("throw"===e.type)return n.method="throw",n.arg=e.arg,n.delegate=null,A;var o=e.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=g),n.delegate=null,A):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,A)}function h(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function v(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function d(t){if(t){var n=t[w];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,e=function n(){for(;++r<t.length;)if(m.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=g,n.done=!0,n};return e.next=e}}return{next:y}}function y(){return{value:g,done:!0}}var g,b=Object.prototype,m=b.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},w=x.iterator||"@@iterator",S=x.asyncIterator||"@@asyncIterator",_=x.toStringTag||"@@toStringTag",O="object"==typeof t,E=n.regeneratorRuntime;if(E)return void(O&&(t.exports=E));E=n.regeneratorRuntime=O?t.exports:{},E.wrap=e;var P="suspendedStart",j="suspendedYield",F="executing",M="completed",A={},N={};N[w]=function(){return this};var T=Object.getPrototypeOf,I=T&&T(T(d([])));I&&I!==b&&m.call(I,w)&&(N=I);var k=c.prototype=o.prototype=Object.create(N);u.prototype=k.constructor=c,c.constructor=u,c[_]=u.displayName="GeneratorFunction",E.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===u||"GeneratorFunction"===(n.displayName||n.name))},E.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(k),t},E.awrap=function(t){return{__await:t}},f(a.prototype),a.prototype[S]=function(){return this},E.AsyncIterator=a,E.async=function(t,n,r,i){var o=new a(e(t,n,r,i));return E.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},f(k),k[_]="Generator",k.toString=function(){return"[object Generator]"},E.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function r(){for(;n.length;){var e=n.pop();if(e in t)return r.value=e,r.done=!1,r}return r.done=!0,r}},E.values=d,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(v),!t)for(var n in this)"t"===n.charAt(0)&&m.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){function n(n,e){return o.type="throw",o.arg=t,r.next=n,e&&(r.method="next",r.arg=g),!!e}if(this.done)throw t;for(var r=this,e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=m.call(i,"catchLoc"),c=m.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc<=this.prev&&m.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var i=e;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=n,i?(this.method="next",this.next=i.finallyLoc,A):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),A},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),v(r),A}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var e=r.completion;if("throw"===e.type){var i=e.arg;v(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:d(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=g),A}}}("object"==typeof n?n:"object"==typeof window?window:"object"==typeof self?self:this)}).call(n,function(){return this}(),r(158))}])</script><script src="/./main.0cf68a.js"></script><script>!function(){!function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)}("/slider.e37972.js")}()</script>


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 50%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">所有文章</a></li>
      
        
      
      <li style="width: 50%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">关于我</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、请确保node版本大于6.2<br/>2、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            3、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">航天专业的&lt;br&gt;典型工科男&lt;br&gt;有个喜欢我和我喜欢的人&lt;br&gt;&lt;br&gt;喜欢编程&lt;br&gt;热爱折腾&lt;br&gt;间歇性摸鱼大师</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>